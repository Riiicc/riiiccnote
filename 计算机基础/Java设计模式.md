
# å¾…åŠ
- P64 spring mvc ä¸­çš„é€‚é…å™¨æ¨¡å¼ 
- ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ2022å¹´è´§ä¸­å…³äºè®¾è®¡æ¨¡å¼çš„ç†è§£è¡¥å……

# è®¾è®¡æ¨¡å¼
è®¾è®¡æ¨¡å¼å¯ä»¥è®©ä»£ç å…·æœ‰æ›´å¥½çš„  
- ä»£ç é‡ç”¨æ€§
- å¯è¯»æ€§
- å¯æ‰©å±•æ€§
- å¯é æ€§
- ä½¿ç¨‹åºå‘ˆç°é«˜å†…èšï¼Œä½è€¦åˆçš„ç‰¹æ€§

# è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™   
## ä¸€å¥è¯æ¦‚æ‹¬
- `å¼€é—­åŸåˆ™`ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚æ‰©å±•åŠŸèƒ½ä½¿ç”¨æ‰©å±•ç±»ï¼Œä¸è¦ä¿®æ”¹æºä»£ç 
- `å•ä¸€èŒè´£åŸåˆ™`ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ç§èŒè´£ï¼Œåªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› 
- `æ¥å£éš”ç¦»åŸåˆ™`ï¼šç»†åŒ–åˆ†è§£å¤§æ¥å£ï¼Œå®¢æˆ·ç«¯å°½é‡ä¸ä¾èµ–ä¸éœ€è¦çš„æ¥å£
- `ä¾èµ–å€’è½¬åŸåˆ™`ï¼šå°½é‡é¢å‘æ¥å£ç¼–ç¨‹ï¼Œè¦ä¾èµ–æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯å…·ä½“ç±»
- `é‡Œæ°æ›¿æ¢åŸåˆ™`ï¼šæ›¿æ¢å°±æ˜¯å­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»ï¼Œå®šä¹‰ç±»å‹æ—¶å°½é‡ä½¿ç”¨çˆ¶ç±»
- `è¿ªç±³ç‰¹æ³•åˆ™`ï¼šæœ€å°‘çŸ¥é“åŸåˆ™ï¼Œä¸¤ä¸ªç±»ä¸å¿…ç›´æ¥é€šä¿¡å°±é¿å…ç›´æ¥è°ƒç”¨
- `åˆæˆå¤ç”¨åŸåˆ™`ï¼šå°½é‡ä½¿ç”¨ç»„åˆæˆ–èšåˆï¼Œé¿å…ä½¿ç”¨ç»§æ‰¿

## å¼€é—­åŸåˆ™
`Open Closed Principle` å¼€é—­åŸåˆ™ï¼Œæ˜¯ç¼–ç¨‹ä¸­æœ€åŸºç¡€ã€æœ€é‡è¦çš„è®¾è®¡åŸåˆ™    
ä¸€ä¸ªè½¯ä»¶å®ä½“ï¼Œå¦‚ç±»ï¼Œæ¨¡å—å’Œå‡½æ•°åº”è¯¥æ˜¯å¯¹**æ‰©å±•å¼€æ”¾(æä¾›æ–¹)ï¼Œ**å¯¹**ä¿®æ”¹å…³é—­ï¼ˆä½¿ç”¨æ–¹ï¼‰**ï¼Œä¹Ÿå°±æ˜¯ç±»ä¸­çš„å‡½æ•°åº”è¯¥æ˜¯å¯æ‰©å±•çš„ï¼Œä½†æ˜¯æ‰©å±•åä¸èƒ½å¯¹ä½¿ç”¨å…¶å‡½æ•°çš„æ–¹æ³•é€ æˆå½±å“ï¼Œæ‰€ä»¥è¦ç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚  

å½“è½¯ä»¶éœ€è¦å˜åŒ–æ—¶ï¼Œ**å°½é‡é€šè¿‡æ‰©å±•è½¯ä»¶å®ä½“çš„è¡Œä¸ºæ¥å®ç°å˜åŒ–**ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¿®æ”¹å·²æœ‰çš„ä»£ç æ¥å®ç°å˜åŒ–,**æ‰©å±•**è€Œä¸æ˜¯ä¿®æ”¹  

**å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­**ï¼Œæ‰©å±•ç±»ä¸èƒ½ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œé€šè¿‡æ¥å£å’ŒæŠ½è±¡ç±»æ¥å®ç°


?> ç¼–ç¨‹ä¸­éµå¾ªå…¶ä»–åŸåˆ™ï¼Œä»¥åŠä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç›®çš„å°±æ˜¯éµå¾ªå¼€é—­åŸåˆ™   

## å•ä¸€èŒè´£åŸåˆ™
å¯¹ç±»æ¥è¯´ï¼Œä¸€ä¸ªç±»åªåº”è¯¥è´Ÿè´£ä¸€é¡¹èŒè´£ï¼Œè‹¥ç±»Aè´Ÿè´£ä¸¤ä¸ªä¸åŒèŒè´£ï¼ŒèŒè´£1ã€èŒè´£2ï¼Œè‹¥å› èŒè´£1éœ€æ±‚å˜æ›´è€Œä¿®æ”¹Aæ—¶ï¼Œå¯èƒ½ä¼šå½±å“èŒè´£2çš„å®ç°æ‰§è¡Œï¼Œæ‰€ä»¥è¦å°†ç±»Açš„ç²’åº¦åˆ†è§£ä¸ºA1å’ŒA2   

> ç±»æ‰¿æ‹…çš„èŒè´£è¶Šå¤šï¼Œè¢«å¤ç”¨çš„å¯èƒ½è¶Šå°ï¼ŒèŒè´£è¿‡å¤šå°±æ˜¯è¿‡åº¦è€¦åˆ

1. åˆ›å»ºä¸€ä¸ªäº¤é€šå·¥å…·ç±»,åˆ›å»ºæ–¹æ³•`run`è¾“å‡º"åœ¨è·¯ä¸Šè·‘"
2. å¹¶ä¸æ˜¯æ‰€æœ‰äº¤é€šå·¥å…·éƒ½åœ¨è·¯ä¸Šï¼Œäºæ˜¯åˆ›å»º æ°´ä¸Šäº¤é€šå·¥å…·ï¼Œç©ºä¸­äº¤é€šå·¥å…·ï¼Œé™†åœ°äº¤é€šå·¥å…·ä¸‰ä¸ªç±»ï¼Œ`run` æ–¹æ³•ä¸åŒ,è¾“å‡ºç»“æœä¸åŒ`ç±»çš„ç²’åº¦åˆ†è§£`
3. å†æ¬¡æ”¹è¿›ï¼Œä»ç„¶åªæœ‰ä¸€ä¸ªäº¤é€šå·¥å…·ç±»ï¼Œåˆ›å»ºä¸‰ä¸ªä¸åŒæ–¹æ³• æ°´ä¸Šæ–¹æ³•ï¼Œç©ºä¸­æ–¹æ³•ï¼Œé™†åœ°æ–¹æ³•ï¼ŒåŒæ ·å¯ä»¥å®ç°ä¸åŒå·¥å…·æ‰§è¡Œä¸åŒç»“æœ`æ–¹æ³•çš„ç²’åº¦åˆ†è§£`

- ä¸»è¦ä½œç”¨æ˜¯é™ä½ç±»çš„å¤æ‚åº¦ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£
- æé«˜ç±»çš„å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§
- é™ä½æ”¹å˜ä»£ç å¼•èµ·çš„é£é™©
- é€šå¸¸æƒ…å†µä¸‹åº”å½“éµå®ˆå•ä¸€èŒè´£åŸåˆ™ï¼Œå³**ä½¿ç”¨ç±»è¿›è¡Œåˆ†è§£**ï¼›åªæœ‰ç±»ä¸­æ–¹æ³•è¶³å¤Ÿå°‘ï¼Œé€»è¾‘ç®€å•ï¼Œæ‰èƒ½åœ¨æ–¹æ³•ä¸Šè¿›è¡Œç²’åº¦åˆ†è§£


## æ¥å£éš”ç¦»åŸåˆ™ 
`Interface Segregation Principle` å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼Œå³ä¸€ä¸ªç±»å¯¹å¦ä¸€ç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š  

1. ä¸€ä¸ªæ¥å£æœ‰1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ä¸ªæ–¹æ³•ï¼ŒBç±»å’ŒDç±»å®ç°äº†æ¥å£
2. Aç±»é€šè¿‡Bç±»è°ƒç”¨æ¥å£çš„1ï¼Œ2ï¼Œ3æ–¹æ³•
3. Cç±»é€šè¿‡Dç±»è°ƒç”¨æ¥å£çš„1ï¼Œ4ï¼Œ5æ–¹æ³•
4. æ­¤æ—¶ä¾æ®æ¥å£éš”ç¦»åŸåˆ™ï¼Œéœ€è¦å°†æ¥å£æ‹†åˆ†æˆå‡ ä¸ªç‹¬ç«‹æ¥å£
5. æ¥å£1 åŒ…å«æ–¹æ³•1ï¼Œæ¥å£2åŒ…å«æ–¹æ³•2ï¼Œ3,æ¥å£3 åŒ…å«æ–¹æ³•4ï¼Œ5 
6. Bç±» å®ç° æ¥å£1 å’Œ æ¥å£2ï¼ŒDç±»å®ç° æ¥å£1 å’Œ æ¥å£3 ï¼Œè¿™æ ·å°±å®ç°äº†æ¥å£éš”ç¦»ï¼Œ

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ¥å£éš”ç¦»ä¼˜åŒ–.drawio.png)

## ä¾èµ–å€’è½¬åŸåˆ™
`Dependence INversion Principle` ä¾èµ–å€’è½¬åŸåˆ™  

- é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡
- æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡
- ä¾èµ–å€’è½¬çš„ä¸­å¿ƒæ€æƒ³æ˜¯**é¢å‘æ¥å£ç¼–ç¨‹**
- ä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»å°±æ˜¯ä¸ºäº†åˆ¶å®šå¥½è§„èŒƒï¼Œå…·ä½“å®ç°ç»†èŠ‚äº¤ç”±å®ç°ç±»å»å®Œæˆ

```java
public class Dependence {
    public static void main(String[] args) {
        Person person = new Person();
        person.receive(new Email() );
    }
}
class Email{
    public String getInfo(){
        return "email";
    }
}
//å®ŒæˆPerson æ¥å—æ¶ˆæ¯çš„åŠŸèƒ½
class Person {
    public void receive(Email email){
        System.out.println(email.getInfo());
    }
}

interface IReceiver{
    String getInfo();
}

class Email implements IReceiver{
    public String getInfo(){
        return "email";
    }
}
//å®ŒæˆPerson æ¥å—æ¶ˆæ¯çš„åŠŸèƒ½
class Person {
    public void receive(IReceiver email){
        System.out.println(email.getInfo());
    }
}
```

**ä¾èµ–å…³ç³»ä¼ é€’çš„ä¸‰ç§æ–¹å¼**    
- æ¥å£ä¼ é€’(ä¸Šé¢çš„æ¡ˆä¾‹) 
- æ„é€ æ–¹æ³•ä¼ é€’ï¼Œé€šè¿‡æ„é€ æ–¹æ³•
- setteræ–¹å¼ä¼ é€’,é€šè¿‡setæ–¹æ³•

**æ³¨æ„äº‹é¡¹**   
- åº•å±‚æ¨¡å—å°½é‡éƒ½æœ‰æŠ½è±¡ç±»æˆ–æ¥å£
- **å˜é‡çš„å£°æ˜ç±»å‹å°½é‡æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£**,è¿™æ ·æˆ‘ä»¬å¼•ç”¨å˜é‡å’Œå®é™…å¯¹è±¡ä¹‹é—´å°±å­˜åœ¨ä¸€ä¸ªç¼“å†²ï¼Œåˆ©äºç¨‹åºä¼˜åŒ–å’Œæ‰©å±•
- ç»§æ‰¿æ—¶éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™   

**é¢å‹æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–çš„ç±»åº”è¯¥æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£**

## é‡Œæ°æ›¿æ¢åŸåˆ™
ç»§æ‰¿ä¸­ï¼Œè‹¥çˆ¶ç±»å·²ç»å®ç°å¥½çš„æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯åœ¨è®¾å®šè§„èŒƒå’Œå¥‘çº¦ï¼Œè™½ç„¶å®ƒä¸å¼ºåˆ¶è¦æ±‚æ‰€æœ‰å­ç±»å¿…é¡»éµå®ˆå¥‘çº¦ï¼Œä½†æ˜¯è‹¥å­ç±»å¯¹è¿™äº›å·²ç»å®ç°çš„æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œå°±ä¼šå¯¹æ•´ä¸ªç»§æ‰¿ä½“ç³»é€ æˆç ´åï¼Œ**ç»§æ‰¿ä¼šç»™ç¨‹åºå¸¦æ¥ä¾µå…¥æ€§ï¼Œå¯ç§»æ¤æ€§é™ä½ï¼Œè€¦åˆæ€§å¢åŠ **

æƒ³è¦åœ¨ç¼–ç¨‹ä¸­æ­£ç¡®ä½¿ç”¨ç»§æ‰¿ï¼Œå°±éœ€è¦éµå¾ª **é‡Œæ°æ›¿æ¢åŸåˆ™**

> å¦‚æœå¯¹æ¯ä¸ªç±»å‹ä¸ºT1çš„å¯¹è±¡O1ï¼Œéƒ½æœ‰ç±»å‹ä¸ºT2çš„å¯¹è±¡O2,ä½¿å¾—T1å®šä¹‰çš„æ‰€æœ‰ç¨‹åºPåœ¨æ‰€æœ‰å¯¹è±¡O1éƒ½ä»£æ¢æˆO2æ—¶ï¼Œç¨‹åºPçš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹T2å°±æ˜¯T1çš„å­ç±»å‹ï¼Œ**æ‰€æœ‰å¼•ç”¨åŸºç±»çš„æ–¹æ³•å¿…é¡»èƒ½å¤Ÿé€æ˜çš„ä½¿ç”¨å…¶å­ç±»å‹çš„å¯¹è±¡**

**ä½¿ç”¨ç»§æ‰¿æ—¶ï¼Œéµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œåœ¨å­ç±»ä¸­å°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³•**   
**ç»§æ‰¿å®é™…ä¸Šè®©ä¸¤ä¸ªç±»è€¦åˆæ€§å¢å¼ºäº†ï¼Œå¯ä»¥é€šè¿‡`èšåˆã€ç»„åˆã€ä¾èµ–`æ¥è§£å†³é—®é¢˜**


## è¿ªç±³ç‰¹æ³•åˆ™
è¿ªç±³ç‰¹æ³•åˆ™`Law of Demoeter ,LoD`ä¹Ÿç§°ä¸ºæœ€å°‘çŸ¥è¯†åŸåˆ™  
- ä¸è¦å’Œé™Œç”Ÿäººè¯´è¯ï¼Œåªä¸ç›´æ¥æœ‹å‹é€šä¿¡  

å…¶ä¸­çš„**æœ‹å‹**æˆ‘ä»¬å®šä¹‰ä¸ºï¼š 
- å½“å‰å¯¹è±¡æœ¬èº«
- ä»¥å‚æ•°å½¢å¼æºå…¥åˆ°å½“å‰å¯¹è±¡æ–¹æ³•ä¸­çš„å¯¹è±¡
- å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡
- å¦‚æœå½“å‰å¯¹è±¡æ˜¯ä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆé›†åˆä¸­çš„å…ƒç´ ä¹Ÿéƒ½æ˜¯æœ‹å‹
- å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡

è¿ªç±³ç‰¹å‘è‡ªä¸»è¦ç”¨äºæ§åˆ¶ä¿¡æ¯çš„è¿‡è½½ï¼Œè¿ç”¨è¿ªç±³ç‰¹æ³•åˆ™ä¸»è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š  
- åœ¨ç±»çš„åˆ’åˆ†ä¸Šï¼Œåº”å½“å°½é‡åˆ›å»ºæ¾è€¦åˆçš„ç±»ï¼Œç±»ä¹‹é—´è€¦åˆåº¦è¶Šä½ï¼Œå°±è¶Šæœ‰åˆ©äºå¤ç”¨
- ç±»ç»“æ„è®¾è®¡ä¸Šï¼Œåº”å°½é‡å‡ä½å…¶æˆå‘˜å˜é‡å’Œå‡½æ•°çš„è®¿é—®æƒé™
- å°½é‡å°†ç±»è®¾è®¡ä¸ºä¸å˜ç±»
- åœ¨å¯¹å…¶ä»–ç±»çš„å¼•ç”¨ä¸Šï¼Œä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨åº”å½“é™åˆ°æœ€ä½  


## åˆæˆå¤ç”¨åŸåˆ™
å°½é‡ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿


# UMLå›¾
`UML` `Unified modeling language` ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ 
UML æœ¬èº«æ˜¯ä¸€å¥—ç¬¦å·çš„è§„å®šï¼Œå°±åƒæ•°å­¦ç¬¦å·å’ŒåŒ–å­¦ç¬¦å·ï¼Œè¿™äº›ç¬¦å·ç”¨äºæè¿°è½¯ä»¶æ¨¡å‹ä¸­çš„å„ä¸ªå…ƒç´ å’Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚ç±»ã€æ¥å£ã€å®ç°ã€æ³›åŒ–ã€ä¾èµ–ã€ç»„åˆã€èšåˆç­‰   

> UML2.0ä¸­ï¼Œæä¾›äº†13ç§å›¾ `ç”¨ä¾‹å›¾` `ç±»å›¾` `å¯¹è±¡å›¾` `åŒ…å›¾` `ç»„åˆç»“æ„å›¾` `çŠ¶æ€å›¾` `æ´»åŠ¨å›¾` `é¡ºåºå›¾` `é€šä¿¡å›¾` `å®šæ—¶å›¾` `äº¤äº’æ¦‚è§ˆå›¾` `ç»„ä»¶å›¾` `éƒ¨ç½²å›¾`
 
**å½“å‰é‡ç‚¹æ˜¯ç±»å›¾ï¼Œå…¶ä»–ç•¥è¿‡**

## UMLç±»å›¾
ç”¨äºæè¿°ç³»ç»Ÿä¸­çš„ç±»(å¯¹è±¡)æœ¬èº«çš„ç»„æˆå’Œç±»(å¯¹è±¡)ä¹‹é—´çš„å„ç§ç«æ€å…³ç³»
ç±»ä¹‹é—´çš„å…³ç³»ï¼š ä¾èµ–ã€æ³›åŒ–(ç»§æ‰¿)ã€å®ç°ã€å…³è”ã€èšåˆã€ç»„åˆ   

ç®€å•ç¤ºä¾‹   

```java
public class Person {
	private Integer id;
	private String name;
	
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/personUmlç¤ºä¾‹.png)  

## è¯´æ˜  
UMLç±»å›¾ä¸­,ç±»ä¸€èˆ¬ç”±ä¸‰éƒ¨åˆ†ç»„æˆ: ç±»å,å±æ€§,ç±»çš„æ“ä½œ  

### ç±»å
æ¯ä¸ªç±»éƒ½å¿…é¡»æœ‰ä¸€ä¸ªåå­—,ç±»åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,æŒ‰ç…§Javaå‘½åè§„èŒƒ  

### å±æ€§  
ç±»çš„æˆå‘˜å˜é‡,å±æ€§è¡¨ç¤ºæ–¹å¼ä¸º`å¯è§æ€§ åç§°:ç±»å‹ [= é»˜è®¤å€¼]` 

å¯è§æ€§,è¡¨ç¤ºå±æ€§å¯¹ç±»å¤–å…ƒç´ æ˜¯å¦å¯è§,åŒ…æ‹¬å…¬æœ‰`public`,ç§æœ‰`private`,å—ä¿æŠ¤`protected`,åœ¨ç±»å›¾ä¸­åˆ†åˆ«ç”¨ç¬¦å·`+` `-` `#`è¡¨ç¤º   
Javaä¸­æ–°å¢äº†åŒ…å†…å¯è§æ€§`package`ä½¿ç”¨`*`è¡¨ç¤º    

å¯è§æ€§ï¼Œå¯¹åº”æ–¹æ³•å’Œå±æ€§å‰é¢çš„ç¬¦å·:  
- `private(-)`ï¼šåœ¨ç±»çš„å¤–éƒ¨æ— æ³•è¢«è®¿é—®ï¼ˆå³ä½¿æ˜¯å®ƒçš„å­ç±»ã€æˆ–è€…é€šè¿‡ ç±».ç§æœ‰è¿›è¡Œè®¿é—® ï¼‰
- `protected(#)`ï¼šåœ¨å­ç±»ä¸­å¯ä»¥è®¿é—®ï¼›
- `public(+)`ï¼šä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è®¿é—®å®ƒä»¬
- `package(*)`åŒ…å†…è®¿é—®

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlç±»å›¾å±æ€§è¯´æ˜ç¤ºæ„å›¾.png)

### ç±»çš„æ“ä½œ 
æ“ä½œæ˜¯ç±»çš„ä»»æ„ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨çš„è¡Œä¸º,æ“ä½œæ˜¯ç±»çš„æˆå‘˜æ–¹æ³•  
`å¯è§æ€§ åç§° ([å‚æ•°åˆ—è¡¨])[:è¿”å›ç±»å‹]`   
å¯è§æ€§å®šä¹‰å’Œå±æ€§çš„ç›¸åŒ,åç§°å³æ–¹æ³•åç§°,å‚æ•°åˆ—è¡¨å¤šä¸ªå‚æ•°ä¹‹é—´ç”¨`,`éš”å¼€,è¿”å›ç±»å‹æ˜¯å¯é€‰é¡¹,è¡¨ç¤ºæ–¹æ³•çš„è¿”å›å€¼ç±»å‹,ä¾èµ–äºå…·ä½“è¯­è¨€,ä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹,è¿˜å¯ä»¥æ˜¯ç©º`void` 

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlç±»å›¾æ“ä½œè¯´æ˜ç¤ºæ„å›¾.png)




## ç±»çš„å…³ç³» 

çº¿æ¡è¯´æ˜ï¼š  
- `Generalization` æ³›åŒ–å…³ç³»-ç»§æ‰¿å…³ç³»(å®çº¿ä¸‰è§’)
- `Realization/Implementation` å®ç°å…³ç³»(è™šçº¿ä¸‰è§’)
- `Association` å…³è”å…³ç³»(å®çº¿ç®­å¤´)
- `Dependency` ä¾èµ–å…³ç³»(è™šçº¿ç®­å¤´)
- `Aggregation`èšåˆå…³ç³»(å®ç°ç©ºå¿ƒè±å½¢)
- `Composite` ç»„åˆå…³ç³»(å®ç°å®å¿ƒè±å½¢)

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç±»å›¾å…³ç³»è¯´æ˜å¤§å›¾.png)

### æ³›åŒ–å…³ç³»
æ³›åŒ–å…³ç³»å®é™…ä¸Šå°±æ˜¯**ç»§æ‰¿å…³ç³»**ï¼Œä¹Ÿæ˜¯ä¾èµ–å…³ç³»çš„ç‰¹ä¾‹ï¼Œå­ç±»æŒ‡å‘çˆ¶ç±»   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlæ³›åŒ–å…³ç³»å®ä¾‹.png)

### å®ç°å…³ç³»
å®ç°å…³ç³»å®é™…ä¸Šå°±æ˜¯Aç±»å®ç°Bæ¥å£ï¼Œä¹Ÿæ˜¯æ˜¯ä¾èµ–å…³ç³»çš„ç‰¹ä¾‹ï¼Œå®ç°ç±»æŒ‡å‘è¢«å®ç°ç±»  
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlå®ç°å…³ç³»å®ä¾‹.png)

### ä¾èµ–å…³ç³»
ä¾èµ–å…³ç³»`Dependency`ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å…³ç³»,åªè¦åœ¨ç±»ä¸­ç”¨åˆ°äº†å¯¹æ–¹ï¼Œé‚£ä¹ˆä»–ä»¬å°±å­˜åœ¨ä¾èµ–å…³ç³»ï¼ŒAç”¨åˆ°Bï¼Œå°±æˆä¸ºAä¾èµ–B   
å¤§éƒ¨åˆ†æƒ…å†µä¸‹,ä¾èµ–å…³ç³»ä½“ç°åœ¨æŸä¸ªç±»çš„æ–¹æ³•ä½¿ç”¨å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå‚æ•° 

```java
class Driver{
    public void drive(Car car){
        car.move();
    }
}
class Car{
    public void move(){

    }
}
```
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlä¾èµ–å…³ç³»å®ä¾‹.png)


### å…³è”å…³ç³»
å…³è”å…³ç³»`Association`æ˜¯ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»ï¼Œé€šå¸¸å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„å±æ€§,å…³è”å…·æœ‰å¯¼èˆªæ€§ï¼Œå³åŒå‘å…³è”å…³ç³»æˆ–è€…å•å‘å…³è”å…³ç³»  

1. åŒå‘å…³è”,é»˜è®¤æƒ…å†µä¸‹å…³è”æ˜¯åŒå‘çš„,ä¾‹å¦‚:äººå’Œèº«ä»½è¯,é¡¾å®¢å’Œå•†å“  

```java
class Person{
    private IDCard card;
}
class IDCard{
    private Person person;
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/åŒå‘ä¸€å¯¹ä¸€å…³è”å…³ç³».png)

```java
class Customer{
    private Product[] products;
}

class Product{
    private Customer cusomer;
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlåŒå‘å…³è”å…³ç³»é¡¾å®¢å•†å“ç¤ºä¾‹.png)  

2. å•é¡¹å…³è”å…³ç³»,å•å‘å…³è”å…³ç³»ç”¨å¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤º,ä¾‹:äººå’Œèº«ä»½è¯,äººå’Œåœ°å€     

```java
//å•å‘ä¸€å¯¹ä¸€ personç”¨åˆ°idcard ä½†æ˜¯idcard æ²¡æœ‰ ç”¨åˆ°person
class Person{
    private IDCard card;
}
class IDCard{}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å•å‘ä¸€å¯¹ä¸€å…³è”å…³ç³».png)

```java
class Customer{
    private Address address;
}

class Address{
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlå•å‘å…³è”å…³ç³»é¡¾å®¢åœ°å€ç¤ºä¾‹.png)  

3. è‡ªå…³è”,ç±»çš„å±æ€§æ˜¯ç±»æœ¬èº« 

```java
class Node{
    private Node subNode;
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlè‡ªå…³è”ç¤ºæ„å›¾.png)

4. å¤šé‡å…³è”,è¡¨ç¤ºä¸€ä¸ªç±»çš„å¯¹è±¡å’Œå¦ä¸€ä¸ªç±»çš„å¯¹è±¡è¿æ¥çš„ä¸ªæ•° 

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlå¤šé‡å…³è”ç¤ºæ„å›¾.png) 

```java
public class Form{
    private Button[] buttons;
}

public class Button{

}
```  
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/umlå¤šé‡å…³è”å®ä¾‹å›¾.png) 


### èšåˆå…³ç³»
èšåˆå…³ç³»`Aggregation` è¡¨ç¤ºæ•´ä½“å’Œéƒ¨åˆ†çš„å…³ç³»ï¼Œæ•´ä½“å’Œéƒ¨åˆ†å¯ä»¥åˆ†å¼€ï¼Œæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹   
ä¾‹å¦‚ï¼šä¸€å°ç”µè„‘ç”±é”®ç›˜ã€æ˜¾ç¤ºå™¨ã€é¼ æ ‡ç­‰ç»„æˆï¼Œè¿™äº›é…ä»¶æ˜¯å¯ä»¥ä»ç”µè„‘ä¸Šåˆ†ç¦»çš„ï¼Œæ‰€ä»¥ä»–ä»¬å°±æ˜¯èšåˆå…³ç³»     
å†æ¯”å¦‚ï¼š ç¾Šç¾¤å’Œç¾Šçš„å…³ç³»ã€å­¦æ ¡å’Œè€å¸ˆ å°±æ˜¯èšåˆå…³ç³»

```java
class Computer{
    private Mouse mouse;
    private Monitor monitor;

    public void setMouse(Mouse mouse) {
        this.mouse = mouse;
    }

    public void setMonitor(Monitor monitor) {
        this.monitor = monitor;
    }
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/èšåˆå…³ç³»ç¤ºä¾‹.png)

### ç»„åˆå…³ç³» 
ç»„åˆå…³ç³»`Compostion`æ¥ä¸Šï¼Œè‹¥æˆ‘ä»¬è®¤ä¸ºé¼ æ ‡ï¼Œæ˜¾ç¤ºå™¨å’Œç”µè„‘æ˜¯ä¸å¯åˆ†ç¦»çš„ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ˜¯ç»„åˆå…³ç³»   
å†ä¸¾ä¾‹ï¼Œäººå’Œèº«ä»½è¯çš„å…³ç³»å°±æ˜¯èšåˆå…³ç³»ï¼Œå’Œè„‘è¢‹çš„å…³ç³»å°±æ˜¯ç»„åˆå…³ç³»    

**ç»„åˆå…³ç³»å¯ä»¥è®¤ä¸ºæ˜¯æ›´å¼ºçƒˆçš„èšåˆå…³ç³»**

```java
class Computer{
    private Mouse mouse = new Mouse();
    private Monitor monitor = new Monitor();

    public void setMouse(Mouse mouse) {
        this.mouse = mouse;
    }

    public void setMonitor(Monitor monitor) {
        this.monitor = monitor;
    }
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç»„åˆå…³ç³»ç¤ºä¾‹.png)


## å…¶ä»–
é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å®ƒä»¬ä¹‹é—´çš„æ•°é‡å…³ç³»è¿›è¡Œçº¦æŸï¼Œä¹Ÿç§°ä¸ºå¤šé‡æ€§æ•°å­—çº¦æŸã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªè®¿å®¢å¤§å…ç±»åªèƒ½æœ‰ä¸€ä¸ªå”®ç¥¨å¤„ï¼Œä½†æ˜¯å•æ‰€è¦å¥½å‡ ä¸ªã€‚å°†çº¦æŸå…³ç³»å†™ä¸º`m..n`

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¤šå¯¹å¤šumlå…³ç³»è¯´æ˜.png)





# è®¾è®¡æ¨¡å¼ç±»å‹ ğŸ”¶
è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼Œå…±23ç§ï¼Œ`GOF 23`    
- **åˆ›å»ºå‹**æ¨¡å¼ï¼šå•ä¾‹æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼
- **ç»“æ„å‹**æ¨¡å¼ï¼šé€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€ä»£ç†æ¨¡å¼
- **è¡Œä¸ºå‹**æ¨¡å¼ï¼šæ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼  

?> åˆ›å»ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œç»“æ„å‹æ¨¡å¼å…³æ³¨å¯¹è±¡ä¸ç±»çš„ç»„ç»‡ï¼Œè¡Œä¸ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„äº¤äº’  

# åˆ›å»ºå‹æ¨¡å¼ğŸ”µ
è½¯ä»¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶ï¼Œç±»å°†å®ä¾‹åŒ–æˆå¯¹è±¡ï¼Œå¹¶ç”±è¿™äº›å¯¹è±¡æ¥å†™ä½œå®Œæˆå„é¡¹ä¸šåŠ¡åŠŸèƒ½ã€‚**åˆ›å»ºå‹æ¨¡å¼**å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹è¿›è¡Œäº†æŠ½è±¡ï¼Œèƒ½å¤Ÿå°†è½¯ä»¶æ¨¡å—ä¸­å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„ä½¿ç”¨åˆ†ç¦»ã€‚  

ä¸ºäº†ä½¿è½¯ä»¶çš„ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œå¤–ç•Œå¯¹äºè¿™äº›å¯¹è±¡åªéœ€è¦çŸ¥é“å®ƒä»¬å…±åŒçš„æ¥å£ï¼Œè€Œä¸ç”¨æ¸…é™¤å…¶å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œä½¿æ•´ä¸ªç³»ç»Ÿçš„è®¾è®¡æ›´åŠ ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/åˆ›å»ºè€…æ¨¡å¼ä¸€è§ˆ.png)

# â—å•ä¾‹æ¨¡å¼ğŸ”µ
å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯é‡‡å–ä¸€å®šçš„æ–¹æ³•**ä¿è¯åœ¨æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¯¹æŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹**ï¼Œå¹¶ä¸”è¯¥ç±»åªæä¾›ä¸€ä¸ªè·å¾—å…¶å¯¹è±¡å®ä¾‹çš„æ–¹æ³•(é™æ€æ–¹æ³•)

ä¾‹å¦‚Hibernate çš„SessionFactory   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å•ä¾‹æ¨¡å¼UML.png)

## å…«ç§æ–¹å¼
1. é¥¿æ±‰å¼(é™æ€å¸¸é‡)
2. é¥¿æ±‰å¼(é™æ€ä»£ç å—)
3. æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)
4. æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•)
5. æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—)
6. åŒé‡æ£€æŸ¥
7. é™æ€å†…éƒ¨ç±»
8. æšä¸¾

### é¥¿æ±‰å¼
é™æ€å¸¸é‡

```java
class Singleton {
    //æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨ä¸èƒ½é€šè¿‡new åˆ›å»º
    private Singleton() {}
    //æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹
    private final static Singleton instance = new Singleton();

    //æä¾›ä¸€ä¸ªå…¬æœ‰çš„ç«æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}
```

é™æ€ä»£ç å—

```java
class Singleton {
    //æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨ä¸èƒ½é€šè¿‡new åˆ›å»º
    private Singleton() {}
    //æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹
    private static Singleton instance;
    static {
        //åœ¨é™æ€ä»£ç å—ç§åˆ›å»ºå•ä¾‹å¯¹è±¡
        instance = new Singleton();
    }
    //æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}
```

> ä¸Šè¿°ä¸¤ç§å‡æ˜¯åˆ©ç”¨ç±»åŠ è½½å®Œæˆå®ä¾‹åŒ–ï¼Œé€šè¿‡`<clinit>()`æ–¹æ³•ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—,åœ¨ç±»åŠ è½½(åˆå§‹åŒ–)é˜¶æ®µå®Œæˆèµ‹å€¼ï¼Œä¹Ÿæ˜¯é¥¿æ±‰åç§°ç”±æ¥ï¼Œæå‰å‡†å¤‡é£Ÿç‰©(ç±»å®ä¾‹)ï¼Œéšæ—¶å¯ä»¥åƒ(ä½¿ç”¨)    

?> ä¼˜ç‚¹ï¼š å†™æ³•ç®€å•ï¼Œåœ¨ç±»åŠ è½½æ—¶å°±å®Œæˆå®ä¾‹åŒ–ï¼Œé¿å…çº¿ç¨‹åŒæ­¥é—®é¢˜  

!> ç¼ºç‚¹ï¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œæ²¡æœ‰è¾¾åˆ°æ‡’åŠ è½½æ•ˆæœï¼Œè‹¥ä»æœªä½¿ç”¨è¿‡è¯¥å®ä¾‹ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹


### æ‡’æ±‰å¼
æ‡’æ±‰å¼ï¼Œé¥¿äº†(éœ€è¦ç”¨æ—¶)æ‰å»å‡†å¤‡é£Ÿç‰©(åˆ›å»ºç±»å®ä¾‹)   

**çº¿ç¨‹ä¸å®‰å…¨** 

```java
class Singleton{
    private static Singleton instance;
    private Singleton(){}
    //æ‡’æ±‰å¼
    //æä¾›é™æ€æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶åˆ›å»ºå¯¹è±¡
    public static Singleton getInstance(){
        if (instance==null){
            instance = new Singleton();
        }
        return instance;
    }
}
```  

ä¼˜ç‚¹ï¼š èµ·åˆ°äº†æ‡’åŠ è½½æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨    
ç¼ºç‚¹ï¼š å¤šçº¿ç¨‹æƒ…å†µä¸‹å¯èƒ½åˆ›å»ºå¤šä¸ªï¼Œæ— æ³•ä¿è¯å•ä¾‹ï¼Œå®é™…å¼€å‘ç§**ä¸èƒ½**ä½¿ç”¨   

**åŒæ­¥æ–¹æ³•ä¿è¯çº¿ç¨‹å®‰å…¨**

```java
class Singleton{
    private static Singleton instance;
    private Singleton(){}
    //æ‡’æ±‰å¼
    //æä¾›é™æ€åŒæ­¥æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶åˆ›å»ºå¯¹è±¡
    public static synchronized Singleton getInstance(){
        if (instance==null){
            instance = new Singleton();
        }
        return instance;
    }
}
```

ç¼ºç‚¹ï¼š æ•ˆç‡ä½ä¸‹ï¼Œæ¯æ¬¡getInstanceéƒ½ä¼šæ‰§è¡ŒåŒæ­¥æ–¹æ³•ï¼Œå®é™…å¼€å‘ä¸æ¨è

**åŒæ­¥ä»£ç å—**

```java
class Singleton{
    private static Singleton instance;
    private Singleton(){}
    //æ‡’æ±‰å¼
    //æä¾›é™æ€æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ–¹æ³•æ—¶åˆ›å»ºå¯¹è±¡
    public static Singleton getInstance(){

        if (instance==null){
            //åŒæ­¥ä»£ç å—
            synchroized{
                instance = new Singleton();
            }
        }
        return instance;
    }
}
```

è¿™ç§æ–¹æ³•æ— æ³•è§£å†³å¤šçº¿ç¨‹å¸¦æ¥çš„é—®é¢˜ï¼Œæ¯«æ— ä½œç”¨

**åŒé‡æ£€æŸ¥**

```java
class Singleton {
    //ä½¿ç”¨volatile
    private static volatile Singleton instance;

    private Singleton() {}

    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                if (instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

**é™æ€å†…éƒ¨ç±»**   
> ä¸»ç±»`Singleton`åŠ è½½æ—¶ï¼Œå†…éƒ¨é™æ€ç±»ä¸ä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼Œåªæœ‰è°ƒç”¨é™æ€å†…éƒ¨ç±»çš„æ–¹æ³•ï¼Œé™æ€åŸŸï¼Œæˆ–è€…æ„é€ æ–¹æ³•çš„æ—¶å€™æ‰ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»,è€Œjavaç±»åŠ è½½è¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„   

```java
class Singleton {
    private Singleton() {}
    //é™æ€å†…éƒ¨ç±»
    private static class SingletonInstance{
        private static final Singleton INSTANCE = new Singleton();
    }
    //è°ƒç”¨æ–¹æ³•æ˜¯ æ‰ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»ï¼Œä¸”æ­¤æ—¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆç±»åŠ è½½æœºåˆ¶ï¼‰
    public static Singleton getInstance() {
        return SingletonInstance.INSTANCE;
    }
}
```

**æšä¸¾ å•ä¾‹æ¨¡å¼**

```java
enum Singleton{
    INSTANCE;
    public void sayOK(){
        System.out.println("OK");
    }
}
```

è°ƒç”¨`Singleton instance = Singleton.INSTANCE;` è¿”å›çš„å°±æ˜¯Singletonç±»ï¼Œå¯ä»¥æŠŠ`INSTANCE`ç†è§£ä¸ºSingletonç±»çš„å­ç±»   
å¯ä»¥ä½¿ç”¨æ–¹æ³•è·å–INSTANCEç±» `Singleton instance2 = Enum.valueOf(Singleton.class, "INSTANCE");`

> å€ŸåŠ©äº†JDK1.5 ä¸­çš„æšä¸¾ç±»æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥é¿å…å¤šçº¿ç¨‹é—®é¢˜ï¼Œè¿˜èƒ½æ–¹å¼ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡  
> **æ¨èä½¿ç”¨**

**ä¸‹é¢çš„æ¡ˆä¾‹æ›´å¥½ç†è§£**   

```java
public class SingletonTest {
    public static void main(String[] args) {
        Singleton instance = Singleton.INSTANCE;
        Singleton instance1 = Singleton.INSTANCE;
        Singleton instance2 = Enum.valueOf(Singleton.class, "INSTANCE");

        instance.setXx(new Person("11", 1));
        System.out.println(instance.getXx().getName());//11
        System.out.println(instance2.getXx().getName());//11

        instance2.setXx(new Person("22", 2));
        System.out.println(instance.getXx().getName());//22

        System.out.println(instance.getXx() == instance2.getXx());//true
        System.out.println(instance1.getXx().getName());//22
        System.out.println(instance2.getXx().getName());//22

    }
}

enum Singleton {
    INSTANCE;
    private Person xx;

    public Person getXx() {
        return xx;
    }
    public void setXx(Person xx) {
        this.xx = xx;
    }

    public void sayOK() {
        System.out.println("OK");
    }
}

class Person {
    private String name;
    private Integer id;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Person(String name, Integer id) {
        this.name = name;
        this.id = id;
    }
}
```

## å®é™…åº”ç”¨

`java.lang.Runtime`ç±»å°±ä½¿ç”¨äº†é¥¿æ±‰å¼è¿›è¡Œå•ä¾‹åŠ è½½   

```java
public class Runtime {
    private static Runtime currentRuntime = new Runtime();

    /**
     * Returns the runtime object associated with the current Java application.
     * Most of the methods of class <code>Runtime</code> are instance
     * methods and must be invoked with respect to the current runtime object.
     *
     * @return  the <code>Runtime</code> object associated with the current
     *          Java application.
     */
    public static Runtime getRuntime() {
        return currentRuntime;
    }

    /** Don't let anyone else instantiate this class */
    private Runtime() {}
    
    ...
}
```

## æ³¨æ„äº‹é¡¹
1. å•ä¾‹æ¨¡å¼ä¿è¯äº†ç³»ç»Ÿå†…å­˜ä¸­è¯¥ç±»åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½  
2. å½“éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œå¿…é¡»è¦è®°ä½ä½¿ç”¨å“åº”çš„è·å–å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨new
3. å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦é¢‘ç¹è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼Œåˆ›å»ºå¯¹è±¡è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤š(é‡é‡çº§çš„å¯¹è±¡)ï¼Œå·¥å…·ç±»å¯¹è±¡(ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡)ï¼Œé¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–è€…æ–‡ä»¶çš„å¯¹è±¡(æ•°æ®æºï¼Œsessionå·¥å‚)

## å•ä¾‹æ¨¡å¼çš„åå°„æ”»å‡»
å¶ç„¶çœ‹åˆ°çš„åšå®¢ï¼Œå•ä¾‹æ¨¡å¼å¯ä»¥ä½¿ç”¨åå°„ï¼Œåˆ›å»ºä¸åŒçš„å®ä¾‹å¯¹è±¡,å®ç°æ‰“ç ´å•ä¾‹è§„åˆ™      

```java
public class SingletonTest01 {
    public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {
        Singleton instance = Singleton.getInstance();
        Singleton instance1 = Singleton.getInstance();
        System.out.println(instance == instance1);//true

        Class<Singleton> singletonClass = Singleton.class;
        //è·å–æ„é€ å™¨
        Constructor<Singleton> declaredConstructor = singletonClass.getDeclaredConstructor();
        //è®¾ç½®æƒé™è®¿é—®ç§æœ‰åŸŸ
        declaredConstructor.setAccessible(true);
        //newInstanceè°ƒç”¨é»˜è®¤æ— å‚æ„é€ å™¨
        Singleton singleton = declaredConstructor.newInstance();
        System.out.println(instance == singleton);//false
    }
}

class Singleton {
    //æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨ä¸èƒ½é€šè¿‡new åˆ›å»º
    private Singleton() {}
    //æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹
    private final static Singleton instance = new Singleton();

    //æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}

//å¯¹Singletonè¿›è¡Œæ”¹é€ 
class Singleton {
    //æ„é€ å™¨ç§æœ‰åŒ–ï¼Œå¤–éƒ¨ä¸èƒ½é€šè¿‡new åˆ›å»º
    private Singleton() {
        if(instance!=null){
            throw new RuntimeException("ç¦æ­¢åå°„æ„é€ ");
        }
    }
    //æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹
    private final static Singleton instance = new Singleton();

    //æä¾›ä¸€ä¸ªå…¬æœ‰çš„ç«æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}

```

# â—å·¥å‚æ¨¡å¼ğŸ”µ

## ç®€å•å·¥å‚æ¨¡å¼ 
> å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œå¯ä»¥æ ¹æ®å‚æ•°ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç®€å•å·¥å‚æ¨¡å¼ç¤ºæ„å›¾.png)

å®ä¾‹ï¼š å¼€å‘ä¸€å¥—å›¾è¡¨åº“ï¼Œå¯ä»¥ä¸ºç³»ç»Ÿæä¾›å¤šç§å›¾è¡¨ï¼ŒæŸ±çŠ¶å›¾ï¼Œé¥¼çŠ¶å›¾ï¼ŒæŠ˜çº¿å›¾ï¼Œä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼è®¾è®¡å¦‚å›¾   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç®€å•å·¥å‚æ¨¡å¼ç¤ºä¾‹.png)

**å†æ¬¡ç®€åŒ–**   
å¯ä»¥å°†ï¼ŒæŠ½è±¡çˆ¶ç±»å’Œå·¥å‚ç±»åˆå¹¶ï¼Œå°†é™æ€å·¥å‚æ–¹æ³•ç§»è‡³æŠ½è±¡äº§å“ç±»ä¸­ï¼Œ

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç®€å•å·¥å‚æ¨¡å¼å†ç®€åŒ–.png)

å®¢æˆ·ç«¯å¯ä»¥ç›´æ¥é€šè¿‡è°ƒç”¨æŠ½è±¡çˆ¶ç±»çš„é™æ€å·¥å‚æ–¹æ³•ï¼Œæ ¹æ®å‚æ•°ä¸åŒåˆ›å»ºä¸åŒçš„äº§å“å­ç±»å¯¹è±¡   

```java
//é™æ€å·¥å‚æ¡ˆä¾‹  
public class ChartFactory{
    public static Chart getChart(String type){
        Chart chart = null;
        if(type.equals("histogram")){
            //è®¾ç½®æŸ±çŠ¶å›¾
            chart = new HistogramChart();
            
        }else if(type.equals("pie")){
            //è®¾ç½®é¥¼çŠ¶å›¾
            chart = new PieChart();
            
        }else if(type.equals("line")){
            //è®¾ç½®æŠ˜çº¿å›¾
            chart = new LineChart();
            
        }
    }
}
```

## å·¥å‚æ–¹æ³•æ¨¡å¼

å·¥å‚æ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œä½†æ˜¯è®©å­ç±»å†³å®šå°†å“ªä¸€ä¸ªç±»å®ä¾‹åŒ–ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼è®©ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å·¥å‚æ–¹æ³•æ¨¡å¼.png)

- `Product`(æŠ½è±¡äº§å“) å®ƒæ˜¯å®šä¹‰äº§å“çš„æ¥å£ï¼Œæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼æ‰€åˆ›å»ºå¯¹è±¡çš„è¶…ç±»å‹ï¼Œä¹Ÿå°±æ˜¯**äº§å“å¯¹è±¡**çš„å…¬å…±çˆ¶ç±»
- `ConcreteProduct`(å…·ä½“äº§å“) å®ƒå®ç°äº†æŠ½è±¡äº§å“æ¥å£ï¼ŒæŸç§ç±»å‹çš„å…·ä½“äº§å“ç”±ä¸“é—¨çš„å…·ä½“å·¥å‚åˆ›å»ºï¼Œ**å…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ä¹‹é—´ä¸€ä¸€å¯¹åº”**  
- `Factory`(æŠ½è±¡å·¥å‚) åœ¨æŠ½è±¡å·¥å‚ç±»ä¸­å£°æ˜äº†å·¥å‚æ–¹æ³•`Factory Method`ï¼Œç”¨äºè¿”å›ä¸€ä¸ªäº§å“ï¼ŒæŠ½è±¡å·¥å‚æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œæ‰€æœ‰åˆ›å»ºå¯¹è±¡çš„å·¥å‚ç±»éƒ½å¿…é¡»å®ç°è¯¥æ¥å£ 
- `ConcreateFactory`(å…·ä½“å·¥å‚) å®ƒæ˜¯æŠ½è±¡å·¥å‚ç±»çš„å­ç±»ï¼Œå®ç°äº†åœ¨æŠ½è±¡å·¥å‚ä¸­å£°æ˜çš„å·¥å‚æ–¹æ³•ï¼Œå¹¶å¯ç”±å®¢æˆ·ç«¯è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ª**å…·ä½“äº§å“å®ä¾‹**  

### æ¨¡å¼å®ç°

1. æŠ½è±¡å·¥å‚`Factory`ï¼Œå¯ä»¥æ˜¯æ¥å£ä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡ç±»ï¼Œæœ¬ä¾‹ç”¨æ¥å£,æŠ½è±¡å·¥å‚ä¸­å£°æ˜å·¥å‚æ–¹æ³•ï¼Œä½†å¹¶æœªå®ç°

```java
public interface Factory{
    public Product factroyMethod();
}
```

2. å…·ä½“å·¥å‚`ConcreateFactory` å®ç°å·¥å‚æ–¹æ³•ï¼Œä¸åŒå…·ä½“å·¥å‚åˆ›å»ºä¸åŒçš„å…·ä½“äº§å“`ConcreteProduct`  

```java
public class ConcreteFactory implements Factory{
    public Product factoryMethod(){
        return new ConcreteProduct();
    }
}
```

3. `Product`(æŠ½è±¡äº§å“)å’Œ`ConcreteProduct`(å…·ä½“äº§å“)

```java

public interface Product{
    public void printProduct();
}

public class ConcreteProduct implements Product{
     
    @Override
    public void printProduct(){
        System.out.println("æ‰“å°å…·ä½“äº§å“");
    };
}

```

4. å®¢æˆ·ç«¯è°ƒç”¨æ–¹æ³•

```java
public class Test{
    public static void main(String[] args){
        Factory factory;
        factory = new ConcreteFactory();
        Product product;
        product = factory.factoryMethod();
        product.printProduct();//è°ƒç”¨å®é™…æ–¹æ³•
    }
}
```

### é€‚ç”¨åœºæ™¯

- **ä¸€ä¸ªç±»ä¸çŸ¥é“ä»–æ‰€éœ€è¦çš„å¯¹è±¡çš„ç±»ï¼š**å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“å…·ä½“äº§å“ç±»åï¼Œåªéœ€çŸ¥é“å¯¹åº”çš„å·¥å‚å³å¯ï¼Œé€šè¿‡å…·ä½“å·¥å‚æ„å»ºå…·ä½“äº§å“å¯¹è±¡
- **ä¸€ä¸ªç±»é€šè¿‡å…¶å­ç±»æ¥æŒ‡å®šåˆ›å»ºé‚£ä¸ªå¯¹è±¡ï¼š**å¯¹äºæŠ½è±¡å·¥å‚ç±»åªéœ€æä¾›ä¸€ä¸ªåˆ›å»ºäº§å“çš„æ¥å£ï¼Œç”±å…¶å­ç±»æ¥å»æ¬¸çš„é‚£ä¸ªå…·ä½“è¯åˆ›å»ºçš„å¯¹è±¡ï¼Œåˆ©ç”¨é¢å‘å¯¹è±¡çš„å¤šæ€æ€§å’Œé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå­ç±»è¦†ç›–çˆ¶ç±»å¯¹è±¡ï¼Œä½¿å¾—ç³»ç»Ÿå®¹æ˜“æ‰©å±•  
- å°†åˆ›å»ºå¯¹è±¡çš„ä»»åŠ¡å§”æ‰˜ç»™å¤šä¸ªå·¥å‚å­ç±»ï¼Œå®¢æˆ·ç«¯åœ¨ä½¿ç”¨æ—¶æ— éœ€å…³å¿ƒé‚£ä¸€ä¸ªå·¥å‚å­ç±»åˆ›å»ºäº§å“å­ç±»ï¼Œéœ€è¦æ˜¯å†åŠ¨æ€æŒ‡å®š


### æœ€ç»ˆè¯´æ˜
æ¯å¢åŠ ä¸€ä¸ª**å…·ä½“äº§å“**å¯¹åº”ä¸€ä¸ª**å…·ä½“å·¥å‚**ï¼Œæˆ‘ä»¬éƒ½è¦å¢åŠ ä¸€ä¸ªç»§æ‰¿äºå·¥å‚æ¥å£`Factory`çš„å…·ä½“å·¥å‚ç±» `ConcreteFactory`   
æ‰€ä»¥ï¼Œå½“äº§å“æ•°é‡ä¸Šæ¶¨ï¼Œç³»ç»Ÿä¸­çš„ç±»ä¼š**æˆå€**å¢åŠ    

å·¥å‚æ–¹æ³•æ¨¡å¼å’Œç®€å•å·¥å‚æ¨¡å¼è™½ç„¶éƒ½æ˜¯é€šè¿‡å·¥å‚æ¥åˆ›å»ºå¯¹è±¡ï¼Œä»–ä»¬ä¹‹é—´æœ€å¤§çš„ä¸åŒæ˜¯â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼åœ¨è®¾è®¡ä¸Šå®Œå…¨å®Œå…¨ç¬¦åˆ`å¼€é—­åŸåˆ™`ã€‚  

### ä½¿ç”¨åœºæ™¯
- æ—¥å¿—è®°å½•å™¨ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©è®°å½•æ—¥å¿—ä½ç½®
- æ•°æ®åº“è®¿é—®ï¼Œä¸åŒçš„æ•°æ®åº“è¿æ¥æ± è¿”å›ä¸åŒçš„è¿æ¥  

```java
    @ConfigurationProperties(prefix = "spring.datasource")
    @Bean
    public DataSource druid(){
        return  new DruidDataSource();
    }
```

- è®¾è®¡ä¸€ä¸ªè¿æ¥æœåŠ¡å™¨çš„æ¡†æ¶ï¼Œéœ€è¦ä¸‰ä¸ªåè®®ï¼Œ"POP3"ã€"IMAP"ã€"HTTP"ï¼Œå¯ä»¥æŠŠè¿™ä¸‰ä¸ªä½œä¸ºäº§å“ç±»ï¼Œå…±åŒå®ç°ä¸€ä¸ªæ¥å£

## æŠ½è±¡å·¥å‚æ¨¡å¼
æŠ½è±¡å·¥å‚ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šä»–ä»¬å…·ä½“çš„ç±»  

- `AbstractFactory` æŠ½è±¡å·¥å‚ï¼Œç”¨äºå£°æ˜ç”ŸæˆæŠ½è±¡äº§å“çš„æ–¹æ³•
- `ConcreteFactory` å…·ä½“å·¥å‚ï¼Œå®ç°æŠ½è±¡å·¥å‚å®šä¹‰çš„æ–¹æ³•ï¼Œå…·ä½“å®ç°ä¸€ç³»åˆ—äº§å“å¯¹è±¡çš„åˆ›å»º
- `AbstractProduct` æŠ½è±¡äº§å“ï¼Œå®šä¹‰ä¸€ç±»äº§å“å¯¹è±¡çš„æ¥å£
- `ConcreteProduct` å…·ä½“äº§å“ï¼Œäº§å“å…·ä½“å®ç°

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æŠ½è±¡å·¥å‚æ¨¡å¼ç¤ºæ„å›¾.png)

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æŠ½è±¡å·¥å‚æ¨¡å¼ç»“æ„å›¾.png)

?> **æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼ŒæŠ½è±¡å·¥å‚æœ‰å¤šä¸ªæŠ½è±¡äº§å“ç±»**  

> æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¸€æ ·ï¼Œéƒ½ç¬¦åˆ`å¼€é—­åŸåˆ™`ã€‚ä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼åœ¨å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“çš„æ—¶å€™ï¼Œéƒ½è¦å¢åŠ å¯¹åº”çš„å·¥å‚ã€‚ä½†æ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼åªæœ‰åœ¨æ–°å¢ä¸€ä¸ªç±»å‹çš„å…·ä½“äº§å“æ—¶æ‰éœ€è¦æ–°å¢å·¥å‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ**å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ä¸ªå·¥å‚åªèƒ½åˆ›å»ºä¸€ä¸ªå…·ä½“äº§å“**ã€‚è€Œ**æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸€ä¸ªå·¥å‚å¯ä»¥åˆ›å»ºå±äºä¸€ç±»ç±»å‹çš„å¤šç§å…·ä½“äº§å“**ã€‚**å·¥å‚åˆ›å»ºäº§å“çš„ä¸ªæ•°ä»‹äºç®€å•å·¥å‚æ¨¡å¼å’Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¹‹é—´**ã€‚

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æŠ½è±¡å·¥å‚æ¨¡å¼uml.jpg)



## ä¸‰ç§å·¥å‚çš„ä¸»è¦åŒºåˆ«
ç±»åˆ« | æŠ½è±¡å·¥å‚ | å…·ä½“å·¥å‚| æŠ½è±¡äº§å“ | å…·ä½“äº§å“ 
---------|----------|---------|---------|---------
 ç®€å•å·¥å‚ | 1 | 0| 1| 1
 å·¥å‚æ¨¡å¼ | 1 | N| 1| N
 æŠ½è±¡å·¥å‚ | 1 | N| N| N


## å¸¸è§çš„å·¥å‚æ¨¡å¼  
- Springçš„ Bean å·¥å‚ï¼ŒIOC é€šè¿‡`BeanFactory`å¯¹Bean è¿›è¡Œç®¡ç†
- `Calendar.getInstance()`è°ƒç”¨ä¹Ÿé‡‡ç”¨äº†ç®€å•å·¥å‚æ¨¡å¼  

```java
...
        Calendar cal = null;

        if (aLocale.hasExtensions()) {
            String caltype = aLocale.getUnicodeLocaleType("ca");
            if (caltype != null) {
                switch (caltype) {
                case "buddhist":
                cal = new BuddhistCalendar(zone, aLocale);
                    break;
                case "japanese":
                    cal = new JapaneseImperialCalendar(zone, aLocale);
                    break;
                case "gregory":
                    cal = new GregorianCalendar(zone, aLocale);
                    break;
                }
            }
        }
        ...
        return cal;
```

# â—åŸå‹æ¨¡å¼ğŸ”µ
**åŸå‹æ¨¡å¼**: ä½¿ç”¨åŸå‹å®ä¾‹æŒ‡å®šå¸¦åˆ›å»ºçš„å¯¹è±¡çš„ç±»å‹ï¼Œå¹¶ä¸”é€šè¿‡å¤åˆ¶è¿™ä¸ªåŸå‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡    

> æ¡ˆä¾‹å‚è€ƒï¼Œ`Java`ä¸­`Object`ç±»æ˜¯æ‰€æœ‰ç±»çš„åŸºç±»ï¼Œ`Object`æä¾›äº†ä¸€ä¸ª`clone()`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ª`Java`å¯¹è±¡è¿›è¡Œå¤åˆ¶ï¼Œä½¿ç”¨è¯¥æ–¹æ³•éœ€è¦å®ç°æ¥å£`Cloneable`

åŸå‹æ¨¡å¼æ˜¯ä¸€ç§`åˆ›å»ºå‹`è®¾è®¡æ¨¡å¼ï¼Œå…è®¸ä¸€ä¸ªå¯¹è±¡å†åˆ›å»ºå¦å¤–ä¸€ä¸ªå¯å®šåˆ¶çš„å¯¹è±¡ï¼Œæ— éœ€çŸ¥é“å¦‚ä½•åˆ›å»ºçš„ç»†èŠ‚   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/åŸå‹æ¨¡å¼UMLç±»å›¾.png)

- `Prototype`æŠ½è±¡åŸå‹ç±»ï¼Œå£°æ˜å…‹éš†æ–¹æ³•çš„æ¥å£ï¼Œå¯ä»¥æ˜¯æ¥å£ã€æŠ½è±¡ç±»
- `ConcretePrototype`å…·ä½“åŸå‹ç±»ï¼Œå®ç°`Prototype`ä¸­çš„å…‹éš†æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­è¿”å›è‡ªå·±çš„å…‹éš†å¯¹è±¡
- `Clinet`å®¢æˆ·ç±»ï¼Œå®ä¾‹åŒ–å…·ä½“åŸå‹ç±»åï¼Œé€šè¿‡å…¶å…‹éš†æ–¹æ³•å¾—åˆ°å¤šä¸ªç›¸åŒå¯¹è±¡   

## åº”ç”¨ 
åŸå‹æ¨¡å¼ç”¨ä½œå¿«é€Ÿåˆ›å»ºå¤§é‡çš„ç›¸åŒæˆ–è€…ç›¸ä¼¼å¯¹è±¡ï¼Œç®€åŒ–åˆ›å»ºç»“æ„ï¼Œé€šè¿‡å°è£…åœ¨åŸå‹ä¸­ç±»çš„å…‹éš†æ–¹æ³•æ¥å®ç°åˆ›å»ºé‡å¤å¯¹è±¡   

### Spring Bean çš„ prototype å’Œ singleton  
> è‹¥beançš„scope æ˜¯ prototype æ¯æ¬¡getbean éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè‹¥æ˜¯singletonä½¿ç”¨getbeanå¾—åˆ°çš„å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡


## æµ…å…‹éš†(æ‹·è´)  
åŸå‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹(`int` `byte` `double`...)ï¼Œå°±ä¼šå¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼Œè‹¥æ˜¯å¼•ç”¨å¯¹è±¡ï¼Œå°±ä¼šå¼•ç”¨ç›¸åŒçš„å†…å­˜åœ°å€(æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªå¯¹è±¡)    
**åŸºæœ¬æ•°æ®å’Œå¯¹è±¡æœ¬èº«å¤åˆ¶ï¼Œå¼•ç”¨å¯¹è±¡ä»æ˜¯åŒä¸€ä¸ª**  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æµ…å…‹éš†ç¤ºæ„å›¾.png)

## æ·±å…‹éš†(æ‹·è´)  
æ— è®ºå¯¹è±¡çš„æˆå‘˜å˜é‡æ˜¯å€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ï¼Œéƒ½å°†å¤åˆ¶ä¸€ä»½ç»™å…‹éš†å¯¹è±¡ï¼Œ

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ·±å…‹éš†ç¤ºæ„å›¾.png)

å¯ä»¥é€šè¿‡å¼•ç”¨ç±»å‹å®ç°`Cloneable`æ¥å£ æˆ–è€… **å…ˆåºåˆ—åŒ–å†ååºåˆ—åŒ–**è¿™ä¸¤ç§æ–¹å¼å®ç°æ·±æ‹·è´    

```java
public class DeepPrototype implements Serializable, Cloneable {

    private static final long serialVersionUID = -6552383604366032330L;
    public String name;
    public Sheep sheep;

    public DeepPrototype() {
        super();
    }

    /**
     * é‡å†™å…‹éš†æ–¹æ³•è¿”å›è‡ªå·±çš„DeepPrototypeå¯¹è±¡
     */
    @Override
    protected Object clone() throws CloneNotSupportedException {
        Object deep = null;
        deep = super.clone();
        DeepPrototype deepPrototype = (DeepPrototype) deep;
        deepPrototype.sheep = (Sheep) sheep.clone();
        return deep;
    }

    //é€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å®ç°æ·±æ‹·è´
    public Object deepClone() throws IOException {
        //åˆ›å»ºæµå¯¹è±¡
        ByteArrayOutputStream bos = null;
        ObjectOutputStream oos = null;
        ByteArrayInputStream bis = null;
        ObjectInputStream ois = null;
        try {
            //åºåˆ—åŒ–
            bos = new ByteArrayOutputStream();
            oos = new ObjectOutputStream(bos);
            oos.writeObject(this);

            //ååºåˆ—åŒ–
            bis = new ByteArrayInputStream(bos.toByteArray());
            ois = new ObjectInputStream(bis);
            DeepPrototype o = (DeepPrototype) ois.readObject();
            return o;

        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
            return null;
        } finally {
            bos.close();
            oos.close();
            bis.close();
            ois.close();
        }
    }
}
```

# å»ºé€ è€…æ¨¡å¼ ğŸ”µ 
å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤º  

å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒå°†å®¢æˆ·ç«¯ä¸åŒ…å«å¤šä¸ªä¸è§çš„å¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹åˆ†ç¦»ï¼Œå®¢æˆ·ç«¯æ— éœ€çŸ¥é“å¤æ‚å¯¹è±¡çš„å†…éƒ¨ç»„æˆéƒ¨åˆ†ä¸è£…é…æ–¹å¼ï¼Œåªéœ€è¦çŸ¥é“æ‰€éœ€å»ºé€ è€…çš„ç±»å‹å³å¯ã€‚å»ºé€ è€…æ¨¡å¼å…³æ³¨å¦‚ä½•ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºä¸€ä¸ªå¤æ‚å¯¹è±¡ï¼Œä¸åŒçš„å»ºé€ è€…å®šä¹‰äº†ä¸åŒçš„åˆ›å»ºè¿‡ç¨‹ã€‚

## ç»“æ„
- `Builder`æŠ½è±¡å»ºé€ è€…ï¼Œä¸ºåˆ›å»ºä¸€ä¸ªäº§å“çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šæŠ½è±¡æ¥å£ï¼Œä¸€èˆ¬å£°æ˜ä¸¤ç±»æ–¹æ³•ï¼Œä¸€ç§æ˜¯`buildPartX()`æ„å»ºéƒ¨ä»¶ï¼Œå¦ä¸€ç§æ˜¯è¿”å›æ•´ä½“çš„å¯¹è±¡
- `ConcreteBuilder`å…·ä½“å»ºé€ è€…ï¼Œå®ç°äº†`Builder`æ¥å£
- `Product`äº§å“ï¼Œè¢«æ„å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ªç»„æˆéƒ¨ä»¶ï¼Œé€šè¿‡å…·ä½“å»ºé€ è€…è¿›è¡Œæ„å»º
- `Director`æŒ‡æŒ¥è€…ï¼Œè´Ÿè´£å®‰æ’å¤æ‚å¯¹è±¡çš„å»ºé€ æ¬¡åºå³`buildPartX()`çš„è°ƒç”¨é¡ºåº

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å»ºé€ è€…æ¨¡å¼ç¤ºæ„å›¾.png)

## æ„å»ºå®ç°

1. æ„å»ºä¸€ä¸ªå¤æ‚å¯¹è±¡ç±»ï¼ŒåŒ…å«å¤šä¸ªå±æ€§(éƒ¨ä»¶)

```java
public class Product {
    private String partA;
    private String partB;
    private String partC;
    //çœç•¥set get
    ...
}
```
2. æŠ½è±¡å»ºé€ è€…ç±»ï¼Œå®šä¹‰å»ºé€ è€…æ¨¡æ¿ï¼Œå®šä¹‰æŠ½è±¡æ„å»ºæ–¹æ³•å’Œè¿”å›å¯¹è±¡æ–¹æ³• 

```java
public abstract class Builder {
    //äº§å“å¯¹è±¡
    protected Product product = new Product();
    //æ„å»ºéƒ¨åˆ†
    public abstract void buildPartA();

    public abstract void buildPartB();

    public abstract void buildPartC();
    
    public Product getProduct() {
        return product;
    }

}
```
3. å…·ä½“å»ºé€ è€…ç±»ï¼ŒçœŸæ­£è´Ÿè´£å»ºé€ åŠŸèƒ½çš„å…·ä½“å®ç°ï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥æœ‰å¤šä¸ª

```java
public class ConcreteBuilder extends Builder {

    @Override
    public void buildPartA() {
        System.out.println("æ„å»ºA");
        product.setPartA("AA");
    }

    @Override
    public void buildPartB() {
        System.out.println("æ„å»ºB");
        product.setPartB("BB");
    }

    @Override
    public void buildPartC() {
        System.out.println("æ„å»ºC");
        product.setPartC("CC");
    }
}
```
4. æŒ‡æŒ¥è€…ç±»Director ï¼Œæ§åˆ¶äº§å“å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå†³å®šè°ƒç”¨buildpartæ¬¡åº,æ¥æ”¶ä¸åŒçš„builderæ¥å¯¹å…¶è¿›è¡Œæ„å»º  

```java
public class Director {
    private Builder builder;
    //æ„é€ å™¨ä¼ å…¥
    public Director(Builder builder) {
        this.builder = builder;
    }
    //æ„é€ æ–¹æ³•ä¼ å…¥
    public void setBuilder(Builder builder) {
        this.builder = builder;
    }

    public Product construct() {
        builder.buildPartA();
        builder.buildPartB();
        builder.buildPartC();
        return builder.getProduct();
    }
}
```
5. å®é™…è°ƒç”¨ï¼Œæ— éœ€å…³å¿ƒå…·ä½“å»ºé€ è€…çš„ç±»å‹ï¼Œæ— éœ€å…³å¿ƒäº§å“å¯¹è±¡çš„å…·ä½“ç»„è£…è¿‡ç¨‹,æ›´æ¢`ConcreteBuilder`æ— éœ€æ”¹å˜ä»£ç 

```java
    ...
    ConcreteBuilder concreteBuilder = new ConcreteBuilder();
    Director director = new Director(concreteBuilder);
    director.construct();

    ConcreteBuilder2 concreteBuilder2 = new ConcreteBuilder2();
    Director director2 = new Director(concreteBuilder2);
    director2.construct();
    ...
```

## ä¼˜åŒ–è®¨è®º 
> æŒ‡æŒ¥è€…ç±»Directoræ˜¯å»ºé€ è€…æ¨¡å¼çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œè´Ÿè´£æŒ‡å¯¼å¦‚ä½•æ„å»ºäº§å“ï¼Œæ§åˆ¶è°ƒç”¨å…ˆåæ¬¡åºï¼Œä¸‹é¢æ˜¯å‡ ç§Directorçš„å˜ç§å½¢å¼   

### çœç•¥Director 
ä¸ºäº†ç®€åŒ–ç³»ç»Ÿï¼Œå¯ä»¥   
1. å°†`Director` å’ŒæŠ½è±¡å»ºé€ è€…Builderè¿›è¡Œåˆå¹¶
2. å°†`construct`æ–¹æ³•ä¸­çš„å‚æ•°å»æ‰ï¼Œç›´æ¥ä½¿ç”¨thisè°ƒç”¨  

```java
public abstract class Builder2 {
    //äº§å“å¯¹è±¡
    protected Product product = new Product();
    //æ„å»ºéƒ¨åˆ†
    public abstract void buildPartA();
    public abstract void buildPartB();
    public abstract void buildPartC();
    public Product getProduct() {
        return product;
    }
    //ç¬¬ä¸€ç§ç®€åŒ–
    public static Product construct(Builder2 builder) {
        builder.buildPartA();
        builder.buildPartB();
        builder.buildPartC();
        return builder.getProduct();
    }
    //ç¬¬äºŒç§ç®€åŒ–
    public Product construct2() {
        this.buildPartA();
        this.buildPartB();
        this.buildPartC();
        return this.getProduct();
    }

}
```

```java
    ...
    //ç¬¬ä¸€ç§è°ƒç”¨
    ConcreteBuilder2 concreteBuilder2 = new ConcreteBuilder2();
    ConcreteBuilder2.construct(concreteBuilder2);
    ...

    //ç¬¬äºŒç§è°ƒç”¨
    ConcreteBuilder2 concreteBuilder2 = new ConcreteBuilder2();
    concreteBuilder2.construct2();

```

### é’©å­æ–¹æ³•æ§åˆ¶
é€šè¿‡é’©å­æ–¹æ³•æ§åˆ¶æ˜¯å¦æ„å»ºæŸä¸ªPartX    
1. æŠ½è±¡å»ºé€ è€…æ„å»ºé’©å­æ–¹æ³• 

```java
public abstract class Builder3 {
    //äº§å“å¯¹è±¡
    protected Product product = new Product();
    //æ„å»ºéƒ¨åˆ†
    public abstract void buildPartA();

    public abstract void buildPartB();

    public abstract void buildPartC();

    public Product getProduct() {
        return product;
    }
    //æ§åˆ¶æ˜¯å¦æ„å»º part A
    public boolean isBuildA(){
        return false;
    }
}
```
2. å…·ä½“å»ºé€ è€… æ ¹æ®éœ€æ±‚å®ç°æ–¹æ³•`isBuildA`,é‡å†™æ–¹æ³•å¹¶è¿”å›trueå°±èƒ½åœ¨Directorä¸­åˆ¤æ–­æ„å»ºA

```java
public class ConcreteBuilder3 extends Builder3 {

    @Override
    public void buildPartA() {
    }
    @Override
    public void buildPartB() {
    }
    @Override
    public void buildPartC() {
    }

    //é‡å†™è¿™ä¸ªæ–¹æ³•å°±èƒ½æ„å»ºA ä¸é‡å†™å°±ä¸èƒ½æ„å»ºA
    @Override
    public boolean isBuildA() {
        return true;
    }
}
```

3. Director ï¼Œåœ¨è°ƒç”¨directoræ—¶ ä¼ å…¥ä¸åŒçš„`ConcreteBuilder` å°±èƒ½å®ç°Açš„æ„å»ºæ§åˆ¶

```java
public class Director2 {
    private Builder3 builder;
    //æ„é€ å™¨ä¼ å…¥
    public Director2(Builder3 builder) {
        this.builder = builder;
    }
    //æ„é€ æ–¹æ³•ä¼ å…¥
    public void setBuilder(Builder3 builder) {
        this.builder = builder;
    }

    public Product construct() {
        //å®é™…æ§åˆ¶
        if (builder.isBuildA()){
            builder.buildPartA();
        }
        builder.buildPartB();
        builder.buildPartC();
        return builder.getProduct();
    }
}

```

## é€‚ç”¨åœºæ™¯  

- ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥é¿å…é‡å æ„é€ å‡½æ•°çš„å‡ºç° 
- ä½¿ç”¨ä»£ç åˆ›å»ºä¸åŒå½¢å¼çš„äº§å“
- ä½¿ç”¨ç”Ÿæˆå™¨æ„é€ ç»„åˆæ ‘æˆ–å…¶ä»–å¤æ‚å¯¹è±¡ 

# ç»“æ„å‹æ¨¡å¼ğŸ”´

ç»“æ„å‹æ¨¡å¼å…³æ³¨å¦‚ä½•å°†ç°æœ‰ç±»æˆ–å¯¹è±¡ç»„ç»‡åœ¨ä¸€èµ·å½¢æˆæ›´å¼ºå¤§çš„ç»“æ„ã€‚ä¸åŒçš„æœºæ„å‹æ¨¡å¼ä»ä¸åŒçš„è§’åº¦æ¥ç»„åˆç±»æˆ–å¯¹è±¡   

ç»“æ„å‹æ¨¡å¼å¯ä»¥æè¿°ä¸¤ç§ä¸åŒçš„ä¸œè¥¿ï¼Œ**ç±»ä¸ç±»çš„å®ä¾‹(å¯¹è±¡)**ï¼Œæ ¹æ®è¿™ä¸€ç‚¹ï¼Œç»“æ„å‹æ¨¡å¼å¯ä»¥åˆ†ä¸º`ç±»ç»“æ„å‹æ¨¡å¼`å’Œ`å¯¹è±¡ç»“æ„å‹æ¨¡å¼`  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç»“æ„å‹æ¨¡å¼ä¸€è§ˆ.png)

# é€‚é…å™¨æ¨¡å¼ğŸ”´
é€‚é…å™¨æ¨¡å¼`Adapter Pattern`ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œé€‚é…å™¨æ¨¡å¼è®©é‚£äº›**æ¥å£ä¸å…¼å®¹çš„ç±»**å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œåˆ«ååŒ…è£…å™¨`Wrapper`æ¨¡å¼

å¯ä»¥ç±»æ¯”ä¸ºç”µæºè½¬æ¥å¤´ã€æ‰‹æœºå……ç”µå™¨...  

## ç»“æ„
é€‚é…å™¨æ¨¡å¼åŒ…æ‹¬**ç±»é€‚é…å™¨**å’Œ**å¯¹è±¡é€‚é…å™¨**ï¼Œåœ¨å¯¹è±¡é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œé€‚é…å™¨å’Œé€‚é…è€…ä¹‹é—´çš„å…³ç³»æ˜¯å…³è”å…³ç³»ï¼›åœ¨ç±»é€‚é…å™¨æ¨¡å¼ä¸­ï¼Œé€‚é…å™¨ä¸é€‚é…è€…ä¹‹é—´æ˜¯ç»§æ‰¿(æˆ–å®ç°)çš„å…³ç³»     
- `Target` ç›®æ ‡æŠ½è±¡ç±»ï¼Œå®šä¹‰å®¢æˆ·æ‰€éœ€æ¥å£ï¼Œå¯ä»¥æ˜¯æŠ½è±¡ç±»ã€æ¥å£ã€å…·ä½“ç±»ï¼Œ`ç±»é€‚é…å™¨`ä¸­ï¼Œç”±äºjavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ‰€ä»¥å®ƒåªèƒ½æ˜¯æ¥å£
- `Adapter` é€‚é…å™¨ç±»ï¼Œå¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªæ¥å£ï¼Œä½œä¸ºä¸€ä¸ªè½¬æ¢å™¨ï¼Œå¯¹`Adaptee`å’Œ`Target`è¿›è¡Œé€‚é…ï¼Œé€šè¿‡å®ç°`Target`æ¥å£å¹¶ç»§æ‰¿`Adaptee`ç±»æ¥ä½¿äºŒè€…äº§ç”Ÿè”ç³»  
- `Adaptee`é€‚é…è€…ç±»(è¢«é€‚é…)ï¼Œå®šä¹‰äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£éœ€è¦è¢«é€‚é…   


![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç±»é€‚é…å™¨æ¨¡å¼ç»“æ„å›¾.png)

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¯¹è±¡é€‚é…å™¨æ¨¡å¼ç»“æ„å›¾.png)

## ç±»é€‚é…å™¨
ä»¥æ‰‹æœºå……ç”µæ¥å¤´ä¸ºä¾‹  
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/é€‚é…å™¨æ¨¡å¼æ‰‹æœºæ¡ˆä¾‹å›¾.png)

```java
public class Voltage220V {
    public int output220V(){
        int src = 220;
        System.out.println("è¾“å‡º"+src+"V");
        return src;
    }
}

public interface Voltage5V {
    int output5V();
}

public class VoltageAdapter extends Voltage220V implements Voltage5V{
    @Override
    public int output5V() {
        //è·å–220V
        int i = output220V();
        //ç”µå‹è½¬æ¢
        int dst = i/44;
        return dst;
    }
}

public class Phone {
    public void charging(Voltage5V i){
        if (i.output5V()==5){
            System.out.println("å¯ä»¥å……ç”µ");
        }else{
            System.out.println("ç”µå‹ä¸åˆæ ¼ï¼Œæ— æ³•å……ç”µ");
        }

    }

    public static void main(String[] args) {
        //è°ƒç”¨å®ä¾‹
        Phone phone = new Phone();
        phone.charging(new VoltageAdapter());
    }
}
```

## å¯¹è±¡é€‚é…å™¨ 
å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨æ€è·¯åŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯ç”±äºç±»é€‚é…å™¨ä¸­å­˜åœ¨**ç»§æ‰¿å…³ç³»**   
æ ¹æ®`åˆæˆå¤ç”¨åŸåˆ™` å°½é‡ä½¿ç”¨`åˆæˆ/èšåˆ`å…³ç³»æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ï¼Œæ¥è¿›è¡Œä¿®æ”¹   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¯¹è±¡é€‚é…å™¨æ¨¡å¼æ‰‹æœºæ¡ˆä¾‹å›¾.png)

```java
public class VoltageAdapter1  implements Voltage5V{
    private Voltage220V voltage220V;

    public VoltageAdapter1(Voltage220V voltage220V) {
        this.voltage220V = voltage220V;
    }

    @Override
    public int output5V() {
        int dst = 0;
        if(voltage220V!=null){
            //è·å–220V
            int i = voltage220V.output220V();
            //ç”µå‹è½¬æ¢
            dst = i/44;
        }

        return dst;
    }
}

```

è°ƒç”¨ä¿®æ”¹ä¸ºï¼š  

```java
...
Phone phone = new Phone();
phone.charging(new VoltageAdapter1(new Voltage220V()));
...

```

## ç¼ºçœé€‚é…å™¨(å•æ¥å£é€‚é…å™¨)æ¨¡å¼
å½“ä¸éœ€è¦å®ç°ä¸€ä¸ªæ¥å£æä¾›çš„æ‰€æœ‰æ–¹æ³•æ—¶ï¼Œå¯ä»¥å…ˆè®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»å®ç°è¯¥æ¥å£ï¼Œå¹¶ä¸ºæ¥å£ä¸­çš„æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ï¼ˆç©ºæ–¹æ³•ï¼‰,é‚£ä¹ˆè¯¥æŠ½è±¡ç±»çš„å­ç±»å¯ä»¥é€‰æ‹©æ€§çš„è¦†ç›–çˆ¶ç±»çš„æŸäº›æ–¹æ³•æ¥å®ç°éœ€æ±‚     
- `ServiceInterface`é€‚é…è€…æ¥å£
- `AbstractServiceClass`ç¼ºçœé€‚é…å™¨ç±» å®ƒæ˜¯ç¼ºçœé€‚é…å™¨æ¨¡å¼çš„æ ¸å¿ƒç±»ï¼Œä½¿ç”¨ç©ºæ–¹æ³•çš„å½¢å¼å®ç°äº† `ServiceInterface`ä¸­å£°æ˜çš„æ–¹æ³•  
- `ConcreteServiceClass`å…·ä½“ä¸šåŠ¡ç±»ï¼Œç¼ºçœé€‚é…å™¨ç±»çš„å­ç±»ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©è¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç¼ºçœé€‚é…å™¨æ¨¡å¼ç»“æ„å›¾.png)

## ä¼˜ç¼ºç‚¹å’Œç»†èŠ‚

### ä¼˜ç‚¹
- å°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œé€šè¿‡å¼•å…¥ä¸€ä¸ªé€‚é…å™¨ç±»æ¥é‡ç”¨ç°æœ‰çš„é€‚é…è€…ç±»ï¼Œæ— éœ€ä¿®æ”¹åŸæœ‰ç»“æ„
- å¢åŠ äº†ç±»çš„é€æ˜æ€§å’Œå¤ç”¨æ€§
- çµæ´»æ€§å’Œæ‰©å±•æ€§éƒ½å¾ˆå¥½

## é€‚é…å™¨æ¨¡å¼åœ¨SpringMVCä¸­çš„åº”ç”¨
P64


# æ¡¥æ¥æ¨¡å¼ğŸ”´
å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†è§£è€¦ï¼Œä½¿å¾—ä¸¤è€…éƒ½èƒ½å¤Ÿç‹¬ç«‹å˜åŒ–ã€‚  

> åœ¨æ¡¥æ¥æ¨¡å¼ä¸­å°†ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦è®¾è®¡ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„ç»§æ‰¿ç­‰çº§ç»“æ„ï¼Œè€Œä¸æ˜¯å°†äºŒè€…è€¦åˆåœ¨ä¸€èµ·å½¢æˆå¤šå±‚ç»§æ‰¿ç»“æ„ï¼Œæ¡¥æ¥æ¨¡å¼åœ¨æŠ½è±¡å±‚å»ºç«‹èµ·ä¸€ä¸ªæŠ½è±¡å…³è”ï¼Œè¯¥å…³è”å…³ç³»ç±»ä¼¼ä¸€æ¡è¿æ¥ä¸¤ä¸ªç‹¬ç«‹ç»§æ‰¿ç»“æ„çš„æ•²ï¼Œæ•…åæ¡¥æ¥æ¨¡å¼  

?> æ¡¥æ¥æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼Œåˆè¢«ç§°ä¸ºæŸ„ä½“æ¨¡å¼æˆ–æ¥å£æ¨¡å¼   
æ¡¥æ¥æ¨¡å¼ç”¨æ¥å¤„ç†å¤šç»§æ‰¿é—®é¢˜ï¼Œç”¨æŠ½è±¡å…³ç³»å–ä»£äº†ä¼ ç»Ÿçš„å¤šå±‚ç»§æ‰¿ï¼Œå¹¶**å°†ç±»ä¹‹é—´çš„é™æ€ç»§æ‰¿å…³ç³»è½¬æ¢ä¸ºåŠ¨æ€çš„å¯¹è±¡ç»„åˆå…³ç³»**ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»å¹¶æ˜“äºæ‰©å±•ï¼Œæœ‰æ•ˆæ§åˆ¶äº†ç³»ç»Ÿä¸­**ç±»çš„ä¸ªæ•°**

> ç®€å•ç±»æ¯”ï¼šéœ€è¦ç”¨ç¬”ç”»å‡ºå½©è‰²ï¼ŒåŸæ¥ç”¨èœ¡ç¬”ç”»å‡ºå½©è‰²ï¼Œéœ€è¦ä¸åŒé¢œè‰²çš„èœ¡ç¬”(é¢œè‰²å’Œç¬”è€¦åˆ),æ”¹ç”¨æ¯›ç¬”+å½©è‰²å¢¨æ°´(è§£è€¦)åŒæ ·ä¹Ÿèƒ½ç”»å‡ºå½©è‰²

## ç±»æ¯”
å¯¹ä¸åŒé€ å‹ã€ä¸åŒå“ç‰Œçš„æ‰‹æœºè¿›è¡Œæ‰“ç”µè¯æ“ä½œï¼Œä¼ ç»Ÿæ€è·¯å¦‚ä¸‹

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ¡¥æ¥æ¨¡å¼æ‰‹æœºæ¡ˆä¾‹1.png)

å¯ä»¥çœ‹åˆ°ç±»å¾ˆå¤šï¼Œå¤šé‡ç»§æ‰¿å…³ç³»ï¼Œå¦‚æœæ–°å¢ä¸€ä¸ªå“ç‰Œæˆ–è€…é€ å‹çš„æ‰‹æœºï¼Œéœ€è¦æ–°å¢å¤šä¸ªç±»    
ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ä¼˜åŒ–åå¾—åˆ°    

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ¡¥æ¥æ¨¡å¼æ‰‹æœºæ¡ˆä¾‹2.png)

```java
public interface Brand {
    void open();
    void call();
    void close();
}
public class Huawei implements Brand {

    @Override
    public void open() {
        System.out.println("åä¸ºå¼€");
    }

    @Override
    public void call() {
        System.out.println("åä¸ºæ‰“");
    }

    @Override
    public void close() {
        System.out.println("åä¸ºå…³");
    }
}
public class XiaoMi implements Brand {

    @Override
    public void open() {
        System.out.println("å°ç±³å¼€");
    }

    @Override
    public void call() {
        System.out.println("å°ç±³æ‰“");
    }

    @Override
    public void close() {
        System.out.println("å°ç±³å…³");
    }
}
//æ¡¥
public abstract class Phone {
    private Brand brand;

    public Phone(Brand brand) {
        this.brand = brand;
    }
    void open(){
        this.brand.open();
    }
    void call(){
        this.brand.call();
    }
    void close(){
        this.brand.close();
    }
}

public class FoldedPhone extends Phone {
    public FoldedPhone(Brand brand) {
        super(brand);
    }

    public void open() {
        super.open();
        System.out.println("folded open");
    }

    public void call() {
        super.call();
        System.out.println("folded call");
    }

    public void close() {
        super.close();
        System.out.println("folded close");
    }
}

//è°ƒç”¨
public class Client {
    public static void main(String[] args) {
        Phone phone = new FoldedPhone(new Huawei());
        phone.open();
        phone.call();

    }
}
```

## å®é™…åº”ç”¨

### JDBCä¸­çš„æ¡¥æ¥æ¨¡å¼
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/jdbcçš„æ¡¥æ¥æ¨¡å¼.png)


## ä¼˜ç‚¹ç¼ºç‚¹
ä¼˜ç‚¹ï¼š  
- åˆ†ç¦»æŠ½è±¡æ¥å£å’Œå…¶å®ç°éƒ¨åˆ†
- æ¡¥æ¥æ¨¡å¼å¯ä»¥å–ä»£å¤šå±‚ç»§æ‰¿æ–¹å¼
- æé«˜äº†ç³»ç»Ÿæ‰©å±•æ€§ 

ç¼ºç‚¹ï¼š  
- å¢åŠ äº†ç³»ç»Ÿè®¾è®¡å’Œç†è§£éš¾åº¦


# è£…é¥°æ¨¡å¼ğŸ”´
è£…é¥°æ¨¡å¼ï¼š åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ ä¸€äº›é¢å¤–çš„èŒè´£(åŠŸèƒ½)ï¼Œå°±æ‰©å±•åŠŸèƒ½è€Œè¨€ï¼Œè£…é¥°æ¨¡å¼æä¾›äº†ä¸€ç§æ¯”**ä½¿ç”¨å­ç±»**æ›´åŠ çµæ´»çš„æ›¿ä»£æ–¹æ¡ˆ    

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è£…é¥°ç€æ¨¡å¼ç¤ºæ„å›¾.png)

- `Component`**æŠ½è±¡æ„ä»¶ç±»** å®ƒæ˜¯å…·ä½“æ„å»ºå’ŒæŠ½è±¡è£…é¥°ç±»çš„**å…±åŒçˆ¶ç±»**  
- `ConcreateComponent`**å…·ä½“æ„ä»¶**ï¼Œå®ƒæ˜¯æŠ½è±¡æ„ä»¶ç±»çš„å­ç±»ï¼Œç”¨äºå®šä¹‰å…·ä½“çš„æ„ä»¶å¯¹è±¡ï¼Œå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­çš„å£°æ˜æ”¾å‘ï¼Œè£…é¥°ç±»å¯ä»¥ç»™ä»–å¢åŠ é¢å¤–çš„æ–¹æ³•   
- `Decorator`**æŠ½è±¡è£…é¥°ç±»**ï¼Œä»–ä¹Ÿæ˜¯`æŠ½è±¡æ„å»ºç±»`çš„å­ç±»ï¼Œç”¨äºç»™å…·ä½“æ„å»ºå¢åŠ èŒè´£(æ–¹æ³•)ï¼Œä½†æ˜¯å…·ä½“æ–¹æ³•åœ¨å…¶å­ç±»ä¸­å®ç°;åŒæ—¶ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘`æŠ½è±¡æ„ä»¶`å¯¹è±¡çš„å¼•ç”¨  
- `ConcreteDecorator`**å…·ä½“è£…é¥°ç±»**ï¼Œå®ƒæ˜¯æŠ½è±¡è£…é¥°ç±»çš„å­ç±»ï¼Œè´Ÿè´£å‘æ„ä»¶æ·»åŠ æ–°çš„èŒè´£

## ç¤ºä¾‹  
ä»¥å’–å•¡ä¸¾ä¾‹ï¼Œå’–å•¡åˆ†æ„å¼æµ“ç¼©ã€ç¾å¼ ï¼Œå¯ä»¥åŠ é…æ–™ç‰›å¥¶ï¼Œå·§å…‹åŠ›ï¼Œç³–... 
æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå’–å•¡å®šä¹‰ä¸º`æŠ½è±¡æ„å»ºç±»`ï¼ŒæŸç§å’–å•¡å®šä¹‰ä¸º`å…·ä½“æ„ä»¶` ï¼Œé…æ–™å®šä¹‰ä¸º`æŠ½è±¡è£…é¥°ç±»`ï¼ŒæŸç§é…æ–™å®šä¹‰ä¸º`å…·ä½“æŠ½è±¡ç±»`ï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£æˆ‘ä»¬å°†å’–å•¡å’Œé…æ–™ç»„åˆç†è§£ä¸º`é¥®å“`

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è£…é¥°ç€æ¨¡å¼å®ä¾‹.png)

```java
//è°ƒç”¨å®ä¾‹
public class CoffeeBar {
    public static void main(String[] args) {
        //2ä»½ç³– +ç‰›å¥¶+longblack
        Drink order = new LongBlack();
        order = new Milk(order);
        order = new Sugar(order);
        order = new Sugar(order);
        System.out.println(order.cost());
        System.out.println(order.getDes());
    }
}
```

MilkåŒ…å«äº†LongBlack   
ä¸€ä»½sugaråŒ…å«äº†(Milk+LongBlack)  
ä¸€ä»½sugaråŒ…å«äº†(Chocolate+Milk+LongBlack)   
è¿™æ ·ä¸ç®¡æ˜¯ä»€ä¹ˆå½¢å¼çš„å•å“å’–å•¡+è°ƒæ–™ç»„åˆï¼Œé€šè¿‡é€’å½’æ–¹å¼å¯ä»¥æ–¹ä¾¿çš„ç»„åˆå’Œç»´æŠ¤    

**æœ€ç»ˆå…³ç³»å¦‚ä¸‹å›¾**    

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è£…é¥°ç€æ¨¡å¼å®ä¾‹å…³ç³».png)   

å³ä½¿æˆ‘ä»¬æ–°å¢é…æ–™`Sor`å’Œå’–å•¡`ShortBlack`ä¹Ÿå¾ˆå®¹æ˜“  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è£…é¥°ç€æ¨¡å¼å®ä¾‹ç±»å›¾.png)  


## ä¼˜ç¼ºç‚¹  

### ä¼˜ç‚¹ 
- è£…é¥°æ¨¡å¼æ¯”ç»§æ‰¿æ›´åŠ çµæ´»ï¼Œä¸ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ 
- é€šè¿‡åŠ¨æ€æ‰©å±•å¯¹è±¡åŠŸèƒ½ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å¯ä»¥åœ¨è¿è¡Œæ—¶é€‰æ‹©ä¸åŒçš„å…·ä½“è£…é¥°ç±»ï¼Œå®ç°ä¸åŒè¡Œä¸º
- å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡è£…é¥°ï¼Œé€šè¿‡ä¸åŒè£…é¥°çš„æ’åˆ—ç»„åˆå¾—åˆ°ä¸åŒçš„çš„å¯¹è±¡ç»„åˆ
- å¯ä»¥æ ¹æ®éœ€æ±‚å¢åŠ å…·ä½“æ„å»ºç±» å’Œå…·ä½“è£…é¥°ç±»ï¼ŒåŸæœ‰ä»£ç æ— éœ€æ”¹å˜

### ç¼ºç‚¹ 
- ä½¿ç”¨è£…é¥°æ¨¡å¼è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå¾ˆå¤šå°å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å†…éƒ¨çš„å…·ä½“è£…é¥°ç±»å¥—æ¥æ–¹å¼ä¸åŒ
- æ¯”ç»§æ‰¿çµæ´»æœºåŠ¨ï¼Œä½†æ˜¯å¯¹äºå¤šæ¬¡è£…é¥°çš„å¯¹è±¡æ’æŸ¥é—®é¢˜æ¯”è¾ƒå›°éš¾   


# ç»„åˆæ¨¡å¼ğŸ”´
**ç»„åˆæ¨¡å¼** `Composite Pattern` :ç»„åˆå¤šä¸ªå¯¹è±¡å½¢æˆæ ‘ç»“æ„ä»¥è¡¨ç¤ºå…·æœ‰éƒ¨åˆ†-æ•´ä½“å…³ç³»çš„å±‚æ¬¡æ¥å“¦å¤ï¼Œç»„åˆæ¨¡å¼è®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å¯¹å¾…å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡    

> ç»„åˆæ¨¡å¼åˆç§° éƒ¨åˆ†-æ•´ä½“ æ¨¡å¼ï¼Œå±äºå¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼Œä»–å°†å¯¹è±¡ç»„ç»‡åˆ°æ ‘ç»“æ„ä¸­ï¼Œå¯ä»¥ç”¨æ¥æè¿°æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»   

ç±»æ¯”Windowsç³»ç»Ÿä¸­çš„æ–‡ä»¶å¤¹å°±æ˜¯ä¸€ç§ç»„åˆæ¨¡å¼    
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç»„åˆæ¨¡å¼Windowsç¤ºä¾‹.png ':size=70%')

## ç»“æ„  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç»„åˆæ¨¡å¼ç»“æ„å›¾.png)

- `Component`æŠ½è±¡æ„ä»¶:å¯ä»¥æ˜¯æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œä¸ºå¶å­ç»“æ„å’Œå®¹å™¨æ„ä»¶å¯¹è±¡å£°æ˜æ¥å£ï¼Œåœ¨è¯¥è§’è‰²ä¸­å¯ä»¥åŒ…å«æ‰€æœ‰**å­ç±»å…±æœ‰è¡Œä¸ºçš„å£°æ˜å’Œå®ç°**ã€‚
  - åœ¨å…¶ä¸­å®šä¹‰äº†è®¿é—®åŠç®¡ç†å®ƒçš„å­æ„ä»¶çš„æ–¹æ³•ï¼Œå¦‚å¢åŠ ã€åˆ é™¤ã€è·å–å­æ„ä»¶ç­‰
- `Leaf`å¶å­æ„ä»¶ï¼šåœ¨ç»„åˆç»“æ„ä¸­ç™½å“¦æ˜¯å¶å­èŠ‚ç‚¹å¯¹è±¡ï¼Œå¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰çš„è¡Œä¸º  
- `Composite`å®¹å™¨æ„ä»¶(éå¶å­èŠ‚ç‚¹) å®¹å™¨èŠ‚ç‚¹å¯¹è±¡ï¼ŒåŒ…å«å­èŠ‚ç‚¹(å¶å­èŠ‚ç‚¹æˆ–å®¹å™¨èŠ‚ç‚¹)

> ç»„åˆæ¨¡å¼é€‚ç”¨ï¼š è¦å¤„ç†çš„å¯¹è±¡å¯ä»¥ç”Ÿæˆä¸€é¢—æ ‘ç»“æ„ï¼Œè€Œæˆ‘ä»¬åœ¨å¯¹æ ‘ä¸Šçš„èŠ‚ç‚¹å’Œå¶å­è¿›è¡Œæ“ä½œæ—¶ï¼Œå®ƒèƒ½å¤Ÿæä¾›ä¸€è‡´çš„æ–¹å¼ï¼Œè€Œä¸ç”¨è€ƒè™‘æ˜¯èŠ‚ç‚¹è¿˜æ˜¯å¶å­   

## å®ä¾‹  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç»„åˆæ¨¡å¼å­¦æ ¡æ¡ˆä¾‹.png)  


```java
//æŠ½è±¡ç±» æŠ½è±¡æ„ä»¶
public abstract class OrganizationComponent {
    private String name;
    private String des;

    protected void add(OrganizationComponent component){
        throw new UnsupportedOperationException();
    }
    protected void remove(OrganizationComponent component){
        throw new UnsupportedOperationException();
    }
    protected abstract void print();

    public OrganizationComponent(String name, String des) {
        this.name = name;
        this.des = des;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDes() {
        return des;
    }

    public void setDes(String des) {
        this.des = des;
    }
}
//å¤§å­¦ å®¹å™¨æ„ä»¶
public class University extends OrganizationComponent{

    List<OrganizationComponent> organizationComponents = new ArrayList<>();

    public University(String name, String des) {
        super(name, des);
    }

    @Override
    protected void add(OrganizationComponent component) {
        organizationComponents.add(component);
    }

    @Override
    protected void remove(OrganizationComponent component) {
        organizationComponents.remove(component);
    }

    @Override
    protected void print() {
        System.out.println("-----"+getName()+"-----");
        for (OrganizationComponent component : organizationComponents) {
            component.print();
        }
    }

    @Override
    public String getName() {
        return super.getName();
    }

    @Override
    public String getDes() {
        return super.getDes();
    }
}
//å­¦é™¢ å®¹å™¨æ„ä»¶
public class College extends OrganizationComponent{

    List<OrganizationComponent> organizationComponents = new ArrayList<>();

    public College(String name, String des) {
        super(name, des);
    }

    @Override
    protected void add(OrganizationComponent component) {
        organizationComponents.add(component);
    }

    @Override
    protected void remove(OrganizationComponent component) {
        organizationComponents.remove(component);
    }

    @Override
    protected void print() {
        System.out.println("-----"+getName()+"-----");
        for (OrganizationComponent component : organizationComponents) {
            component.print();
        }
    }

    @Override
    public String getName() {
        return super.getName();
    }

    @Override
    public String getDes() {
        return super.getDes();
    }
}
//ä¸“ä¸š å¶å­æ„ä»¶
public class Department extends OrganizationComponent{
    public Department(String name, String des) {
        super(name, des);
    }

    @Override
    protected void print() {
        System.out.println(getName());
    }

    @Override
    public String getName() {
        return super.getName();
    }

    @Override
    public String getDes() {
        return super.getDes();
    }
}

//è°ƒç”¨
public class Client {
    public static void main(String[] args) {
        OrganizationComponent university = new University("æ¸…å", "é¡¶çº§å¤§å­¦");

        OrganizationComponent college1 = new College("è®¡ç®—æœºå­¦é™¢", "æè¿°1");
        OrganizationComponent college2 = new College("å»ºç­‘å­¦é™¢", "æè¿°2");

        college1.add(new Department("è½¯ä»¶å·¥ç¨‹","miao1"));
        college1.add(new Department("ç½‘ç»œå·¥ç¨‹","miao2"));
        college1.add(new Department("è®¡ç®—æœºç§‘å­¦","miao3"));

        college2.add(new Department("åœŸæœ¨ç§‘å­¦","miao1"));
        college2.add(new Department("åœ°è´¨æ„é€ ","miao2"));

        university.add(college1);
        university.add(college2);

        university.print();

    }
}
-----æ¸…å-----
-----è®¡ç®—æœºå­¦é™¢-----
è½¯ä»¶å·¥ç¨‹
ç½‘ç»œå·¥ç¨‹
è®¡ç®—æœºç§‘å­¦
-----å»ºç­‘å­¦é™¢-----
åœŸæœ¨ç§‘å­¦
åœ°è´¨æ„é€ 
```

## æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚ 
### ä¼˜ç‚¹
- å¯ä»¥æ¸…æ¥šçš„å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œå¿½ç•¥å±‚æ¬¡å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡ç»“æ„è¿›è¡Œæ§åˆ¶
- å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ä¸€ä¸ªç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡
- æ–°å¢å®¹å™¨æ„å»ºæˆ–å¶å­æ„ä»¶éƒ½å¾ˆå®¹æ˜“ï¼Œæ— éœ€å¯¹ç°æœ‰ç±»åº“è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œç¬¦åˆå¼€é—­åŸåˆ™

### é€‚ç”¨ç¯å¢ƒ 
- åœ¨å…·æœ‰æ•´ä½“å’Œéƒ¨åˆ†å±‚æ¬¡ç»“æ„ä¸­ï¼Œå¸Œæœ›é€šè¿‡ä¸€ç§æ–¹å¼å¿½ç•¥æ•´ä½“ä¸éƒ¨åˆ†çš„å·®å¼‚ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„å¯¹å¾…ä»–ä»¬
- åœ¨ä¸€ä¸ªä½¿ç”¨é¢å‘å¯¹è±¡è¯­è¨€çš„ç³»ç»Ÿä¸­éœ€è¦å¤„ç†ä¸€ä¸ª**æ ‘å½¢ç»“æ„**
- åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­èƒ½åˆ†ç¦»å‡ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡ï¼Œè€Œä¸”ä»–ä»¬çš„ç±»å‹ä¸å›ºå®šï¼Œéœ€è¦å¢åŠ ä¸€äº›æ–°ç±»å‹  


# å¤–è§‚æ¨¡å¼ğŸ”´  
å¤–è§‚æ¨¡å¼`Facade Pattern` ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ï¼Œå¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨   

> åœ¨å¤–è§‚æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå­ç³»ç»Ÿçš„å¤–éƒ¨ä¸å…¶å†…éƒ¨çš„é€šä¿¡é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¤–è§‚ç±»è¿›è¡Œï¼Œå¼¯ç®¡ç±»å°†å®¢æˆ·ç±»ä¸å­ç³»ç»Ÿçš„å†…éƒ¨å¤æ‚æ€§åˆ†éš”å¼€ï¼Œä½¿å¾—å®¢æˆ·ç±»åªéœ€è¦ä¸å¤–è§‚è§’è‰²æ‰“äº¤é“ï¼Œè€Œä¸éœ€è¦ä¸å­ç³»ç»Ÿå†…éƒ¨çš„å¾ˆå¤šå¯¹è±¡æ‰“äº¤é“   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¤–è§‚æ¨¡å¼ç¤ºæ„å›¾.png)

## ç»“æ„
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¤–è§‚æ¨¡å¼ç»“æ„å›¾.png)

- `Client`å®¢æˆ·ç«¯  
- `Facade`å¤–è§‚è§’è‰²ï¼šåœ¨å®¢æˆ·ç«¯è°ƒç”¨å®ƒçš„æ–¹æ³•ï¼Œå®ƒå°†æ‰€æœ‰ä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚å§”æ´¾åˆ°å“åº”çš„å­ç³»ç»Ÿï¼Œä¼ é€’ç»™ç›¸åº”çš„å­ç³»ç»Ÿå¯¹è±¡å¤„ç†   
- `SubSystem`å­ç³»ç»Ÿè§’è‰²ï¼Œåœ¨è½¯ä»¶ç³»ç»Ÿä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œå¤„ç†å¤–è§‚è§’è‰²çš„è¯·æ±‚ï¼Œå¤–è§‚è§’è‰²å¯¹å­ç³»ç»Ÿè€Œè¨€åªæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯   

## å®ç° 

```java
public class SubSystemA{
    public void methodA(){
        //ä¸šåŠ¡
    }
}
public class SubSystemB{
    public void methodB(){
        //ä¸šåŠ¡
    }
}
public class SubSystemC{
    public void methodC(){
        //ä¸šåŠ¡
    }
}
//å¤–è§‚ç±»
public class Facade{
    private SubSystemA obj1 = new SubSystemA();
    private SubSystemB obj2 = new SubSystemB();
    private SubSystemC obj3 = new SubSystemC();

    public void method(){
        obj1.methodA();
        obj1.methodB();
        obj1.methodC();
    }

}

//å®é™…è°ƒç”¨
public class Test{
    public static void main(String args[]){
        Facade facade = new Facade();
        facade.method();
    }
}
```

## é€‚ç”¨ç¯å¢ƒå’Œä¼˜ç¼ºç‚¹
### é€‚ç”¨ç¯å¢ƒ
BSç³»ç»Ÿä¸­çš„å¯¼èˆªé¡µé¢å°±å¯ä»¥çœ‹åšä¸€ä¸ªå¤–è§‚è§’è‰²ï¼ŒCSç³»ç»Ÿçš„èœå•æˆ–è€…å·¥å…·æ ä¹Ÿå¯ä»¥çœ‹ä½œå¤–è§‚è§’è‰²    
- ä¸ºä¸€ç³»åˆ—å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•å…¥å£
- å®¢æˆ·ç«¯ç¨‹åºä¸å¤šä¸ªå­ç³»ç»Ÿä¹‹é—´å­˜åœ¨å¾ˆå¤§ä¾èµ–ï¼Œå¼•å…¥å¤–è§‚ç±»é™ä½å­ç³»ç»Ÿå’Œå®¢æˆ·ç«¯çš„è€¦åˆ
- å±‚æ¬¡åŒ–ç»“æ„ä¸­å¯ä»¥ä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰ç³»ç»Ÿä¸­æ¯ä¸€å±‚çš„å…¥å£ï¼Œå±‚ä¸å±‚ä¹‹é—´ä¸ç›´æ¥äº§ç”Ÿè”ç³»ï¼Œè€Œé€šè¿‡å¤–è§‚ç±»å»ºç«‹è”ç³»ï¼Œé™ä½è€¦åˆ

### ä¼˜ç‚¹ 
- å¯¹å®¢æˆ·ç«¯å±è”½äº†å­ç³»ç»Ÿç»„ä»¶ï¼Œå‡å°‘äº†å®¢æˆ·ç«¯æ‰€å¤„ç†çš„å¯¹è±¡æ•°ç›®
- å®ç°äº†å­ç³»ç»Ÿå’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æ¾è€¦åˆå…³ç³»ï¼Œå­ç³»ç»Ÿçš„å˜åŒ–ä¸ä¼šå½±å“åˆ°å®¢æˆ·ç«¯ï¼Œåªéœ€è°ƒæ•´å¤–è§‚ç±»

### ç¼ºç‚¹
- ä¸èƒ½å¾ˆå¥½çš„é™åˆ¶å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨å­ç³»ç»Ÿç±»
- è‹¥è®¾è®¡ä¸å½“ï¼Œå¢åŠ æ–°çš„å­ç³»ç»Ÿå¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»çš„æºç ï¼Œè¿èƒŒå¼€é—­åŸåˆ™

# äº«å…ƒæ¨¡å¼ğŸ”´  
è‹¥ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿæ­£åœ¨è¿è¡Œæ—¶æ‰€åˆ›å»ºçš„**ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„å¯¹è±¡æ•°é‡å¤ªå¤š**ï¼Œå¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜ï¼Œå¸¦æ¥ç³»ç»Ÿèµ„æºçš„æµªè´¹ã€æ€§èƒ½ä¸‹é™ç­‰é—®é¢˜ã€‚ä¸ºäº†é¿å…ç³»ç»Ÿä¸­å‡ºç°å¤§é‡é‡å¤å¯¹è±¡ï¼Œå°±éœ€è¦ä½¿ç”¨**äº«å…ƒæ¨¡å¼**é€šè¿‡å…±äº«æŠ€æœ¯å®ç°ç›¸åŒæˆ–ç›¸ä¼¼å¯¹è±¡çš„å¤ç”¨ã€‚    
åœ¨äº«å…ƒæ¨¡å¼ä¸­å­˜å‚¨è¿™äº›å…±äº«å®ä¾‹å¯¹è±¡çš„åœ°æ–¹ç§°ä¸º`äº«å…ƒæ± `ï¼Œjavaä¸­çš„`Stringå¸¸é‡æ± `ã€`æ•°æ®åº“è¿æ¥æ± `ç­‰éƒ½æ˜¯äº«å…ƒæ¨¡å¼çš„å®ç°æ–¹å¼      

## å®šä¹‰  
äº«å…ƒæ¨¡å¼(Flyweight Patern)ï¼šè¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆçš„æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨  

> äº«å…ƒæ¨¡å¼è¦æ±‚èƒ½å¤Ÿè¢«å…±äº«çš„å¯¹è±¡å¿…é¡»æ˜¯ç»†ç²’åº¦å¯¹è±¡ï¼Œåˆç§°ä¸ºè½»é‡æ¨¡å¼æˆ–è‡é‡æ¨¡å¼ï¼Œäº«å…ƒæ¨¡å¼èƒ½åšåˆ°å…±äº«çš„å…³é”®æ˜¯åŒºåˆ†äº†å†…éƒ¨çŠ¶æ€`Intrinsic State`å’Œå¤–éƒ¨çŠ¶æ€`Extrinsic State`   
> **å†…éƒ¨çŠ¶æ€**æ˜¯å­˜å‚¨åœ¨äº«å…ƒå¯¹è±¡å†…éƒ¨å¹¶ä¸”ä¸ä¼šéšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çŠ¶æ€ï¼Œå†…éƒ¨çŠ¶æ€å¯ä»¥å…±äº«ã€‚ä¾‹å¦‚ï¼šå­—ç¬¦å†…å®¹ä¸ä¼šéšå¤–éƒ¨ç¯å¢ƒçš„å˜åŒ–è€Œå˜åŒ–ï¼Œæ— è®ºä»»ä½•ç¯å¢ƒä¸‹å­—ç¬¦`a`å§‹ç»ˆæ˜¯`a`ï¼Œä¸ä¼šå˜æˆ`b`     
> **å¤–éƒ¨çŠ¶æ€**æ˜¯éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ï¼Œä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ã€‚äº«å…ƒå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€é€šå¸¸ç”±å®¢æˆ·ç«¯ä¿å­˜ï¼Œå¹¶åœ¨äº«å…ƒå¯¹è±¡è¢«åˆ›å»ºä¹‹åéœ€è¦ä½¿ç”¨çš„æ—¶å€™å†ä¼ å…¥åˆ°äº«å…ƒå¯¹è±¡å†…éƒ¨ã€‚ä¸€ä¸ªå¤–éƒ¨çŠ¶æ€ä¸å¦ä¸€ä¸ªå¤–éƒ¨çŠ¶æ€ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚    


## ç»“æ„

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/äº«å…ƒæ¨¡å¼åŸç†å›¾.png)

- `Flyweight`æŠ½è±¡äº«å…ƒç±»ï¼ŒæŠ½è±¡äº«å…ƒç±»é€šå¸¸æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼ŒåŒæ—¶å®šä¹‰å‡ºå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€
- `ConcreteFlyweight`å…·ä½“äº«å…ƒç±»,å®ç°äº†æŠ½è±¡äº«å…ƒç±»ï¼Œä¸ºå†…éƒ¨çŠ¶æ€æä¾›å­˜å‚¨ç©ºé—´ï¼Œé€šå¸¸ç»“åˆå•ä¾‹æ¨¡å¼æ¥è®¾è®¡å…·ä½“äº«å…ƒç±»
- `UnsharedConcreteFlyweight`éå…±äº«å…·ä½“äº«å…ƒç±»ï¼Œä¸èƒ½å…±äº«çš„äº«å…ƒç±»ï¼Œå¯ä»¥é€šè¿‡æ­¤ç±»åˆ›å»ºä¸å¯å…±äº«çš„å…·ä½“äº«å…ƒç±»
- `FlyweightFactory`äº«å…ƒå·¥å‚ç±»ï¼Œç”¨äºåˆ›å»ºå¹¶ç®¡ç†äº«å…ƒå¯¹è±¡ï¼Œé’ˆå¯¹æŠ½è±¡äº«å…ƒç±»ç¼–ç¨‹ï¼Œå°†å„ç±»å‹çš„å…·ä½“äº«å…ƒå¯¹è±¡å­˜å‚¨åœ¨ä¸€ä¸ªäº«å…ƒæ± ä¸­ï¼ŒåŒæ—¶æä¾›ä»æ± ä¸­è·å–å¯¹è±¡çš„æ–¹æ³•  


## å®ç°  

```java
//æŠ½è±¡äº«å…ƒç±»
public abstract class Flyweight{
    public abstract void operation(String extrinsicState);
}

//å…·ä½“äº«å…ƒç±»
public class ConcreteFlyweight extends Flyweight{
    //å†…éƒ¨çŠ¶æ€intrinsicState ä½œä¸ºæˆå‘˜å˜é‡ï¼ŒåŒä¸€ä¸ªäº«å…ƒå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€æ˜¯ä¸€è‡´çš„
    private String intrinsicState;


    public ConcreteFlyweight(String intrinsicState){
        this.intrinsicState = intrinsicState;
    }

    //å¤–éƒ¨çŠ¶æ€ extrinsicState åœ¨ä½¿ç”¨æ—¶ç”±å¤–éƒ¨è®¾ç½®ï¼Œä¸ä¿å­˜åœ¨äº«å…ƒå¯¹è±¡ä¸­ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªå¯¹è±¡

    public void operation(String extrinsicState){

    }
}

// éå…±äº«å…·ä½“äº«å…ƒç±»
public class UnsharedConcreteFlyweight extends Flyweight{
    public void operation(String extrinsicState){

    }
}

//äº«å…ƒå·¥å‚ç±»
public class FlyweightFactory{
    //å…±äº«äº«å…ƒæ± 
    private HashMap flyweights = new HashMap();

    public Flyweight getFlyweight(String key){
        if(flyweight.containsKey(key)){
            return (Flyweight)flyweight.get(key);
        }else{
            //è‹¥å¯¹è±¡ä¸å­˜åœ¨ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ·»åŠ åˆ°äº«å…ƒæ± ä¸­
            Flyweight fw = new ConcreteFlyweight();
            flyweight.put(key,fw);
            return fw;
        }
    }

}

```

## å®é™…åº”ç”¨
javaä¸­çš„Stringå¸¸é‡æ± å’ŒIntegerå¸¸é‡æ±   

## é€‚ç”¨ç¯å¢ƒå’Œä¼˜ç¼ºç‚¹

### ä¼˜ç‚¹ 
- å¯ä»¥å‡å°‘ç³»ç»Ÿä¸­é‡å¤å¯¹è±¡çš„æ•°é‡ï¼Œæé«˜æ€§èƒ½
- å¤–éƒ¨çŠ¶æ€çš„ç‹¬ç«‹ï¼Œä¿è¯äº†äº«å…ƒå¯¹è±¡å¯ä»¥åœ¨ä¸åŒç¯å¢ƒä¸­è¢«å…±äº«

### ç¼ºç‚¹
- ä½¿å¾—ç¨‹åºè´Ÿè½½è¯ï¼Œéœ€è¦åˆ†ç¦»äº«å…ƒå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ 


### é€‚ç”¨ç¯å¢ƒ
- ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡ç›¸åŒæˆ–ç›¸ä¼¼çš„å¯¹è±¡ï¼Œé€ æˆå†…å­˜æµªè´¹
- å¯¹è±¡å¤§éƒ¨åˆ†çŠ¶æ€éƒ½å¯ä»¥å¤–éƒ¨åŒ–ï¼Œå¯ä»¥å°†è¿™äº›å¤–éƒ¨çŠ¶æ€ä¼ å…¥å¯¹è±¡ä¸­
- ç»´æŠ¤äº«å…ƒæ± ä¹Ÿéœ€è¦èµ„æºï¼Œæ‰€ä»¥è¦åœ¨å¤šæ¬¡é‡å¤ä½¿ç”¨å¯¹è±¡æ—¶å†ä½¿ç”¨äº«å…ƒæ¨¡å¼  


# ä»£ç†æ¨¡å¼ğŸ”´
ä»£ç†æ¨¡å¼`Proxy Pattern`ï¼šç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ï¼›é€šè¿‡ä»£ç†å¯¹è±¡è®¿é—®ç›®æ ‡å¯¹è±¡ã€‚  

> ä»£ç†æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼Œä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œå¯ä»¥å»æ‰å®¢æˆ·ä¸èƒ½è®¿é—®çš„å†…å®¹æˆ–è€…å¢åŠ é¢å¤–çš„å†…å®¹ï¼ˆå¯¹åŸæœ‰å¯¹è±¡åŠŸèƒ½è¿›è¡Œæ‰©å±•ï¼‰   

ä»£ç†æ¨¡å¼ä¸»è¦åˆ†ä¸‰ç§å½¢å¼ï¼Œé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†(JDKä»£ç†ï¼Œæ¥å£ä»£ç†)ï¼ŒCglibä»£ç†

## é™æ€ä»£ç†
é™æ€ä»£ç†åœ¨ä½¿ç”¨æ—¶ï¼Œéœ€è¦å®šä¹‰æ¥å£æˆ–çˆ¶ç±»ï¼Œè¢«ä»£ç†å¯¹è±¡(å³ç›®æ ‡å¯¹è±¡)ä¸ä»£ç†å¯¹è±¡ä¸€èµ·å®ç°ç›¸åŒçš„æ¥å£æˆ–è€…ç»§æ‰¿ç›¸åŒçš„çˆ¶ç±»  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/é™æ€ä»£ç†æ¨¡å¼ç»“æ„å›¾.png)


```java
//æŠ½è±¡çˆ¶ç±»æˆ–æ¥å£
public abstract class Subject{
    public abstract void request();
} 


//çœŸå®å¯¹è±¡
public class RealSubject extends Subject{
    public void request(){
        //ä¸šåŠ¡é€»è¾‘
        System.out.println("çœŸå®æ–¹æ³•è°ƒç”¨");
    }
}

//ä»£ç†å¯¹è±¡ç±»
public Proxy extends Subject{
    //çœŸå®å¯¹è±¡çš„å¼•ç”¨
    //ä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å™¨ä¼ å…¥è¿›è¡Œæ„é€ 
    private RealSubject realSubject = new RealSubject();

    public void preRequest(){
        //å‰ç½®æ–¹æ³•
    }

    public void request(){
        preRequest();
        //è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•
        realSubject.request();
        postRequest();
    }

     public void postRequest(){
        //åç½®æ–¹æ³•
    }

}

//æµ‹è¯•
public class Client{
    public static void main(String[] args){
        Proxy pr = new Proxy();
        pr.request();

    }
}

```

> **ä¼˜ç‚¹ï¼š** åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½å‰æä¸‹ï¼Œèƒ½é€šè¿‡ä»£ç†å¯¹è±¡å¯¹ç›®æ ‡åŠŸèƒ½è¿›è¡Œæ‰©å±•å’Œé™åˆ¶    
> **ç¼ºç‚¹ï¼š** å¯èƒ½ä¼šæœ‰å¤šä¸ªä»£ç†ç±»ï¼Œä¸€æ—¦æ¥å£æˆ–çˆ¶ç±»çš„æ–¹æ³•å¢åŠ ï¼Œæ‰€æœ‰çš„ç›®æ ‡ç±»å’Œä»£ç†ç±»éƒ½éœ€è¦æ”¹å˜   

## åŠ¨æ€ä»£ç†
ç”±äº**é™æ€ä»£ç†**ä¼šäº§ç”Ÿå¾ˆå¤šé™æ€ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠæ³•å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†ç±»å®Œæˆå…¨éƒ¨çš„ä»£ç†åŠŸèƒ½ï¼Œè¿™å°±æ˜¯åŠ¨æ€ä»£ç†   

- ä»£ç†å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œä½†æ˜¯ç›®æ ‡å¯¹è±¡è¦å®ç°æ¥å£ï¼Œå¦åˆ™ä¸èƒ½ç”¨åŠ¨æ€ä»£ç†
- ä»£ç†å¯¹è±¡çš„ç”Ÿæˆï¼Œæ˜¯åˆ©ç”¨JDKçš„API(åå°„)ï¼Œ**åŠ¨æ€çš„åœ¨å†…å­˜ä¸­æ„å»ºä»£ç†å¯¹è±¡**
- åŠ¨æ€ä»£ç†ä¹Ÿå«åšï¼›JDKä»£ç†ï¼Œæ¥å£ä»£ç†   

åœ¨Javaä¸­æƒ³è¦å®ç°åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œéœ€è¦`java.lang.reflect.InvocationHandler`æ¥å£å’Œ`java.lang.reflect.Proxy`ç±»çš„æ”¯æŒ

```java
// æ¥å£æˆ–æŠ½è±¡ç±»
public interface ITeacherDao {
    void teach();
}

//è¢«ä»£ç†å¯¹è±¡
public class TeacherDao implements ITeacherDao {
    @Override
    public void teach() {
        System.out.println("æ•™å­¦ä»»åŠ¡");
    }
}

//é€šè¿‡åå°„çš„åŠ¨æ€ä»£ç†å®ç°
public class ProxyFactory {
    private Object target;

    public ProxyFactory(Object target) {
        this.target = target;
    }
    // Proxy.newProxyInstance
    //  public static Object newProxyInstance(ClassLoader loader, ç›®æ ‡å¯¹è±¡ä½¿ç”¨çš„ç±»åŠ è½½å™¨
    //                                    Class<?>[] interfaces, ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ç±»å‹
    //                                      InvocationHandler h) äº‹ä»¶å¤„ç†æ–¹æ³•
    /**
        è¢«ä»£ç†å¯¹è±¡targeté€šè¿‡å‚æ•°ä¼ é€’è¿›æ¥ï¼Œ
        é€šè¿‡target.getClass().getClassLoader()è·å–ClassLoaderå¯¹è±¡ï¼Œ
        ç„¶åé€šè¿‡target.getClass().getInterfaces()è·å–å®ƒå®ç°çš„æ‰€æœ‰æ¥å£ï¼Œ
        å†å°†targetåŒ…è£…åˆ°å®ç°äº†InvocationHandleræ¥å£çš„å¯¹è±¡ä¸­ã€‚
        é€šè¿‡newProxyInstanceå‡½æ•°æˆ‘ä»¬å°±è·å¾—äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ã€‚
    
     */
    public Object getProxyInstance() {
        return Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), new InvocationHandler() {
            @Override
            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                Object invoke = method.invoke(target, args);

                return invoke;
            }
        });
    }
}
```

## Cglibä»£ç†  
é™æ€ä»£ç†å’ŒJDKä»£ç†æ¨¡å¼éƒ½è¦æ±‚`ç›®æ ‡å¯¹è±¡å®ç°ä¸€ä¸ªæ¥å£`ï¼Œä½†æ˜¯æœ‰æ—¶å€™ç›®æ ‡å¯¹è±¡åªæ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œå¹¶æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ç›®æ ‡å¯¹è±¡å­ç±»æ¥å®ç°ä»£ç†ï¼Œè¿™å°±æ˜¯**Cglibä»£ç†**   

Cglibä»£ç†ä¹Ÿå«åšå­ç±»ä»£ç†ï¼Œå®ƒæ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½æ‰©å±•ï¼›Cglibæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…ï¼Œå®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸé—´æ‰©å±•javaç±»ä¸å®ç°javaæ¥å£,åº•å±‚é€šè¿‡å­—èŠ‚ç å¤„ç†æ¡†æ¶`ASM`æ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»   

åœ¨AOPç¼–ç¨‹ä¸­è‹¥:  
- ç›®æ ‡å¯¹è±¡éœ€è¦å®ç°æ¥å£ï¼Œä½¿ç”¨`JDK`ä»£ç†
- ç›®æ ‡å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œä½¿ç”¨`Cglib`ä»£ç†  

### æ„å»ºCglib
- å¼•å…¥jaråŒ…æˆ–ä¾èµ–
- ä»£ç†çš„ç±»ä¸èƒ½ä¸ºfinalç±»ï¼Œå¦åˆ™ä¼šæŠ¥é”™
- ç›®æ ‡æ–¹æ³•ä¸èƒ½ä¸ºfinal æˆ–staticï¼Œå¦åˆ™æ— æ³•ç”Ÿæ•ˆï¼Œç±»åŠ è½½æœºåˆ¶

1. å¼•å…¥jaråŒ…æˆ–ä¾èµ–  

```xml
<dependency>
    <groupId>cglib</groupId>
    <artifactId>cglib</artifactId>
    <version>3.3.0</version>
</dependency>
```

2. ç›®æ ‡å¯¹è±¡ï¼Œæ— éœ€å®ç°æ¥å£æˆ–ç»§æ‰¿

```java
public class TeacherDao{
    public void teach(){
        System.out.println("è¿›å…¥æ•™å­¦");
    }
}
```

3. `MethodInterceptor`ç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„`InvocationHandler`ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰åè¿›è¡Œå¢å¼º  

```java
public class ProxyFactory implements MethodInterceptor {

    private Object target;

    public ProxyFactory(Object target){
        this.target = target;
    }

//é‡å†™ intercept æ–¹æ³•ï¼Œå®ç°å¯¹è¢«ä»£ç†å¯¹è±¡ï¼ˆç›®æ ‡å¯¹è±¡ï¼‰æ–¹æ³•è°ƒç”¨   
    @Override
    public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable {
        System.out.println("cglib ä»£ç†å¼€å§‹ï¼Œå¯ä»¥æ·»åŠ é€»è¾‘");
        Object obj = method.invoke(target,objects);
        System.out.println("cglib ä»£ç†ç»“æŸ");
        return obj;
    }

    //é€šè¿‡è¿™ä¸ªæ–¹æ³•ç»™ç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡
    public Object getProxyInstance(){
        //å·¥å…·ç±»ï¼Œç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„Proxyç±»
        Enhancer enhancer = new Enhancer();
        //è®¾ç½®çˆ¶ç±»
        enhancer.setSuperclass(target.getClass());
        //è®¾ç½®å›è°ƒå‡½æ•°
        enhancer.setCallback(this);
        //åˆ›å»ºå­ç±»å¯¹è±¡ï¼Œå³ä»£ç†å¯¹è±¡
        return enhancer.create();
    }
}
```

4. å®¢æˆ·ç«¯è°ƒç”¨

```java
public class Client {

    public static void main(String[] args) {

        //ç›®æ ‡å¯¹è±¡
        TeacherDao target = new TeacherDao();
        //è·å–ä»£ç†å¯¹è±¡,å¹¶ä¸”å°†ç›®æ ‡å¯¹è±¡ä¼ é€’ç»™ä»£ç†å¯¹è±¡
        TeacherDao teacher = (TeacherDao) new ProxyFactory(target).getProxyInstance();
        teacher.teach();
    }
}
```

## åº”ç”¨åœºæ™¯
- **å»¶è¿Ÿåˆå§‹åŒ–**ï¼Œå¯èƒ½ä¼šä½¿ç”¨çš„é‡é‡çº§æœåŠ¡å¯¹è±¡
- **è®¿é—®æ§åˆ¶**ï¼Œç‰¹å®šå®¢æˆ·ç«¯æ‰èƒ½è®¿é—®æœåŠ¡å¯¹è±¡
- **æœ¬åœ°æ‰§è¡Œè¿œç¨‹æœåŠ¡**ï¼Œæœ¬åœ°æ‰§è¡Œç½‘ç»œå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè´Ÿè´£å¤„ç†ç½‘ç»œç›¸å…³å¤æ‚ç»†èŠ‚
- **è®°å½•æ—¥å¿—**

# è¡Œä¸ºå‹æ¨¡å¼ğŸŸ©  
è¡Œä¸ºå‹æ¨¡å¼å…³æ³¨ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œç ”ç©¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å¯¹è±¡ä¹‹é—´çš„ç›¸äº’é€šä¿¡ä¸å†™ä½œï¼Œè¿›ä¸€æ­¥æ˜ç¡®å¯¹è±¡çš„èŒè´£ã€‚è¡Œä¸ºå‹æ¨¡å¼ä¸ä»…ä»…å…³æ³¨ç±»å’Œå¯¹è±¡æœ¬èº«ï¼Œè¿˜é‡ç‚¹å…³æ³¨ä»–ä»¬ä¹‹é—´çš„ç›¸äº’ä½œç”¨å’ŒèŒè´£åˆ’åˆ†ã€‚  

è¡Œä¸ºå‹æ¨¡å¼ç å²™åˆ†ä¸º`ç±»è¡Œä¸ºæ¨¡å¼`å’Œ`å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼`   
- **ç±»è¡Œä¸ºå‹æ¨¡å¼**ä½¿ç”¨ç»§æ‰¿å…³ç³»åœ¨å‡ ä¸ªç±»ä¸­åˆ†é…è¡Œä¸ºï¼Œé€šè¿‡å¤šæ€æ¥åˆ†é…çˆ¶ç±»å’Œå­ç±»çš„èŒè´£
- **å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼**ä½¿ç”¨å¯¹è±¡çš„å…³è”å…³ç³»æ¥åˆ†é…è¡Œä¸ºï¼Œé€šè¿‡å¯¹è±¡å…³è”åˆ†é…èŒè´£

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è¡Œä¸ºå‹æ¨¡å¼ä¸€è§ˆ1.png)   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è¡Œä¸ºå‹æ¨¡å¼ä¸€è§ˆ1.png)


# æ¨¡æ¿æ–¹æ³•æ¨¡å¼ğŸŸ©  
æ¨¡æ¿æ–¹æ³•`Template Method Pattern`ï¼šè¶…ç±»ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•æ¡†æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œæ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›æ­¥éª¤   

> æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ç§é˜¶æ®µé‚£çš„è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œåœ¨å…¶ç»“æ„ä¸­**åªå­˜åœ¨çˆ¶ç±»å’Œå­ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»**ã€‚åœ¨æŠ½è±¡çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªç§°ä¸ºæ¨¡æ¿æ–¹æ³•çš„æ–¹æ³•æ¥å®šä¹‰è¿™äº›åŸºæœ¬æ–¹æ³•çš„æ‰§è¡Œæ¬¡åºï¼Œè€Œé€šè¿‡å…¶å­ç±»æ¥è¦†ç›–æŸäº›æ­¥éª¤ï¼Œä»è€Œä½¿å¾—**ç›¸åŒçš„ç®—æ³•æ¡†æ¶å¯ä»¥æœ‰ä¸åŒçš„æ‰§è¡Œç»“æœ**ã€‚  

## ç»“æ„ 
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç»“æ„å›¾.png)

- `AbstractClass` æŠ½è±¡ç±»ï¼Œå®šä¹‰ä¸€ç³»åˆ—åŸºæœ¬æ“ä½œï¼Œå’Œä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ¥è§„å®šç®—æ³•éª¨æ¶(æ–¹æ³•è°ƒç”¨é¡ºåºç­‰)
- `ConcreteClass` å…·ä½“å­ç±»ï¼ŒæŠ½è±¡ç±»çš„å­ç±»ï¼Œå®ç°åœ¨çˆ¶ç±»ä¸­å£°æ˜çš„æŠ½è±¡æ–¹æ³•æ¥å®Œæˆç®—æ³•ä¸­å­ç±»çš„ç‰¹å®šæ“ä½œ  




## å®ç°  
ä½¿ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼Œå’–å•¡åˆ¶ä½œï¼Œå’–å•¡éƒ½æ˜¯ç”±`èƒå–æµ“ç¼©å’–å•¡->åŠ æ°´->åŠ é…æ–™->åŠ è¾…æ–™->å€’å…¥æ¯ä¸­`çš„æµç¨‹åˆ¶ä½œ,é…æ–™ä¸åŒçš„å’–å•¡æœ‰ä¸åŒåç§°ï¼ŒåŠ å¥¶å°±æ˜¯æ‹¿é“`Latte`ï¼ŒåŠ æ°´å°±æ˜¯ç¾å¼`LongBlack`ï¼ŒåŠ å¥¶æ³¡å°±æ˜¯å¡å¸ƒå¥‡è¯º`Cappuccino`,åŒæ—¶å¯ä»¥é€‰æ‹©æ·»åŠ è¾…æ–™ï¼šç³–ï¼Œå†°... ;é€šè¿‡å®šä¹‰æ¨¡æ¿æ–¹æ³•ä¸­çš„è°ƒç”¨é¡ºåºï¼Œæ¥å®ç°ç®—æ³•æµç¨‹ï¼Œ**æ¨¡æ¿æ–¹æ³•è¦ç”¨finalä¿®é¥°ï¼Œé˜²æ­¢å­ç±»é‡å†™**  

æŠŠæŠ½è±¡ç±»è§„å®šä¸ºå’–å•¡ï¼Œä¸‹å±å­ç±»ä¸ºæ‹¿é“ï¼Œç¾å¼...ç­‰ï¼Œåˆ¶ä½œä¸€æ¯å’–å•¡æœ‰å›ºå®šæ­¥éª¤èƒå–ï¼ŒåŠ æ°´ï¼Œå€’å‡º(åŸºæœ¬æ“ä½œï¼ŒæŠ½è±¡ç±»å®ç°)ï¼Œä¸åŒçš„å’–å•¡é…æ–™ä¸åŒ(æŠ½è±¡æ–¹æ³•å­ç±»å®ç°)ï¼Œå®¢æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰åŠ ç³–ã€å†°(é’©å­æ–¹æ³•)...

```java
//æŠ½è±¡ç±»
public abstract class Coffee {

    void addEspresso() {
        System.out.println("èƒå–å’–å•¡");
    }
    void addWater() {
        System.out.println("åŠ æ°´å†²æ³¡");
    }
    void addIce() {
        System.out.println("åŠ å†°");
    }
    void addSugar() {
        System.out.println("åŠ ç³–");
    }
    void pourInCup() {
        System.out.println("å€’å…¥æ¯å­");
    }
    //æ˜¯å¦é€‰æ‹©åŠ ç³– é»˜è®¤ä¸åŠ 
    boolean choseAddSugar() {
        return false;
    }

    //é€‰æ‹©åŠ å†°
    boolean choseAddIce() {
        return false;
    }
    //æŠ½è±¡æ–¹æ³•ï¼Œéœ€è¦å­ç±»è¿›è¡Œé‡å†™
    abstract void addType();

    public final void makingDrinks() {
        //åŸºæœ¬æµ“ç¼©å’–å•¡
        addEspresso();
        //å†²æ³¡
        addWater();
        //åŠ æ–™(è‡ªå®šä¹‰é…æ–™)
        addType();
        
        //é€‰æ‹©è¾…æ–™
        //é’©å­æ–¹æ³•
        if(choseAddSugar()){
            addSugar();
        }
        if (choseAddIce()){
            addIce();
        }

        //å€’è¿›æ¯å­
        pourInCup();
    }
}

//ç¾å¼å’–å•¡
public class LongBlack extends Coffee {
    @Override
    void addType() {
        System.out.println("ç¾å¼å’–å•¡å†åŠ æ°´");
    }
    //é‡å†™æ–¹æ³• è¿›è¡ŒåŠ ç³–åŠ å†°
    @Override
    boolean choseAddSugar() {
        return true;
    }

    @Override
    boolean choseAddIce() {
        return true;
    }
}

//æ‹¿é“
public class Latte extends Coffee {
    @Override
    void addType() {
        System.out.println("æ‹¿é“åŠ å¥¶");
    }

    @Override
    boolean choseAddSugar() {
        return true;
    }
}

//å¡å¸ƒå¥‡è¯º
public class Cappuccino extends Coffee {
    @Override
    void addType() {
        System.out.println("å¡å¸ƒå¥‡è¯ºåŠ å…¥å¥¶æ³¡");
    }
}
```

```java
public class Client {
    public static void main(String[] args) {

        LongBlack latte = new LongBlack();
        latte.makingDrinks();  
        //è¾“å‡º èƒå–å’–å•¡ åŠ æ°´å†²æ³¡ ç¾å¼å’–å•¡å†åŠ æ°´ åŠ ç³– åŠ å†° å€’å…¥æ¯å­

        Latte latte1 = new Latte();
        latte1.makingDrinks();
        //èƒå–å’–å•¡ åŠ æ°´å†²æ³¡ æ‹¿é“åŠ å¥¶ åŠ ç³– å€’å…¥æ¯å­
    }
}

```

## Spring ä¸­çš„æ¨¡æ¿æ–¹æ³•
IOC å®¹å™¨åˆå§‹åŒ–æ—¶çš„æ¨¡æ¿æ–¹æ³•ï¼Œä¸ç®¡æ˜¯ XML è¿˜æ˜¯æ³¨è§£çš„æ–¹å¼ï¼Œå¯¹äºæ ¸å¿ƒå®¹å™¨å¯åŠ¨æµç¨‹éƒ½æ˜¯ä¸€è‡´çš„

`AbstractApplicationContext` çš„ `refresh` æ–¹æ³•å®ç°äº† IOC å®¹å™¨å¯åŠ¨çš„ä¸»è¦é€»è¾‘ã€‚

ä¸€ä¸ª `refresh()` æ–¹æ³•åŒ…å«äº†å¥½å¤šå…¶ä»–æ­¥éª¤æ–¹æ³•ï¼Œåƒä¸åƒæˆ‘ä»¬è¯´çš„ **æ¨¡æ¿æ–¹æ³•**ï¼Œ`getBeanFactory()` ã€`refreshBeanFactory()` æ˜¯å­ç±»å¿…é¡»å®ç°çš„æŠ½è±¡æ–¹æ³•ï¼Œ`postProcessBeanFactory()` æ˜¯é’©å­æ–¹æ³•ã€‚

```java
public abstract class AbstractApplicationContext extends DefaultResourceLoader
      implements ConfigurableApplicationContext {
	@Override
	public void refresh() throws BeansException, IllegalStateException {
		synchronized (this.startupShutdownMonitor) {
			prepareRefresh();
			ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();
			prepareBeanFactory(beanFactory);
            postProcessBeanFactory(beanFactory);
            invokeBeanFactoryPostProcessors(beanFactory);
            registerBeanPostProcessors(beanFactory);
            initMessageSource();
            initApplicationEventMulticaster();
            onRefresh();
            registerListeners();
            finishBeanFactoryInitialization(beanFactory);
            finishRefresh();
		}
	}
    // ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•
    @Override
	public abstract ConfigurableListableBeanFactory getBeanFactory() throws 		IllegalStateException;	
    
    protected abstract void refreshBeanFactory() throws BeansException, IllegalStateException;
    
    //é’©å­æ–¹æ³•
    protected void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {
	}
 }
```

æ‰“å¼€ä½ çš„ IDEAï¼Œæˆ‘ä»¬ä¼šå‘ç°å¸¸ç”¨çš„ `ClassPathXmlApplicationContext` å’Œ `AnnotationConfigApplicationContext` å¯åŠ¨å…¥å£ï¼Œéƒ½æ˜¯å®ƒçš„å®ç°ç±»ï¼ˆå­ç±»çš„å­ç±»çš„å­ç±»çš„...ï¼‰ã€‚

`AbstractApplicationContext` çš„ä¸€ä¸ªå­ç±» `AbstractRefreshableWebApplicationContext` ä¸­æœ‰é’©å­æ–¹æ³• `onRefresh() ` çš„å®ç°ï¼š

```java
public abstract class AbstractRefreshableWebApplicationContext extends â€¦â€¦ {
    /**
	 * Initialize the theme capability.
	 */
	@Override
	protected void onRefresh() {
		this.themeSource = UiApplicationContextUtils.initThemeSource(this);
	}
}
```

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/æ¨¡æ¿æ–¹æ³•æ¨¡å¼Springiocç»“æ„å›¾.png)

## æ¨¡æ¿æ–¹æ³•æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚

- ç®—æ³•åªå­˜åœ¨äºçˆ¶ç±»ä¸­ï¼Œå®¹æ˜“è¿›è¡Œä¿®æ”¹ï¼ŒåŒæ—¶ç”±å­ç±»å®ç°å…·ä½“ç»†èŠ‚ï¼Œæ–¹ä¾¿æ‰©å±•
- æ¨¡æ¿æ–¹æ³•é€šè¿‡é’©å­å¯ä»¥å®ç°åå‘æ§åˆ¶
- æ›´æ¢å’Œå¢åŠ æ–°çš„å­ç±»éå¸¸æ–¹ä¾¿ï¼Œç¬¦åˆå•ä¸€èŒè´£å’Œå¼€é—­åŸåˆ™



# å‘½ä»¤æ¨¡å¼ğŸŸ©  
å‘½ä»¤æ¨¡å¼`Command Pattern` å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œ å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒ**å¯æ’¤é”€**çš„æ“ä½œ     
å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œä¹Ÿç§°ä½œåŠ¨ä½œæ¨¡å¼æˆ–äº‹åŠ¡æ¨¡å¼

## ç»“æ„å’Œå®ç° 
å‘½ä»¤æ¨¡å¼çš„æ ¸å¿ƒåœ¨äºå¼•å…¥äº†æŠ½è±¡å‘½ä»¤ç±»å’Œå…·ä½“å‘½ä»¤ç±»ï¼Œ**é€šè¿‡å‘½ä»¤ç±»æ¥é™ä½å‘é€è€…å’Œæ¥æ”¶è€…çš„è€¦åˆåº¦**ï¼Œè¯·æ±‚å‘é€è€…ç§©åºæŒ‡å®šä¸€ä¸ªå‘½ä»¤å¯¹è±¡ï¼Œå†é€šè¿‡å‘½ä»¤å¯¹è±¡æ¥è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„å¤„ç†æ–¹æ³•   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å‘½ä»¤æ¨¡å¼ç»“æ„å›¾.png)

- `Command`æŠ½è±¡å‘½ä»¤ç±»ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œé€šè¿‡å…¶ä¸­çš„æ–¹æ³•è°ƒç”¨è¯·æ±‚æ¥æ”¶è€…çš„ç›¸å…³æ“ä½œ  
- `ConcreteCommand`å…·ä½“å‘½ä»¤ç±»ï¼ŒæŠ½è±¡å‘½ä»¤ç±»çš„å­ç±»ï¼Œå®ç°äº†æŠ½è±¡å‘½ä»¤ç±»ä¸­å£°æ˜çš„æ–¹æ³•
- `Invoker`è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…å³è¯·æ±‚å‘é€è€…ï¼Œé€šè¿‡å‘½ä»¤å¯¹è±¡æ¥æ‰§è¡Œè¯·æ±‚
- `Reveiver`æ¥æ”¶è€…ï¼Œæ¥æ”¶è€…æ‰§è¡Œä¸è¯·æ±‚ç›¸å…³çš„æ“ä½œï¼Œå…·ä½“å®ç°å¯¹è¯·æ±‚çš„ä¸šåŠ¡å¤„ç† 

> é€šä¿—ç†è§£å°±æ˜¯ï¼šå°†å†›å‘å¸ƒå‘½ä»¤ï¼Œå£«å…µå»æ‰§è¡Œå‘½ä»¤ï¼Œ`Invoker`å°±æ˜¯å°†å†›ï¼Œ`Reveiver`å°±æ˜¯å£«å…µï¼Œ`Command` å’Œ `ConcreteCommand`å°±æ˜¯å‘½ä»¤ç±»ï¼Œå°†å†›è´Ÿè´£å‘å¸ƒå‘½ä»¤ï¼Œå…·ä½“å‘½ä»¤ç”±è°æ‰§è¡Œï¼Œç”±å‘½ä»¤ç±»é‡å†™çš„æ–¹æ³•å†³å®šï¼Œè­¬å¦‚æ˜¯ç”±å·¥å…µè¿˜æ˜¯ä¾¦å¯Ÿå…µæ¥æ‰§è¡Œï¼Œéœ€è¦å‘½ä»¤ç±»æ¥æŒ‡å®š     

```java
//å‘½ä»¤æ¥å£
public interface Command {
    //æ‰§è¡Œ
    void execute();
    //æ’¤é”€
    void undo();
}

//ä¸€ä¸ªå‘½ä»¤å•ç‹¬å®ç°Command å®é™…å¯èƒ½æœ‰å¤šä¸ª
public class ConcreteCommand implements Command {

    private Receiver receiver;

    public ConcreteCommand(Receiver receiver) {
        this.receiver = receiver;
    }

    @Override
    public void execute() {
        receiver.action();
    }

    @Override
    public void undo() {
        receiver.undo();
    }
}

//æ‰§è¡Œè€… çœŸæ­£çš„æ‰§è¡ŒåŠ¨ä½œ
public class Receiver {
    public void action(){
        System.out.println("æ‰§è¡ŒåŠ¨ä½œ");
    }
    public void undo(){
        System.out.println("æ‰§è¡Œå–æ¶ˆåŠ¨ä½œ");
    }
}

public class Invoker {
    private Command command;

    //æ„é€ æ³¨å…¥
    public Invoker(Command command) {
        this.command = command;
    }

    //è®¾å€¼æ³¨å…¥
    public void setCommand(Command command) {
        this.command = command;
    }
    //è°ƒç”¨å‘½ä»¤çš„æ–¹æ³•
    public void call(){
        command.execute();
    }
    public void unCall(){
        command.undo();
    }
}

//æµ‹è¯•
public class Client {
    public static void main(String[] args) {
        Command concreteCommand = new ConcreteCommand(new Receiver());
        Invoker invoker = new Invoker(concreteCommand);
        invoker.call();//æ‰§è¡ŒåŠ¨ä½œ
        invoker.unCall();//æ‰§è¡Œå–æ¶ˆåŠ¨ä½œ
    }
}
```

å‘½ä»¤æ¨¡å¼ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ª`ConcreteCommand`å’Œ`Receiver`


## ä¼˜ç¼ºç‚¹å’Œç»†èŠ‚

### ä¼˜ç‚¹ 
- é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦
- æé«˜ç³»ç»Ÿæ‰©å±•æ€§ï¼Œæ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“çš„åŠ å…¥åˆ°ç³»ç»Ÿä¸­
- å¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„è®¾è®¡ä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—æˆ–å®å‘½ä»¤
- ä¸ºè¯·æ±‚çš„æ’¤é”€å’Œæ¢å¤æ“ä½œæä¾›äº†ä¸€ç§è®¾è®¡å’Œå®ç°æ–¹æ¡ˆ 


### ç¼ºç‚¹ 
å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­æœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»  

### é€‚ç”¨ç¯å¢ƒ
- ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’
- ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ 
- ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€å’Œæ¢å¤æ“ä½œ  


# è®¿é—®è€…æ¨¡å¼ğŸŸ© 
è®¿é—®è€…æ¨¡å¼ä¸»è¦åŒ…å«è®¿é—®è€…å’Œè¢«è®¿é—®è€…ï¼Œè¢«è®¿é—®çš„å…ƒç´ å…·æœ‰ä¸åŒçš„ç±»å‹ï¼Œè€Œä¸”ä¸åŒçš„è®¿é—®è€…å¯ä»¥å¯¹å…¶æ–½åŠ ä¸åŒçš„è®¿é—®æ“ä½œã€‚è®¿é—®è€…æ¨¡å¼å¯ä»¥ä½¿å¾—ç”¨æˆ·åœ¨ä¸ä¿®æ”¹ç°æœ‰ç³»ç»Ÿçš„æƒ…å†µä¸‹æ‰©å±•ç³»ç»ŸåŠŸèƒ½ï¼Œä¸ºä¸åŒç±»å‹çš„å…ƒç´ æ·»åŠ æ–°çš„æ“ä½œ    

## ç»“æ„ 
ä»¥åŒ»ç”Ÿå¼€å…·è¯æ–¹ä¸ºä¾‹ï¼Œ`åŒ»ç”Ÿ`å¼€å…·`è¯æ–¹`ï¼Œ`ä¼šè®¡`æ ¹æ®`è¯æ–¹`ç¼´è´¹ï¼Œ`è¯æˆ¿`æ ¹æ®`è¯æ–¹`æ‹¿è¯,è¯æ–¹åœ¨è¿™é‡Œçœ‹ä½œå¤šç§è¯å“çš„é›†åˆï¼Œå¯èƒ½éœ€è¦æä¾›é’ˆå¯¹è¯çš„å¤šç§å¤„ç†æ–¹å¼  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è®¿é—®è€…æ¨¡å¼ç»“æ„.png ':size=80%')  

- `Visitor`æŠ½è±¡è®¿é—®è€…ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­æ¯ä¸€ä¸ªå…·ä½“å…ƒç´ å£°æ˜ä¸€ä¸ªè®¿é—®æ“ä½œï¼Œå…·ä½“è®¿é—®è€…éœ€è¦å®ç°è¿™äº›æ“ä½œæ–¹æ³•ï¼Œå®šä¹‰å…·ä½“è®¿é—®æ“ä½œ
- `ConcreteVisitor`å…·ä½“è®¿é—®è€…ï¼Œå®ç°äº†æ¯ä¸ªç”±æŠ½è±¡è®¿é—®è€…å£°æ˜çš„æ“ä½œï¼Œæ¯ä¸ªæ“ä½œç”¨äºè®¿é—®å¯¹è±¡ç»“æ„ä¸­ä¸€ç§ç±»å‹çš„å…ƒç´   
- `Element`æŠ½è±¡å…ƒç´ ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»æˆ–æ¥å£ï¼Œå£°æ˜ä¸€ä¸ª`accept()`æ–¹æ³•ï¼Œç”¨äºæ¥å—è®¿é—®è€…çš„è®¿é—®æ“ä½œï¼Œæ–¹æ³•é€šå¸¸ä»¥ä¸€ä¸ªæŠ½è±¡è®¿é—®è€…ä½œä¸ºå‚æ•°
- `ConcreteElement`å…·ä½“å…ƒç´ ï¼Œå®ç°äº†`accept()`æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­è°ƒç”¨è®¿é—®è€…çš„è®¿é—®æ–¹æ³•ä»¥ä¾¿å®Œæˆå¯¹ä¸€ä¸ªå…ƒç´ çš„æ“ä½œ   
- `ObjectStructure`å¯¹è±¡ç»“æ„ï¼Œå…ƒç´ çš„é›†åˆï¼Œç”¨äºå­˜æ”¾å…ƒç´ å¯¹è±¡ï¼Œæä¾›éå†å…¶å†…éƒ¨å…ƒç´ (é›†åˆ)çš„æ–¹æ³•

æ¡ˆä¾‹ä»£ç ï¼š  
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è®¿é—®è€…æ¨¡å¼ç¤ºä¾‹.png)

1. è¯å“è¶…ç±»   
```java
public abstract class Med {
    public abstract void accept(Visitor v);
}
```

2.ä¸­è¯å’Œè¥¿è¯ç±»   
```java
public class MedZhong extends Med {
    @Override
    public void accept(Visitor visitor) {
        visitor.getZhong(this);
    }
}

public class MedXi extends Med {
    @Override
    public void accept(Visitor visitor) {
        visitor.getXi(this);
    }
}
```

3. è®¿é—®è€…è¶…ç±»(åŒ»é™¢å‘˜å·¥ç±»)     
```java
public abstract class Visitor {
    public abstract void getZhong(MedZhong z);
    public abstract void getXi(MedXi x);
}
```

4. åŒ»ç”Ÿç±»å’Œä¼šè®¡ç±»     
```java
public class Doctor extends Visitor {
    @Override
    public void getZhong(MedZhong z) {
        System.out.println("åŒ»ç”Ÿè·å–-ä¸­è¯");
    }

    @Override
    public void getXi(MedXi x) {
        System.out.println("åŒ»ç”Ÿè·å–-è¥¿è¯");
    }
}
public class Kuaiji extends Visitor {
    @Override
    public void getZhong(MedZhong z) {
        System.out.println("ä¼šè®¡è·å–-ä¸­è¯");
    }

    @Override
    public void getXi(MedXi x) {
        System.out.println("ä¼šè®¡è·å–-è¥¿è¯");
    }
}
``` 

5. è¯æ–¹ç±»ï¼Œå¤šç§è¯çš„é›†åˆ     
```java
public class MedListObj {
    private List<Med> meds = new LinkedList<>();

    public void add(Med m) {
        meds.add(m);

    }

    public void remove(Med p) {
        meds.remove(p);
    }

    public void display(Visitor v) {
        for (Med m : meds) {
            m.accept(v);
        }
    }
}
```

6. æµ‹è¯•ç±»

```java
public class Client {
    public static void main(String[] args) {
        MedListObj medListObj = new MedListObj();
        medListObj.add(new MedXi());
        medListObj.add(new MedZhong());
        medListObj.display(new Doctor()); //åŒ»ç”Ÿè·å–-è¥¿è¯ åŒ»ç”Ÿè·å–-ä¸­è¯ åŒ»ç”Ÿè·å–-è¥¿è¯
    }
}
```

## æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚  

### ä¼˜ç‚¹ 
- è®¿é—®è€…æ¨¡å¼ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œè®©ç¨‹åºæœ‰æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œå¢åŠ æ–°çš„è®¿é—®æ“ä½œå¾ˆæ–¹ä¾¿  
- è®¿é—®è€…æ¨¡å¼é€‚ç”¨äºæ•°æ®ç»“æ„ç›¸å¯¹ç¨³å®šçš„ç³»ç»Ÿ  

### ç¼ºç‚¹ 
- åœ¨è®¿é—®è€…æ¨¡å¼ä¸­å¢åŠ æ–°çš„å…ƒç´ ç±»ConcreteElementå¾ˆå›°éš¾ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°å…ƒç´ éƒ½éœ€è¦åœ¨æŠ½è±¡è®¿é—®è€…ç§æ·»åŠ æ–°çš„æŠ½è±¡æ–¹æ³•  
- è®¿é—®è€…æ¨¡å¼ç ´åäº†å¯¹è±¡çš„å°è£…æ€§ã€‚

### é€‚ç”¨ç¯å¢ƒ  
ä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¤šä¸ªç±»å‹çš„å¯¹è±¡ï¼Œå¸Œæœ›å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–å…¶å…·ä½“ç±»å‹çš„æ“ä½œã€‚    
å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œ   

# è¿­ä»£å™¨æ¨¡å¼ğŸŸ© 
è½¯ä»¶å¼€å‘ä¸­å­˜åœ¨å¤§é‡çš„å¯ä»¥å­˜å‚¨å¤šä¸ªæˆå‘˜å¯¹è±¡çš„èšåˆç±»ï¼Œå¯¹åº”çš„å¯¹è±¡ç§°ä¸ºèšåˆå¯¹è±¡ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„æ“ä½œèšåˆå¯¹è±¡ï¼Œå¼•å…¥è¿­ä»£å™¨æ— éœ€äº†è§£èšåˆå¯¹è±¡çš„å†…éƒ¨ç»“æ„å³å¯å®ç°å¯¹èšåˆå¯¹è±¡ä¸­æˆå‘˜çš„éå†  

**è¿­ä»£å™¨æ¨¡å¼ï¼š**æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸ç”¨æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º(å†…éƒ¨ç»“æ„)   

## ç»“æ„ 

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è¿­ä»£å™¨æ¨¡å¼ç¤ºæ„å›¾.png)

- `Iterator`æŠ½è±¡è¿­ä»£å™¨ å®šä¹‰äº†è®¿é—®å’Œéå†å…ƒç´ çš„æ¥å£ï¼Œå£°æ˜äº†ç”¨äºéå†æ•°æ®å…ƒç´ çš„æ–¹æ³•,ä¸€èˆ¬ç”¨Javaä¸­çš„`java.util.Iterator`   

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/Iteratorç±»å›¾.png)

- `ConcreteIterator`å…·ä½“è¿­ä»£å™¨ï¼Œå®ç°äº†æŠ½è±¡è¿­ä»£å™¨æ¥å£ï¼Œå®Œæˆå¯¹èšåˆå¯¹è±¡çš„éå†ï¼ŒåŒæ—¶åœ¨å…¶ä¸­é€šè¿‡æ¸¸æ ‡æ¥è®°å½•åœ¨èšåˆå¯¹è±¡ä¸­æ‰€å¤„çš„å½“å‰ä½ç½®
- `Aggregate`æŠ½è±¡èšåˆç±»ï¼Œç”¨äºå­˜å‚¨å’Œç®¡ç†å…ƒç´ å¯¹è±¡ï¼Œå£°æ˜ä¸€ä¸ª`createIterator()`æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œå……å½“æŠ½è±¡è¿­ä»£å™¨å·¥å‚è§’è‰²
- `ConcreteAggregate`å…·ä½“èšåˆç±»ï¼ŒæŠ½è±¡èšåˆç±»çš„å­ç±»ï¼Œå®ç°äº†`createIterator()`æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“èšåˆç±»å¯¹åº”çš„å…·ä½“è¿­ä»£å™¨`ConcreteIterator`å®ä¾‹


## å®ç°
æ¡ˆä¾‹å®šä¹‰ å­¦æ ¡çš„å­¦é™¢å’Œéƒ¨é—¨çš„å…³ç³»ï¼Œä¸€ä¸ªå­¦é™¢ä¸­æœ‰å¤šä¸ªéƒ¨é—¨ï¼Œéå†å­¦æ ¡å­¦é™¢å’Œå…¶å†…çš„éƒ¨é—¨    
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/Iteratoræ¡ˆä¾‹å›¾.png)

1. æŠ½è±¡èšåˆç±» å’Œå…·ä½“èšåˆç±»    

```java
public interface College {
    String getName();
    void addDepartment(String name,String desc);
    Iterator createIterator();
}

public class ComputerCollege implements College {
    //æ•°ç»„æ–¹å¼
    Department[] departments;
    int numOfDepartment = 0;

    public ComputerCollege() {
        departments = new Department[3];
        addDepartment("Java","java desc");
        addDepartment("PHP","PHP desc");
        addDepartment("Python","python desc");
    }

    @Override
    public String getName() {
        return "è®¡ç®—æœºå­¦é™¢";
    }

    @Override
    public void addDepartment(String name, String desc) {
        Department department = new Department(name, desc);
        departments[numOfDepartment] = department;
        numOfDepartment++;

    }

    @Override
    public Iterator createIterator() {
        return new ComputerCollegeIterator(departments);
    }
}

public class InfoCollege implements College {
    List<Department> departmentList;

    public InfoCollege() {
        departmentList = new ArrayList<>();

        addDepartment("ä¿¡æ¯ä¸“ä¸š1","ä¸“ä¸šæè¿°1");
        addDepartment("ä¿¡æ¯ä¸“ä¸š2","ä¸“ä¸šæè¿°2");
        addDepartment("ä¿¡æ¯ä¸“ä¸š3","ä¸“ä¸šæè¿°3");
    }

    @Override
    public String getName() {
        return "ä¿¡æ¯å·¥ç¨‹å­¦é™¢";
    }

    @Override
    public void addDepartment(String name, String desc) {
        Department department = new Department(name, desc);
        departmentList.add(department);

    }

    @Override
    public Iterator createIterator() {
        return new InfoCollegeIterator(departmentList);
    }
}
```

2. å…·ä½“è¿­ä»£å™¨     

```java
//å­¦é™¢è¿­ä»£å™¨
public class ComputerCollegeIterator implements Iterator {
    //æ•°ç»„æ–¹å¼
    Department[] departments;
    //éå†çš„ä½ç½®
    int position = 0;

    public ComputerCollegeIterator(Department[] departments) {
        this.departments = departments;
    }

    @Override
    public boolean hasNext() {
        if (position >= departments.length || departments[position] == null) {
            return false;
        } else {
            return true;
        }
    }

    @Override
    public Object next() {
        Department department = departments[position];
        position += 1;

        return department;
    }

    @Override
    public void remove() {

    }
}

public class InfoCollegeIterator implements Iterator {
    List<Department> departmentList;
    //ç´¢å¼•
    int index = -1;

    public InfoCollegeIterator(List<Department> departmentList) {
        this.departmentList = departmentList;
    }

    @Override
    public boolean hasNext() {
        if (index >= departmentList.size() - 1) {
            return false;
        } else {
            index += 1;
            return true;
        }
    }

    @Override
    public Object next() {
        //æ­¤å¤„index æ˜¯åœ¨è°ƒç”¨ hasNextåŸºç¡€ä¸Šçš„ indexå·²ç»+1äº†
        return departmentList.get(index);
    }

    @Override
    public void remove() {

    }
}
```

3. åŸºæœ¬éƒ¨é—¨ç±»å’Œæµ‹è¯•æ–¹æ³•

```java
//éƒ¨é—¨
public class Department {
    private String name;
    private String desc;

    public Department(String name, String desc) {
        this.name = name;
        this.desc = desc;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDesc() {
        return desc;
    }

    public void setDesc(String desc) {
        this.desc = desc;
    }
}

//æ‰“å°
public class OutputImpl {
    //å­¦é™¢é›†åˆ
    List<College> collegeList;

    public OutputImpl(List<College> collegeList) {
        this.collegeList = collegeList;
    }
    //éå†æ‰€æœ‰å­¦é™¢
    public void printCollege(){
        Iterator<College> iterator = collegeList.iterator();
        while (iterator.hasNext()){
            College next = iterator.next();
            System.out.println("==="+next.getName()+"===");
            printDepartment(next.createIterator());
        }
    }

    public  void printDepartment(Iterator iterator){
        while (iterator.hasNext()){
            Department next = (Department) iterator.next();
            System.out.println(next.getName());
        }
    }

}
//æµ‹è¯•ç±»
public class Client {
    public static void main(String[] args) {
        ArrayList<College> colleges = new ArrayList<>();
        colleges.add(new ComputerCollege());
        colleges.add(new InfoCollege());
        OutputImpl output = new OutputImpl(colleges);
        output.printCollege();
    }
}
```

## Javaä¸­çš„è¿­ä»£å™¨
Javaçš„é›†åˆæ¡†æ¶`List` `Set` ç­‰èšåˆç±»éƒ½ç»§æ‰¿æˆ–å®ç°äº†`java.util.Collection`æ¥å£ï¼Œ`Collection`æ¥å£é™¤äº†åŸºæœ¬æ“ä½œæ–¹æ³•å¤–ï¼Œè¿˜æä¾›äº†ä¸€ä¸ª`iterator()`æ–¹æ³•ï¼Œç”¨äºè¿”å›ä¸€ä¸ªIteratorç±»å‹çš„è¿­ä»£å™¨å¯¹è±¡  

Javaä¸­çš„`Collection`æ¥å£å’Œ`Iterator`æ¥å£å……å½“äº†è¿­ä»£å™¨æ¨¡å¼çš„æŠ½è±¡å±‚ï¼Œåˆ†åˆ«å¯¹åº”äº**æŠ½è±¡èšåˆç±»**å’ŒæŠ½**è±¡è¿­ä»£å™¨**

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/javaä¸­çš„è¿­ä»£å™¨æ¨¡å¼ç¤ºä¾‹å›¾.png)


## ä½¿ç”¨ç»†èŠ‚å’Œä¼˜ç¼ºç‚¹
### ä¼˜ç‚¹
- è¿­ä»£å™¨æ¨¡å¼æ”¯æŒä»¥ä¸åŒæ–¹å¼éå†ä¸€ä¸ªèšåˆå¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ªèšåˆå¯¹è±¡ä¸Šå¯ä»¥å®šä¹‰å¤šç§éå†æ–¹å¼ 
- è¿­ä»£å™¨æ¨¡å¼ç®€åŒ–äº†èšåˆç±» 
- å°†è¿­ä»£å™¨åˆ†å¼€ï¼Œå°±æ˜¯æŠŠç®¡ç†å¯¹è±¡é›†åˆå’Œéå†å¯¹è±¡é›†åˆçš„è´£ä»»åˆ†å¼€  

### ç¼ºç‚¹
- æ¯ä¸ªèšåˆç±»éƒ½éœ€è¦ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¢åŠ æ–°çš„èšåˆç±»æ—¶éœ€è¦å¯¹åº”å¢åŠ æ–°çš„è¿­ä»£å™¨ç±»  
- è®¾è®¡éš¾åº¦è¾ƒå¤§ï¼Œéœ€è¦å……åˆ†è€ƒè™‘ç³»ç»Ÿæ‰©å±•

### é€‚ç”¨ç¯å¢ƒ 
- è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— éœ€æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºï¼Œè¿­ä»£å™¨å’Œèšåˆå¯¹è±¡åˆ†ç¦»
- éœ€è¦ä¸ºä¸€ä¸ªèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼
- ä¸ºéå†ä¸åŒèšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œæ–¹ä¾¿æ“ä½œ


# è§‚å¯Ÿè€…æ¨¡å¼ğŸŸ© 
è§‚å¯Ÿè€…æ¨¡å¼`Observer Patern`å®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶å…¶ç›¸å…³ä¾èµ–å¯¹è±¡çš†å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°   

> è§‚å¯Ÿè€…æ¨¡å¼æ˜¯é€‚ç”¨é¢‘ç‡è¾ƒé«˜çš„æ¨¡å¼ä¹‹ä¸€ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ä¸­å‘ç”Ÿæ”¹å˜çš„å¯¹è±¡ç§°ä¸ºè§‚å¯Ÿç›®æ ‡ï¼Œè¢«é€šçŸ¥çš„å¯¹è±¡ç§°ä¸ºè§‚å¯Ÿè€…ï¼Œä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯ä»¥å¯¹åº”å¤šä¸ªè§‚å¯Ÿè€…ï¼Œè€Œä¸”è¿™äº›è§‚å¯Ÿè€…ä¹‹é—´å¯ä»¥æ²¡æœ‰ä»»ä½•äº’ç›¸è”ç³»ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…ï¼Œä½¿å¾—ç³»ç»Ÿæ˜“äºæ‰©å±•

?> è§‚å¯Ÿè€…æ¨¡å¼åˆç§°ä¸º `å‘å¸ƒ-è®¢é˜…`æ¨¡å¼ã€`æ¨¡å‹-è§†å›¾`æ¨¡å¼ã€`æº-ç›‘å¬å™¨`æ¨¡å¼ã€`ä»å±è€…`æ¨¡å¼  

## ç»“æ„  
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è§‚å¯Ÿè€…æ¨¡å¼ç»“æ„å›¾.png)

- `Subject`ç›®æ ‡ï¼Œè¢«è§‚å¯Ÿå¯¹è±¡ï¼Œåœ¨å…¶ä¸­å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆï¼Œæä¾›æ–¹æ³•æ¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ï¼ŒåŒæ—¶å®šä¹‰é€šçŸ¥æ–¹æ³•`notify()`
- `ConcreteSubject`å…·ä½“ç›®æ ‡ï¼Œç›®æ ‡ç±»çš„å­ç±»ï¼ŒçŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶å°†å‘å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥
- `Observer`æŠ½è±¡è§‚å¯Ÿè€…ï¼Œæ¥å£å£°æ˜äº†æ›´æ–°æ•°æ®æ–¹æ³•`update()` 
- `Concreteobserver`å…·ä½“è§‚å¯Ÿè€…

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹å›¾.png)

```java
public abstract class Subject {
    //å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…é›†åˆç”¨äºå­˜å‚¨æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡
    protected List<Observer> observers = new ArrayList<>();

    //æ·»åŠ è§‚å¯Ÿè€…
    public void attach(Observer observer){
        observers.add(observer);
    }
    //ç§»é™¤è§‚å¯Ÿè€…
    public void detach(Observer observer){
        observers.remove(observer);
    }
    //é€šçŸ¥æ–¹æ³•ï¼Œå­ç±»é‡å†™
    public abstract void notifyX();
}

public class ConcreteSubject extends Subject {
    @Override
    public void notifyX() {
        //éå†æ‰€æœ‰è§‚å¯Ÿè€… æ‰§è¡Œå…¶å“åº”æ–¹æ³•
        for (Observer observer : observers) {
            observer.update();
        }
    }
}

public interface Observer {
    void update();
}


public class ConcreteObserver implements Observer {
    @Override
    public void update() {
        //å…·ä½“è§‚å¯Ÿè€…çš„å“åº”æ–¹æ³•
    }
   
}

//è°ƒç”¨ç¤ºä¾‹
public static void main(String[] args) {
        ConcreteObserver concreteObserver = new ConcreteObserver();
        ConcreteSubject subject = new ConcreteSubject();
        subject.attach(concreteObserver);
        subject.notifyX();
}
```

## åº”ç”¨  

### JDKä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼
`java.util.Observable`ç±»å……å½“äº†è§‚å¯Ÿç›®æ ‡ç±»ï¼Œåœ¨å…¶ä¸­å®šä¹‰äº†ä¸€ä¸ª`Vector` æ¥å­˜å‚¨è§‚å¯Ÿè€…å¯¹è±¡`Observer`   
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/javaä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼.png)

 Java9åè¢«å¼ƒç”¨  


### Springä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼
1. **äº‹ä»¶ï¼šApplicationEvent** æ˜¯æ‰€æœ‰äº‹ä»¶å¯¹è±¡çš„çˆ¶ç±»ã€‚ApplicationEvent ç»§æ‰¿è‡ª jdk çš„ EventObjectï¼Œæ‰€æœ‰çš„äº‹ä»¶éƒ½éœ€è¦ç»§æ‰¿ ApplicationEventï¼Œå¹¶ä¸”é€šè¿‡ source å¾—åˆ°äº‹ä»¶æºã€‚

   Spring ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šå†…ç½®äº‹ä»¶ï¼Œ`ContextRefreshedEvent`ã€`ContextStartedEvent`ã€`ContextStoppedEvent`ã€`ContextClosedEvent`ã€`RequestHandledEvent`ã€‚

2. **äº‹ä»¶ç›‘å¬ï¼šApplicationListener**ï¼Œä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…ï¼Œç»§æ‰¿è‡ª jdk çš„ EventListenerï¼Œè¯¥ç±»ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³• onApplicationEventã€‚å½“ç›‘å¬çš„äº‹ä»¶å‘ç”Ÿåè¯¥æ–¹æ³•ä¼šè¢«æ‰§è¡Œã€‚

3. **äº‹ä»¶æºï¼šApplicationContext**ï¼Œ`ApplicationContext` æ˜¯ Spring ä¸­çš„æ ¸å¿ƒå®¹å™¨ï¼Œåœ¨äº‹ä»¶ç›‘å¬ä¸­ ApplicationContext å¯ä»¥ä½œä¸ºäº‹ä»¶çš„å‘å¸ƒè€…ï¼Œä¹Ÿå°±æ˜¯äº‹ä»¶æºã€‚å› ä¸º ApplicationContext ç»§æ‰¿è‡ª ApplicationEventPublisherã€‚åœ¨ `ApplicationEventPublisher` ä¸­å®šä¹‰äº†äº‹ä»¶å‘å¸ƒçš„æ–¹æ³•ï¼š`publishEvent(Object event)`

4. **äº‹ä»¶ç®¡ç†ï¼šApplicationEventMulticaster**ï¼Œç”¨äºäº‹ä»¶ç›‘å¬å™¨çš„æ³¨å†Œå’Œäº‹ä»¶çš„å¹¿æ’­ã€‚ç›‘å¬å™¨çš„æ³¨å†Œå°±æ˜¯é€šè¿‡å®ƒæ¥å®ç°çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠ Applicationcontext å‘å¸ƒçš„ Event å¹¿æ’­ç»™å®ƒçš„ç›‘å¬å™¨åˆ—è¡¨ã€‚


## ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨ç¯å¢ƒ
### ä¼˜ç‚¹
- è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªæŠ½è±¡è€¦åˆï¼Œè§‚å¯Ÿç›®æ ‡åªè®¸ç»´æŒä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…é›†åˆï¼Œæ— éœ€äº†è§£å…·ä½“è§‚å¯Ÿè€…
- æ”¯æŒå¹¿æ’­é€šä¿¡ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šå‘æ‰€æœ‰å·²ç»æ³¨å†Œçš„è§‚å¯Ÿè€…å¯¹è±¡å‘é€é€šçŸ¥ã€
- æ–°å¢è§‚å¯Ÿè€…æ— éœ€ä¿®æ”¹æºä»£ç ï¼Œç¬¦åˆå¼€é—­åŸåˆ™  

### ç¼ºç‚¹
- è‹¥ä¸€ä¸ªè§‚å¯Ÿç›®æ ‡å¯¹è±¡æœ‰å¾ˆå¤šç›´æ¥è§‚å¯Ÿè€…ï¼Œé€šçŸ¥æ‰€æœ‰äººèŠ±è´¹ä»£ä»·å¾ˆå¤§
- è§‚å¯Ÿè€…å’Œè§‚å¯Ÿç›®æ ‡ä¹‹é—´æœ‰ä¾èµ–å¾ªç¯ï¼Œå°±ä¼šå¯¼è‡´å¾ªç¯è°ƒç”¨

### é€‚ç”¨ç¯å¢ƒ 
- é“¾å¼è§¦å‘æœºåˆ¶
- ä»…ä»…ç›‘å¬æ”¹å˜è€Œä¸å…³å¿ƒæ”¹å˜çš„å†…å®¹å’Œå¯¹è±¡   


# ä¸­ä»‹è€…æ¨¡å¼
ä¸€ä¸ªç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„è”ç³»å‘ˆç°ä¸ºç½‘çŠ¶ç»“æ„ï¼Œå¯¹è±¡ä¹‹é—´å­˜åœ¨å¤§é‡çš„å¤šå¯¹å¤šå…³ç³»ï¼Œå¯¼è‡´ç³»ç»Ÿéå¸¸çš„è´Ÿè½½ï¼Œè¿™äº›å¯¹è±¡å³ä¼šå½±å“å…¶ä»–å¯¹è±¡ï¼Œä¹Ÿä¼šè¢«å…¶ä»–å¯¹è±¡å½±å“ï¼Œè¿™äº›å¯¹è±¡ç§°ä¸ºåŒäº‹å¯¹è±¡ï¼Œä»–ä»¬ä¹‹é—´é€šè¿‡å½¼æ­¤ç›¸äº’ä½œç”¨å®ç°ç³»ç»Ÿçš„è¡Œä¸ºï¼Œè¿™å°†å¯¼è‡´ä¸€ä¸ªè¿‡åº¦è€¦åˆçš„ç³»ç»Ÿ     
ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥ä½¿å¯¹è±¡ä¹‹é—´çš„å…³ç³»æ•°é‡æ€¥å‰§å‡å°‘ï¼Œé€šè¿‡å¼•å…¥ä¸­ä»‹è€…å¯¹è±¡å¯ä»¥å°†ç³»ç»Ÿçš„ç½‘çŠ¶ç»“æ„å˜ä¸ºä»¥ä¸­ä»‹è€…ä¸ºä¸­å¿ƒçš„æ˜Ÿå‹ç»“æ„ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å‘ç”Ÿç›¸äº’ä½œç”¨

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ä¸­ä»‹è€…æ¨¡å¼çš„ç½‘çŠ¶ç»“æ„å’Œæ˜Ÿå‹ç»“æ„.png)

?> ä¾‹å¦‚ï¼šå¤šä¸ªå¾®ä¿¡å¥½å‹ä¹‹é—´è¿›è¡Œä¸€å¯¹ä¸€èŠå¤©å’Œç¾¤èŠ(ä¸­ä»‹è€…å°±æ˜¯ç¾¤)çš„å…³ç³»

> å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤šå¯¹å¤šçš„ç›¸äº’å…³ç³»ï¼Œå¯ä»¥å°†å¯¹è±¡ä¹‹é—´çš„ä¸€äº›äº¤äº’è¡Œä¸ºä»å„ä¸ªå¯¹è±¡ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œé›†ä¸­å°è£…åœ¨ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ä¸­ï¼Œå¹¶ç”±è¯¥ä¸­ä»‹è€…è¿›è¡Œç»Ÿä¸€åè°ƒ   

ä¸­ä»‹è€…æ¨¡å¼`Mediator Pattern`:å®šä¹‰ä¸€ä¸ªå¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡çš„äº¤äº’ï¼Œä¸­ä»‹è€…æ¨¡å¼ä½¿å„å¯¹è±¡ä¹‹é—´ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’è°ƒç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”ç”¨æˆ·å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’   

## ç»“æ„

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ä¸­ä»‹è€…æ¨¡å¼çš„ç»“æ„å›¾.png)

- `Mediator`æŠ½è±¡ä¸­ä»‹è€…ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œç”¨äºåŒäº‹ç±»ä¹‹é—´çš„é€šä¿¡
- `Concrete Mediator`å…·ä½“ä¸­ä»‹è€…ï¼ŒæŠ½è±¡ç»ˆç»“è€…çš„å­ç±»ï¼Œé€šè¿‡åè°ƒå„ä¸ªåŒäº‹å¯¹è±¡æ¥å®ç°åä½œè¡Œä¸ºï¼Œç»´æŒäº†å¯¹å„ä¸ªåŒäº‹å¯¹è±¡çš„å¼•ç”¨ 
- `Colleague`æŠ½è±¡åŒäº‹ç±»ï¼Œå®šä¹‰å„ä¸ªåŒäº‹ç±»å…¬æœ‰çš„æ–¹æ³•ï¼Œå¹¶å£°æ˜ä¸€äº›æŠ½è±¡æ–¹æ³•ä¾›å­ç±»å®ç°ï¼ŒåŒæ—¶ç»´æŒäº†ä¸€ä¸ªå¯¹æŠ½è±¡ä¸­ä»‹è€…ç±»çš„å¼•ç”¨ï¼Œå­ç±»é€šè¿‡è¯¥å¼•ç”¨å’Œä¸­ä»‹è€…é€šä¿¡
- `Concrete Colleague`å…·ä½“åŒäº‹ç±»ï¼ŒæŠ½è±¡åŒäº‹ç±»çš„å­ç±»ï¼ŒåŒäº‹ç±»ä¹‹é—´é€šè¿‡ä¸­ä»‹è€…å®Œæˆé€šä¿¡  

## åº”ç”¨

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ä¸­ä»‹è€…æ¨¡å¼æ¡ˆä¾‹å›¾.png)

æŠ½è±¡ä¸­ä»‹è€…ç±»/å…·ä½“ä¸­ä»‹è€…ç±»    
```java
public abstract class Mediator {
    protected List<Colleague> colleagues = new ArrayList<>();
    //å°†åŒäº‹å¯¹è±¡åŠ å…¥åˆ—è¡¨æ–¹ä¾¿ç›¸äº’è°ƒç”¨
    public void register(Colleague colleague) {
        colleagues.add(colleague);
    }

    public abstract void operation(Colleague colleague, int i);

}

public class ConcreteMediator extends Mediator {

    @Override
    public void operation(Colleague colleague,int i) {
        //æ ¹æ®ä¸åŒçš„å€¼è°ƒç”¨å¦ä¸€ä¸ªåŒäº‹ç±»çš„è‡ªå®šä¹‰æ–¹æ³•
        //å®ç°åŒäº‹ç±»ä¹‹é—´çš„é€šä¿¡
        if (i==1){
            colleagues.get(1).method1();
        }else{
            colleagues.get(0).method1();
        }
    }
}
```

æŠ½è±¡åŒäº‹ç±»å’Œ2ä¸ªå…·ä½“åŒäº‹ç±»  

```java
public abstract class Colleague {
    //æŠ½è±¡ä¸­ä»‹è€…çš„å¼•ç”¨
    protected Mediator mediator;
    //æ„é€ æ–¹æ³•
    public Colleague(Mediator mediator) {
        this.mediator = mediator;
    }
    //å£°æ˜è‡ªå®šä¹‰æ–¹æ³•
    public abstract void method1();
    //ä¸ä¸­ä»‹è€…çš„é€šä¿¡
    public void method2(int i){
        mediator.operation(this,i);
    }
}

public class ConcreteColleague extends Colleague {

    public ConcreteColleague(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void method1() {
        System.out.println("åŒäº‹ç±»1çš„è‡ªå®šä¹‰æ–¹æ³•");
    }
}

public class ConcreteColleague2 extends Colleague {

    public ConcreteColleague2(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void method1() {
        System.out.println("åŒäº‹ç±»2çš„è‡ªå®šä¹‰æ–¹æ³•");
    }
}
```

å®¢æˆ·ç«¯  

```java
public class Client {
    public static void main(String[] args) {
        Mediator concreteMediator = new ConcreteMediator();

        Colleague concreteColleague = new ConcreteColleague(concreteMediator);
        Colleague concreteColleague2 = new ConcreteColleague2(concreteMediator);
        concreteMediator.register(concreteColleague);
        concreteMediator.register(concreteColleague2);

        concreteColleague.method1();//åŒäº‹ç±»1çš„è‡ªå®šä¹‰æ–¹æ³•
        concreteColleague.method2(1);//åŒäº‹ç±»2çš„è‡ªå®šä¹‰æ–¹æ³•

        concreteColleague2.method1();//åŒäº‹ç±»2çš„è‡ªå®šä¹‰æ–¹æ³•
        concreteColleague2.method2(0);//åŒäº‹ç±»1çš„è‡ªå®šä¹‰æ–¹æ³•
    }
}
```

## ä¼˜ç¼ºç‚¹

**ä¼˜ç‚¹**ï¼šä¸­ä»‹è€…æ¨¡å¼ç®€åŒ–äº†å¯¹è±¡äº¤äº’ï¼Œè§£è€¦åŒäº‹ç±»å¯¹è±¡ï¼Œå‡å°‘å­ç±»ç”Ÿæˆ

**ç¼ºç‚¹**ï¼šä¸­ä»‹è€…è§’è‰²åŒ…å«å¤§é‡ä¸šåŠ¡é€»è¾‘ï¼Œäº¤äº’ç»†èŠ‚ï¼Œéš¾ä»¥ç»´æŠ¤

# å¤‡å¿˜å½•æ¨¡å¼ğŸŸ© 
å¤‡å¿˜å½•æ¨¡å¼æ˜¯è½¯ä»¶ç³»ç»Ÿä¸­çš„â€œæœˆå…‰å®ç›’â€å®ƒæä¾›äº†ä¸€ç§å¯¹è±¡çŠ¶ä½“çš„æ’¤é”€å®ç°æœºåˆ¶ï¼Œå½“ç³»ç»Ÿä¸­çš„æŸä¸ªå¯¹è±¡éœ€è¦æ¢å¤åˆ°æŸä¸€å†å²çŠ¶æ€æ—¶å¯ä»¥ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼è¿›è¡Œè®¾è®¡

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¤‡å¿˜å½•æ¨¡å¼ç¤ºæ„å›¾.png)


**å¤‡å¿˜å½•æ¨¡å¼**`Memento Pattern`åœ¨ä¸ç ´åå°è£…çš„å‰æä¸‹æ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œè¿™æ ·å¯ä»¥åœ¨ä»¥åå°†å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€   

?> å¤‡å¿˜å½•æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œåˆ«åä¸º æ ‡è®°`Token`æ¨¡å¼

## ç»“æ„

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/å¤‡å¿˜å½•æ¨¡å¼ç»“æ„å›¾.png)

- `Originator`åŸå‘å™¨ã€‚é€šè¿‡åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•æ¥å­˜å‚¨å½“å‰å†…éƒ¨çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤‡å¿˜å½•æ¥æ¢å¤å…¶å†…éƒ¨çŠ¶æ€
- `Memento` å¤‡å¿˜å½•ï¼Œç”¨äºå­˜å‚¨åŸå‘å™¨çš„å†…éƒ¨çŠ¶æ€ï¼Œæ ¹æ®åŸå‘å™¨æ¥å†³å®šä¿å­˜é‚£äº›å†…éƒ¨çŠ¶æ€
- `Caretaker`è´Ÿè´£äººï¼Œè´Ÿè´£ä¿å­˜/æå–å¤‡å¿˜å½•ï¼Œä½†æ˜¯ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œæ“ä½œæˆ–æ£€æŸ¥  

```java
public class Originator {
    private String state;

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

    //ç¼–å†™ä¸€ä¸ªæ–¹æ³•å¯ä»¥ä¿å­˜çŠ¶æ€å¯¹è±¡ï¼Œ
    public Memento save(){
        return new Memento(state);
    }

    public void getStateFromMemento(Memento memento){
        state = memento.getState();
    }
}

public class Memento {
    //ä¿å­˜çš„state
    private String state;

    public Memento(String state) {
        this.state = state;
    }

    public String getState() {
        return state;
    }
}

public class Caretaker {
    private List<Memento> list = new ArrayList<>();

    public void add(Memento memento) {
        list.add(memento);
    }

    public Memento get(int index) {
        return list.get(index);
    }
}

//æµ‹è¯•ç±»
public class Client {
    public static void main(String[] args) {
        Originator originator = new Originator();
        Caretaker caretaker = new Caretaker();
        originator.setState("çŠ¶æ€1");
        caretaker.add(originator.save());

        originator.setState("çŠ¶æ€2");
        caretaker.add(originator.save());

        originator.getStateFromMemento(caretaker.get(0));
        System.out.println(originator.getState());
        originator.getStateFromMemento(caretaker.get(1));
        System.out.println(originator.getState());

    }
}
```

## ä¼˜ç¼ºç‚¹å’Œæ³¨æ„
æä¾›äº†ä¸€ç§çŠ¶æ€æ¢å¤æœºåˆ¶ï¼Œå¯ä»¥æ¢å¤åˆ°ç‰¹å®šçš„çŠ¶æ€ï¼Œä½†æ˜¯èµ„æºæ¶ˆè€—è¿‡å¤§ï¼Œæˆå‘˜å˜é‡å¯¹è±¡å¤ªå¤š  

é€‚ç”¨äºä¿å­˜ä¸€ä¸ªå¯¹è±¡åœ¨æŸä¸€æ—¶åˆ»çš„å…¨éƒ¨çŠ¶æ€æˆ–éƒ¨åˆ†çŠ¶æ€ï¼Œé˜²æ­¢å¤–ç•Œå¯¹è±¡ç ´ç¯ä¸€ä¸ªå¯¹è±¡çš„å†å²çŠ¶æ€   

# è§£é‡Šå™¨æ¨¡å¼ğŸŸ© 
è§£é‡Šå™¨æ¨¡å¼ç”¨äºæè¿°å’Œæ„æˆä¸€ä¸ªç®€å•çš„è¯­è¨€è§£é‡Šå™¨ï¼Œä¸»è¦åº”ç”¨äºä½¿ç”¨é¢å‘å¯¹è±¡è¯­è¨€å¼€å‘çš„è§£é‡Šå™¨çš„è®¾è®¡ã€‚å½“éœ€è¦å¼€å‘ä¸€ä¸ªæ–°çš„è¯­è¨€æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼  

**è§£é‡Šå™¨æ¨¡å¼**`Interpreter Pattern`:ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­

## ç»“æ„ 
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è§£é‡Šå™¨æ¨¡å¼ç»“æ„å›¾.png)

- `AbstractExpression`æŠ½è±¡è¡¨è¾¾å¼ã€‚å£°æ˜äº†æŠ½è±¡çš„è§£é‡Šæ“ä½œï¼Œæ˜¯æ‰€æœ‰`ç»ˆç»“ç¬¦è¡¨è¾¾å¼`å’Œ`éç»ˆç»“ç¬¦è¡¨è¾¾å¼`çš„å…¬å…±çˆ¶ç±»
- `TerminalExpression`ç»ˆç»“ç¬¦è¡¨è¾¾å¼,å®ç°äº†æ–‡æ³•ä¸­çš„ç»ˆç»“ç¬¦ç›¸å…³è”çš„è§£é‡Šæ“ä½œ,åœ¨å¥å­ä¸­çš„æ¯ä¸€ä¸ªç»ˆç»“ç¬¦éƒ½æ˜¯è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹
- `NonterminalExpression`éç»ˆç»“ç¬¦è¡¨è¾¾å¼,å®ç°äº†æ–‡æ³•ä¸­éç»ˆç»“ç¬¦çš„è§£é‡Šæ“ä½œ.è§£é‡Šæ“ä½œä¸€èˆ¬é€šè¿‡é€’å½’æ–¹å¼æ¥å®ç°
- `Contex`ç¯å¢ƒç±»,ç”¨äºå­˜å‚¨è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯,é€šå¸¸ä¸´æ—¶å­˜å‚¨äº†è¦è§£é‡Šçš„è¯­å¥
- `Client`å®¢æˆ·ç±»,åœ¨å®¢æˆ·ç±»ä¸­æ„é€ äº†è¡¨ç¤ºè¯¥æ–‡æ³•å®šä¹‰çš„è¯­è¨€ä¸­ä¸€ä¸ªç‰¹å®šå¥å­çš„æŠ½è±¡è¯­æ³•æ ‘,è¯¥æŠ½è±¡è¯­æ³•æ ‘ç”±éç»ˆç»“ç¬¦è¡¨è¾¾å¼å’Œç»ˆç»“ç¬¦è¡¨è¾¾å¼å®ä¾‹ç»„åˆè€Œè¨€,åœ¨å®¢æˆ·ç±»ä¸­è¿˜å°†è°ƒç”¨è§£é‡Šæ“ä½œ,å®ç°å¯¹å¥å­çš„è§£é‡Š


**è§£é‡Šå™¨æ¨¡å¼ç•¥è¿‡,æœ‰éœ€è¦å†è¯¦ç»†ç†è§£**     
p133-135 ç•¥è¿‡

# çŠ¶æ€æ¨¡å¼ğŸŸ© 
çŠ¶æ€æ¨¡å¼ç”¨äºè§£å†³ç³»ç»Ÿä¸­å¤æ‚é˜Ÿå½¢çš„çŠ¶æ€è½¬æ¢ä»¥åŠä¸åŒä¸“æ”¹ä¸‹è¡Œä¸ºçš„å°è£…é—®é¢˜,å½“ç³»ç»Ÿä¸­æŸä¸ªå¯¹è±¡å­˜åœ¨å¤šä¸ªçŠ¶æ€,è¿™äº›çŠ¶æ€ä¹‹é—´å¯ä»¥è¿›è¡Œè½¬æ¢,è€Œä¸”å¯¹è±¡åœ¨ä¸åŒçŠ¶æ€ä¸‹è¡Œä¸ºä¸ç›¸åŒæ—¶å¯ä»¥ä½¿ç”¨çŠ¶æ€æ¨¡å¼    

**çŠ¶æ€æ¨¡å¼**`State Pattern`:å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º,å¯¹è±¡å¼€èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±» 

## ç»“æ„ 

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/çŠ¶æ€æ¨¡å¼ç»“æ„å›¾.png)

- `Context`ç¯å¢ƒç±»,åˆç§°ä¸ºä¸Šä¸‹æ–‡ç±»,æ‹¥æœ‰å¤šç§çŠ¶æ€çš„å¯¹è±¡
- `State`æŠ½è±¡çŠ¶æ€ç±»ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£å°è£…ä¸`Context`çš„ä¸€ä¸ªç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºï¼Œåœ¨æŠ½è±¡çŠ¶æ€ç±»ä¸­å£°æ˜äº†å„ç§ä¸åŒçŠ¶æ€çš„åº”å¯¹æ–¹æ³•  
- `ConcreteState`å…·ä½“çŠ¶æ€ç±»ï¼ŒæŠ½è±¡çŠ¶æ€ç±»çš„å­ç±»ï¼Œæ¯ä¸ªå­ç±»å®ç°ä¸€ä¸ªä¸`Context`çš„çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºï¼Œæ¯ä¸ªå…·ä½“çŠ¶æ€ç±»å¯¹åº”ç¯å¢ƒçš„ä¸€ä¸ªå…·ä½“çŠ¶æ€  

## å®ç°

```java
public class Context {
    private State state;

    public Context(){
        state = null;
    }

    public void setState(State state){
        this.state = state;
    }

    public State getState(){
        return state;
    }
}


public interface State {
    public void doAction(Context context);
}

//å¼€å§‹çŠ¶æ€
public class StartState implements State {

    public void doAction(Context context) {
        System.out.println("Player is in start state");
        context.setState(this);
    }

    public String toString(){
        return "Start State";
    }
}

//ç»“æŸçŠ¶æ€
public class StopState implements State {
 
   public void doAction(Context context) {
      System.out.println("Player is in stop state");
      context.setState(this); 
   }
 
   public String toString(){
      return "Stop State";
   }
}

//æµ‹è¯•ç±»
public class Test {
    public static void main(String[] args) {
        Context context = new Context();

        StartState startState = new StartState();
        startState.doAction(context);//Player is in start state
        System.out.println(context.getState().toString());//Start State

        StopState stopState = new StopState();//Player is in stop state
        stopState.doAction(context);

        System.out.println(context.getState().toString());
    }
}
```


## ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨ç¯å¢ƒ

### ä¼˜ç‚¹
- çŠ¶æ€æ¨¡å¼å°è£…äº†çŠ¶æ€çš„è½¬æ¢è§„åˆ™ï¼Œåœ¨çŠ¶æ€æ¨¡å¼ä¸­å¯ä»¥å°†çŠ¶æ€çš„è½¬æ¢ä»£ç å°è£…åœ¨ç¯å¢ƒç±»æˆ–è€…æ˜¯å…·ä½“çŠ¶æ€ç±»ä¸­ï¼Œå¯ä»¥å¯¹çŠ¶æ€è½¬æ¢ä»£ç è¿›è¡Œé›†ä¸­ç®¡ç†ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨ä¸€ä¸ªä¸ªä¸šåŠ¡ç±»ä¸­  
- çŠ¶æ€æ¨¡å¼å°†æ‰€æœ‰å¯¹äºæŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œåªéœ€è¯¸å¦‚ä¸€ä¸ªä¸åŒçš„çŠ¶æ€å¯¹è±¡å³å¯ä½¿ç¯å¢ƒå¯¹è±¡æ‹¥æœ‰ä¸åŒçš„è¡Œä¸º
- çŠ¶æ€æ¨¡å¼å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“ï¼Œè€Œä¸æ˜¯æä¾›ä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å— 
- çŠ¶æ€æ¨¡å¼å¯ä»¥è®©å¤šä¸ªç¯å¢ƒå¯¹è±¡å…±äº«ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°

### ç¼ºç‚¹
- çŠ¶æ€æ¨¡å¼ä¼šå¢åŠ ç³»ç»Ÿä¸­ç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ï¼Œå¯¼è‡´ç³»ç»Ÿè¿è¡Œå¼€é”€å¢å¤§
- çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœé€‚ç”¨ä¸å½“å°†å¢åŠ ç³»ç»Ÿè®¾è®¡éš¾åº¦ 
- çŠ¶æ€æ¨¡å¼å¯¹å¼€é—­åŸåˆ™çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ï¼Œå¢åŠ æ–°çš„çŠ¶æ€ç±»éœ€è¦ä¿®æ”¹é‚£äº›è´Ÿè´£çŠ¶æ€è½¬æ¢çš„æºä»£ç ï¼Œä¿®æ”¹æŸä¸ªçŠ¶æ€ç±»çš„è¡Œä¸ºï¼Œä¹Ÿéœ€è¦ä¿®æ”¹å¯¹åº”ç±»çš„æºä»£ç 

### é€‚ç”¨ç¯å¢ƒ
- å¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå®ƒçš„çŠ¶æ€ï¼ŒçŠ¶æ€çš„æ”¹å˜å°†å¯¼è‡´è¡Œä¸ºçš„å˜åŒ–
- ä»£ç æ€»åŒ…å«å¤§é‡çš„ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ï¼Œè¿™äº›æ¡ä»¶è¯­å¥ä¼šå¯¼è‡´ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§å˜å·®ï¼Œä¸èƒ½æ–¹ä¾¿çš„å¢åŠ å’Œåˆ é™¤çŠ¶æ€


# ç­–ç•¥æ¨¡å¼ğŸŸ© 
ç­–ç•¥æ¨¡å¼ç”¨äºç®—æ³•çš„è‡ªç”±åˆ‡æ¢å’Œæ‰©å±•ï¼Œç­–ç•¥æ¨¡å¼å¯¹åº”äºè§£å†³æŸä¸€é—®é¢˜çš„ä¸€ä¸ªç®—æ³•æ—ï¼Œå…è®¸ç”¨æˆ·ä»è¯¥ç®—æ³•æ—ä¸­ä»»é€‰ä¸€ä¸ªç®—æ³•è§£å†³æŸä¸€é—®é¢˜ï¼ŒåŒå¯ä»¥æ–¹ä¾¿çš„æ›´æ¢ç®—æ³•æˆ–è€…å¢åŠ æ–°çš„ç®—æ³•ã€‚

ä¾‹å¦‚ï¼šæˆ‘ä»¬é€‰æ‹©å‡ºè¡Œæ–¹å¼ï¼Œé£æœºå¿«ä½†æ˜¯è´µï¼Œç«è½¦æ…¢ä½†æ˜¯ä¾¿å®œï¼Œè¿™æ—¶å°±éœ€è¦æ ¹æ®å®é™…æƒ…å†µçµæ´»çš„é€‰æ‹©å‡ºè¡Œæ–¹å¼ï¼Œå°±å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼  

**ç­–ç•¥æ¨¡å¼**`Strategy Pattern`:å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼è®©ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–   


## ç»“æ„ 
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/ç­–ç•¥æ¨¡å¼ç»“æ„å›¾.png)  

- `Context`ç¯å¢ƒç±»ï¼Œç¯å¢ƒç±»æ˜¯ä½¿ç”¨ç®—æ³•çš„è§’è‰²ï¼Œåœ¨è§£å†³æŸä¸ªé—®é¢˜æ—¶å¯ä»¥é‡‡ç”¨å¤šç§ç­–ç•¥ï¼Œç±»ä¸­ç»´æŒä¸€ä¸ªæŠ½è±¡ç­–ç•¥ç±»çš„å¼•ç”¨å®ä¾‹
- `Strategy`æŠ½è±¡ç­–ç•¥ç±»ï¼Œä¸ºæ‰€æ”¯æŒçš„ç®—æ³•å£°æ˜äº†æŠ½è±¡æ–¹æ³•ï¼Œæ˜¯æ‰€æœ‰ç­–ç•¥ç±»çš„çˆ¶ç±»ï¼Œç¯å¢ƒç±»é€šè¿‡æŠ½è±¡æ–¹æ³•è°ƒç”¨å…·ä½“ç­–ç•¥ç±»ä¸­å®ç°çš„ç®—æ³•
- `ConcreteStrtegy`å…·ä½“ç­–ç•¥ç±»ï¼Œå®ç°äº†å…·ä½“ç­–ç•¥ç±»ä¸­å£°æ˜çš„ç®—æ³•

## å®ç°

```java
public abstract class AbstractStrategy {
    public abstract void algorithm(); //å£°æ˜æŠ½è±¡ç®—æ³•
}
```

```java
//å…·ä½“ç®—æ³•A
public class ConcreteStrategyA extends AbstractStrategy {
    @Override
    public void algorithm() {
        System.out.println("ConcreteStrategyA");
    }
}

//å…·ä½“ç®—æ³•B
public class ConcreteStrategyB extends AbstractStrategy {
    @Override
    public void algorithm() {
        System.out.println("ConcreteStrategyB");
    }
}
```

```java
public class Context {
    //ç»´æŒä¸€ä¸ªå¯¹æŠ½è±¡ç­–ç•¥ç±»çš„å¼•ç”¨
    private AbstractStrategy strategy;

    public void setStrategy(AbstractStrategy strategy) {
        this.strategy = strategy;
    }

    //è°ƒç”¨ç­–ç•¥ç±»ä¸­çš„ç®—æ³•
    public void algorithm(){
        strategy.algorithm();
    }

}
```

```java
//ç¤ºä¾‹è°ƒç”¨
public class Client {
    public static void main(String[] args) {
        Context context = new Context();
        AbstractStrategy strategyA = new ConcreteStrategyA();
        AbstractStrategy strategyB = new ConcreteStrategyB();

        context.setStrategy(strategyA);
        context.algorithm();// System.out.println("ConcreteStrategyA");

        context.setStrategy(strategyB);
        context.algorithm();// System.out.println("ConcreteStrategyB");

    }
}
```

## ä¼˜ç¼ºç‚¹å’Œæ³¨æ„äº‹é¡¹ 

### é€‚ç”¨åœºæ™¯
- ä½¿ç”¨å¯¹è±¡ä¸­å„ç§ä¸åŒçš„ç®—æ³•å˜ä½“ï¼Œå¹¶å¸Œæœ›èƒ½åœ¨è¿è¡Œæ—¶åˆ‡æ¢ç®—æ³•ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼
- æœ‰è®¸å¤šä»…åœ¨æ‰§è¡ŒæŸäº›è¡Œä¸ºæ—¶ç•¥æœ‰ä¸åŒçš„ç›¸ä¼¼ç±»æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼
- ç±»ä¸­ä½¿ç”¨äº†è´Ÿè½½æ¡ä»¶è¿ç®—ç¬¦ä»¥åœ¨ç»Ÿä¸€ç®—æ³•çš„ä¸åŒå˜ä½“ä¸­åˆ‡æ¢æ—¶

### ä¼˜ç‚¹
- å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ‡æ¢å¯¹è±¡å†…çš„ç®—æ³•
- å¯ä»¥å°†ç®—æ³•çš„å®ç°å’Œä½¿ç”¨ç®—æ³•çš„ä»£ç éš”ç¦»å¼€æ¥
- ä½¿ç”¨ç»„åˆæ¥æ›¿ä»£ç»§æ‰¿
- å¼€é—­åŸåˆ™ï¼Œæ— éœ€å¯¹ä¸Šä¸‹æ–‡è¿›è¡Œä¿®æ”¹å°±èƒ½å¤Ÿå¼•å…¥æ–°çš„ç­–ç•¥

### ç¼ºç‚¹ 
- é’ˆå¯¹ç®—æ³•æå°‘å‘ç”Ÿæ”¹å˜çš„æƒ…å†µï¼Œæ²¡æœ‰å¿…è¦å¼•å…¥ç­–ç•¥æ¨¡å¼
- å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå·¨é¡¶ä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»
- ç­–ç•¥æ¨¡å¼å°†é€ æˆç³»ç»Ÿäº§ç”Ÿå¾ˆå¤šå…·ä½“ç­–ç•¥ç±»ï¼Œä»»ä½•ç»†å°å˜åŒ–éƒ½ä¼šå¯¼è‡´ç³»ç»Ÿè¦å¢åŠ æ–°çš„ç­–ç•¥ç±»
- æ— æ³•åŒæ—¶åœ¨å®¢æˆ·ç«¯ä½¿ç”¨å¤šä¸ªç­–ç•¥ç±»
- é€šè¿‡åŒ¿åå‡½æ•°ç­‰æ–¹å¼å¯ä»¥é¿å…åˆ›å»ºç­–ç•¥ç±»è€Œå®ç°ä¸åŒç®—æ³• 

# *è´£ä»»é“¾æ¨¡å¼ğŸŸ© 
å¤§å­¦ä¸­çš„å¥–å­¦é‡‘å®¡æ‰¹æµç¨‹ï¼Œå­¦ç”Ÿæäº¤ç”³è¯·åï¼Œåˆ†åˆ«è¦é€šè¿‡è¾…å¯¼å‘˜ã€ç³»ä¸»ä»»ã€é™¢é•¿ã€æ ¡é•¿çš„å±‚å±‚å®¡æ‰¹ï¼Œä»–ä»¬æ„æˆä¸€ä¸ªå¤„ç†ç”³è¯·è¡¨çš„é“¾å¼ç»“æ„ï¼Œç”³è¯·è¡¨æ²¿ç€è¿™æ¡é“¾è¿›è¡Œä¼ é€’ï¼Œè¿™æ¡é“¾å°±æˆä¸ºèŒè´£é“¾ï¼ˆè´£ä»»é“¾ï¼‰

**èŒè´£é“¾æ¨¡å¼**ï¼šé¿å…å°†ä¸€ä¸ªè¯·æ±‚çš„å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œå°†æ¥å—è¯·æ±‚çš„å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡èƒ½å¤Ÿå¤„ç†å®ƒä¸ºæ­¢   

## ç»“æ„
![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/èŒè´£é“¾æ¨¡å¼ç»“æ„å›¾.png)  

- `Handler`æŠ½è±¡å¤„ç†è€…ï¼Œå®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼Œä¸€èˆ¬ä¸ºæŠ½è±¡ç±»ï¼Œç”±äºä¸åŒçš„å…·ä½“å¤„ç†è€…å¤„ç†è¯·æ±‚çš„æ–¹å¼ä¸åŒï¼Œå› æ­¤åœ¨å…¶ä¸­å®šä¹‰äº†æŠ½è±¡è¯·æ±‚å¤„ç†æ–¹æ³•  
- `ConcreteHandler`å…·ä½“å¤„ç†è€…ï¼ŒæŠ½è±¡å¤„ç†è€…çš„å­ç±»ï¼Œå¯ä»¥å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œåœ¨å…·ä½“å¤„ç†è€…ç±»ä¸­å®ç°äº†æŠ½è±¡å¤„ç†è€…ä¸­å®šä¹‰çš„æŠ½è±¡å¤„ç†æ–¹æ³•ï¼Œå¤„ç†å‰è¿›è¡Œåˆ¤æ–­ï¼Œå¯ä»¥å¤„ç†å°±å¤„ç†ï¼Œå¦åˆ™è½¬å‘ç»™åç»§è€…   

?> èŒè´£é“¾æ¨¡å¼é€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œå°±ä¼šæŠŠè¿™ä¸ªè¯·æ±‚è½¬ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…   


## å®ç°  

![](https://hexoric-1310528773.cos.ap-beijing.myqcloud.com/hexo/è´£ä»»é“¾æ¨¡å¼å®ä¾‹å›¾.png)

æŠ½è±¡å¤„ç†è€… 

```java
public abstract class Approver {
    Approver approver;//åç»§è€…
    String name;//åç§°

    public Approver(String name) {
        this.name = name;
    }

    //è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†è€…
    public void setApprover(Approver approver) {
        this.approver = approver;
    }

    //å¤„ç†å®¡æ‰¹è¯·æ±‚çš„æ–¹æ³• äº¤ç”±å­ç±»å®Œæˆ
    public  abstract void processRequest(PurchaseRequest request);
}
```

ä¸‰ä¸ªå…·ä½“å¤„ç†è€…ï¼Œç³»ä¸»ä»»ï¼Œé™¢é•¿ï¼Œæ ¡é•¿

```java
public class DepartApprover extends Approver {

    public DepartApprover(String name) {
        super(name);
    }

    @Override
    public void processRequest(PurchaseRequest request) {
        if (request.getPrice()<=5000){
            System.out.println("è¯·æ±‚id"+request.getId()+"è¢«"+this.name+"å¤„ç†");
        }else{
            //æ— æ³•å¤„ç†äº¤ç»™ä¸‹ä¸€ä¸ª
            approver.processRequest(request);
        }
    }
}

public class CollegeApprover extends Approver {

    public CollegeApprover(String name) {
        super(name);
    }

    @Override
    public void processRequest(PurchaseRequest request) {
        if (request.getPrice()>5000 && request.getPrice()<=10000){
            System.out.println("è¯·æ±‚id"+request.getId()+"è¢«"+this.name+"å¤„ç†");
        }else{
            //æ— æ³•å¤„ç†äº¤ç»™ä¸‹ä¸€ä¸ª
            approver.processRequest(request);
        }
    }
}

public class SchoolApprover extends Approver {

    public SchoolApprover(String name) {
        super(name);
    }

    @Override
    public void processRequest(PurchaseRequest request) {
        if (request.getPrice()>10000 ){
            System.out.println("è¯·æ±‚id"+request.getId()+"è¢«"+this.name+"å¤„ç†");
        }else{
            //æ— æ³•å¤„ç†äº¤ç»™ä¸‹ä¸€ä¸ª
            approver.processRequest(request);
        }
    }
}
```

å¥–å­¦é‡‘ç±»  

```java
public class PurchaseRequest {
    private int type = 0;
    private float price = 0.0f;
    private int id = 0;

    public PurchaseRequest(int type, float price, int id) {
        this.type = type;
        this.price = price;
        this.id = id;
    }

    public int getType() {
        return type;
    }

    public float getPrice() {
        return price;
    }

    public int getId() {
        return id;
    }
}
```

æµ‹è¯•æ–¹æ³•

```java
public class Test {
    public static void main(String[] args) {
        PurchaseRequest purchaseRequest = new PurchaseRequest(1, 20000, 1);
        Approver a1 = new DepartApprover("ç³»ä¸»ä»»");
        Approver a2 = new CollegeApprover("é™¢é•¿");
        a1.setApprover(a2);
        Approver a3 = new SchoolApprover("å­¦æ ¡");
        a2.setApprover(a3);
        a3.setApprover(a1);//å½¢æˆè°ƒç”¨ç¯

        a1.processRequest(purchaseRequest);

    }
}
```

## Spring MVCä¸­çš„åº”ç”¨
JAVA ä¸­çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼ŒJSPã€Servlet çš„ Filter å‡æ˜¯è´£ä»»é“¾çš„å…¸å‹åº”ç”¨

- Spring MVCè¯·æ±‚æµç¨‹ä¸­ï¼Œæ‰§è¡Œäº†æ‹¦æˆªå™¨ç›¸å…³æ–¹æ³•`interceptor.preHandler`
- åœ¨å¤„ç†Spring MVCè¯·æ±‚æ—¶ï¼Œä½¿ç”¨åˆ°èŒè´£é“¾æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼
- `HandlerExecutionChain`ä¸»è¦è´Ÿè´£è¯·æ±‚æ‹¦æˆªçš„æ‰§è¡Œå’Œè¯·æ±‚å¤„ç†ï¼Œä½†æ˜¯ä»–æœ¬èº«ä¸å¤„ç†è¯·æ±‚ï¼Œå°†è¯·æ±‚åˆ†é…ç»™é“¾ä¸Šæ³¨å†Œå¤„ç†æ‰§è¡Œ
- `HandlerExecutionChain`ç»´æŠ¤äº†`HandlerInterceptor`çš„é›†åˆï¼Œå¯ä»¥å‘å…¶ä¸­æ³¨å†Œç›¸åº”çš„æ‹¦æˆªå™¨ 


## æ€»ç»“
**èŒè´£é“¾å°±æ˜¯çµæ´»ç‰ˆçš„if...else...**,å°±æ˜¯å°†è¿™äº›åˆ¤å®šè¯­å¥æ”¾åˆ°äº†å„ä¸ªå¤„ç†ç±»ä¸­ï¼Œè¿™æ ·åšçš„ä¼˜ç‚¹æ˜¯æ¯”è¾ƒçµæ´»ï¼Œä½†æ˜¯è¦æ³¨æ„è®¾ç½®å¤„ç†ç±»çš„å‰åå…³ç³»æ—¶ï¼Œä¸€å®šè¦ç‰¹åˆ«ä»”ç»†ï¼Œä¸è¦å‡ºç°å¾ªç¯è°ƒç”¨é—®é¢˜

### ä¼˜ç‚¹
- é™ä½è€¦åˆåº¦
- ç®€åŒ–å¯¹è±¡çš„ç›¸äº’è¿æ¥
- å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§
- å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ 

### ç¼ºç‚¹
- é’ˆå¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚å¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½ä¼šå—åˆ°å½±å“ï¼Œé“¾å¼è°ƒç”¨é¡ºåºä¸å½“å¯èƒ½ä¼šå¯¼è‡´æ­»å¾ªç¯ï¼Œä¸€èˆ¬éœ€è¦è®¾ç½®æœ€å¤§èŠ‚ç‚¹æ•°é¿å…è¿‡é•¿çš„èŒè´£é“¾




# å‚è€ƒèµ„æ–™
> - [å°šç¡…è°·è§†é¢‘](https://www.bilibili.com/video/BV1G4411c7N4)
> - [é»‘é©¬è§†é¢‘](https://www.bilibili.com/video/BV1Np4y1z7BU)
> - [Javakepper](https://javakeeper.starfish.ink/)
> - [Javaè®¾è®¡æ¨¡å¼(åˆ˜ä¼Ÿ)](https://book.douban.com/subject/30173863/)
> - [å›¾è¯´è®¾è®¡æ¨¡å¼](https://design-patterns.readthedocs.io/zh_CN/latest/index.html)
> - [è®¾è®¡æ¨¡å¼åšå®¢](https://refactoringguru.cn/design-patterns)